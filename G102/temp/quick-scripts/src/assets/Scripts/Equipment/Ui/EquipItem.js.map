{"version":3,"sources":["assets\\Scripts\\Equipment\\Ui\\EquipItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameManager from \"../../GameManager\";\r\nimport { Hero_Type } from \"../../Hero/Game/HeroConfig\";\r\nimport { ItemManager } from \"../../Prop/Data/Item\";\r\nimport { PropAction, PropData, PropId } from \"../../Prop/PropConfig\";\r\nimport { PropManager } from \"../../Prop/PropManager\";\r\nimport { SoundIndex } from \"../../Sound/AudioConstants\";\r\nimport MyTool from \"../../Tools/MyTool\";\r\nimport { UIManager } from \"../../UI/UIManager\";\r\nimport { EquipmentAttributeManager } from \"../Data/EquipmentAttribute\";\r\nimport { EquipInfo } from \"../EquipConfig\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class EquipItem extends cc.Component {\r\n\r\n    hero_type:Hero_Type=Hero_Type.NULL;\r\n    equip_info:EquipInfo=null;\r\n    prop_action:PropAction=PropAction.Look;\r\n    prop_price:number=0;\r\n    prop_cost:PropId=PropId.Coin;\r\n\r\n    buy_callback:Function=null;\r\n    use_callback:Function=null;\r\n\r\n    public addBuyListen(callback:Function) {\r\n        this.buy_callback=callback;\r\n    }\r\n\r\n    public addUseListen(callback:Function) {\r\n        this.use_callback=callback;\r\n    }\r\n\r\n    init(heroType:Hero_Type,info:EquipInfo|number,pAc:PropAction=PropAction.Look){\r\n        if (typeof info == \"number\"){\r\n            let equipInfo=new EquipInfo();\r\n            equipInfo.equip_id=info;\r\n            equipInfo.equip_num=1;\r\n            this.equip_info=equipInfo;\r\n        }else{\r\n            this.equip_info=info as EquipInfo;\r\n        }\r\n        this.hero_type=heroType;        \r\n        this.prop_action=pAc;\r\n        this.refreshData();\r\n    }\r\n\r\n    initSaleItem(currencyType:PropId,price:number,discount:number=0){\r\n        this.prop_price=price;\r\n        this.prop_cost=currencyType;\r\n        if(discount == 0){\r\n            this.node.getChildByName(\"discountBg\").active = false;\r\n            this.node.getChildByName(\"discountNum\").active = false;\r\n            this.node.getChildByName(\"discount\").active = false;\r\n        }else{\r\n            this.node.getChildByName(\"discountNum\").getComponent(cc.Label).string = \"\" + discount + \"%\";\r\n        }\r\n        \r\n        this.node.getChildByName(\"priceIcon\").getComponent(cc.Sprite).spriteFrame = PropManager.getInstance().getSpByPropId(currencyType);\r\n        this.node.getChildByName(\"price\").getComponent(cc.Label).string = MyTool.getCoinDanwei(price);\r\n    }\r\n\r\n    soldOut(){\r\n        this.node.getComponent(cc.Button).interactable = false;\r\n        this.node.getChildByName(\"icon\").getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial(\"2d-gray-sprite\"));\r\n        this.node.getChildByName(\"bg\").getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial(\"2d-gray-sprite\"));\r\n        this.node.getChildByName(\"discountBg\").active = false;\r\n        this.node.getChildByName(\"discountNum\").active = false;\r\n        this.node.getChildByName(\"discount\").active = false;\r\n        this.node.getChildByName(\"priceIcon\").active = false;\r\n        this.node.getChildByName(\"priceTitleBg\").active = false;\r\n        this.node.getChildByName(\"price\").active = false;\r\n        this.node.getChildByName(\"shop_Bg_SoldOut\").active = true;\r\n        this.node.getChildByName(\"saleOut\").active = true;\r\n    }\r\n\r\n    refreshData(){\r\n        let EAM=EquipmentAttributeManager.getInstance();\r\n        let PM=PropManager.getInstance();\r\n        let bg=this.node.getChildByName('bg');\r\n        bg.getComponent(cc.Sprite).spriteFrame=PM.getSpFrameByPropType(this.equip_info.equip_id);\r\n        let iconSp=this.node.getChildByName('icon').getComponent(cc.Sprite);\r\n        iconSp.spriteFrame=PM.getSpByPropId(this.equip_info.equip_id);\r\n        this.node.getComponent(cc.Button).enabled=this.prop_action!=PropAction.Null;\r\n        let star=this.node.getChildByName(\"star\").getChildByName('star').getComponent(cc.Sprite);\r\n        let starNum=ItemManager.getInstance().getStar(this.equip_info.equip_id);\r\n        if(starNum>0){\r\n            star.node.active=true;\r\n            star.spriteFrame=PropManager.getInstance().getSpByName('Common_Star_'+starNum);\r\n        }else{\r\n            star.node.active=false;\r\n        }\r\n        let num=this.node.getChildByName(\"num\")\r\n        if(this.equip_info.equip_num<=1){\r\n            num.active=false\r\n        }else{\r\n            num.active=true\r\n        }\r\n        num.getComponent(cc.Label).string=\"\"+this.equip_info.equip_num\r\n    }\r\n    onClick(){\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.click);        \r\n        UIManager.getInstance().showEquipInfoUi(this.hero_type,this.equip_info.equip_id,this.prop_action,{\r\n            prop_id: this.equip_info.equip_id,\r\n            prop_num: this.equip_info.equip_num,\r\n            prop_price:this.prop_price,\r\n            prop_cost_id:this.prop_cost,\r\n        },this.buy_callback,this.use_callback);\r\n    }\r\n}\r\n"]}
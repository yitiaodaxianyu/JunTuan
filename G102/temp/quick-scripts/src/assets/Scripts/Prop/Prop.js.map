{"version":3,"sources":["assets\\Scripts\\Prop\\Prop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import MyTool from \"../Tools/MyTool\";\r\nimport { PropManager } from \"./PropManager\";\r\nimport { PropAction, PropId } from \"../Prop/PropConfig\";\r\nimport { UIManager } from \"../UI/UIManager\";\r\nimport GameManager from \"../GameManager\";\r\nimport { SoundIndex } from \"../Sound/AudioConstants\";\r\nimport { ItemManager } from \"./Data/Item\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Prop extends cc.Component {\r\n\r\n    prop_id:PropId=PropId.Coin;\r\n    prop_num:number=0;\r\n    prop_action:PropAction=PropAction.Null;\r\n    prop_price:number=0;\r\n    prop_cost:PropId=PropId.Coin;\r\n\r\n    buy_callback:Function=null;\r\n    use_callback:Function=null;\r\n\r\n    public addBuyListen(callback:Function) {\r\n        this.buy_callback=callback;\r\n    }\r\n\r\n    public addUseListen(callback:Function) {\r\n        this.use_callback=callback;\r\n    }\r\n\r\n    init(propType:PropId,num:number,propAction:PropAction) {\r\n        this.prop_id=propType;\r\n        this.prop_num=num;\r\n        this.prop_action=propAction;               \r\n        this.refreshData(); \r\n    }\r\n\r\n    initSaleItem(currencyType:PropId,price:number,discount:number=0){\r\n        this.prop_price=price;\r\n        this.prop_cost=currencyType;\r\n        if(discount == 0){\r\n            this.node.getChildByName(\"discountBg\").active = false;\r\n            this.node.getChildByName(\"discountNum\").active = false;\r\n            this.node.getChildByName(\"discount\").active = false;\r\n        }else{\r\n            this.node.getChildByName(\"discountNum\").getComponent(cc.Label).string = \"\" + discount + \"%\";\r\n        }\r\n        this.node.getChildByName(\"priceIcon\").getComponent(cc.Sprite).spriteFrame = PropManager.getInstance().getSpByPropId(currencyType);\r\n        this.node.getChildByName(\"price\").getComponent(cc.Label).string = MyTool.getCoinDanwei(price);\r\n    }\r\n\r\n    soldOut(){\r\n        this.node.getComponent(cc.Button).interactable = false;\r\n        this.node.getChildByName(\"mask\").getChildByName(\"icon\").getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial(\"2d-gray-sprite\"));\r\n        this.node.getChildByName(\"discountBg\").active = false;\r\n        this.node.getChildByName(\"discountNum\").active = false;\r\n        this.node.getChildByName(\"discount\").active = false;\r\n        this.node.getChildByName(\"priceIcon\").active = false;\r\n        this.node.getChildByName(\"priceTitleBg\").active = false;\r\n        this.node.getChildByName(\"price\").active = false;\r\n        this.node.getChildByName(\"shop_Bg_SoldOut\").active = true;\r\n        this.node.getChildByName(\"saleOut\").active = true;\r\n    }\r\n    \r\n    refreshData(){\r\n        let num=this.node.getChildByName('num');\r\n        num.getComponent(cc.Label).string=MyTool.getCoinDanwei(this.prop_num);\r\n        num.active=this.prop_num!=0;\r\n        //设置框的图片\r\n        let sp=this.node.getComponent(cc.Sprite);\r\n        sp.spriteFrame=PropManager.getInstance().getSpFrameByPropType(this.prop_id);\r\n        //设置icon图片\r\n        let iconSp=this.node.getChildByName(\"mask\").getChildByName('icon').getComponent(cc.Sprite);\r\n        iconSp.spriteFrame=PropManager.getInstance().getSpByPropId(ItemManager.getInstance().getQuoteIcon(this.prop_id));        \r\n    }\r\n\r\n    onClick(){\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n        \r\n        if(this.prop_action==PropAction.Null)\r\n        {\r\n            return;\r\n        }\r\n        UIManager.getInstance().showPropInfo({\r\n            onClose:()=>{\r\n                if(this.prop_action==PropAction.Use){\r\n                    let newNum=PropManager.getInstance().getPropNum(this.prop_id);\r\n                    if(newNum!=this.prop_num){\r\n                        this.init(this.prop_id,newNum,this.prop_action);\r\n                    }\r\n                }\r\n            },\r\n        },this.prop_action,{\r\n            prop_id: this.prop_id,\r\n            prop_num: this.prop_num,\r\n            prop_price:this.prop_price,\r\n            prop_cost_id:this.prop_cost,\r\n        },this.buy_callback,this.use_callback);\r\n    }\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\UI\\home\\AvatarUi.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AACA,iDAA4C;AAE5C,yDAAuD;AACvD,sDAAqD;AACrD,6DAAwD;AACxD,2CAAsC;AACtC,8CAAyC;AAGnC,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAsC,4BAAW;IAAjD;QAAA,qEAiFC;QA9EG,mBAAa,GAAS,IAAI,CAAC;QAE3B,eAAS,GAAS,IAAI,CAAC;QAEvB,YAAM,GAAS,IAAI,CAAC;QACpB,yBAAmB,GAAQ,CAAC,CAAC;;IAyEjC,CAAC;IAvEG,yBAAM,GAAN;QACI,iBAAM,MAAM,WAAE,CAAC;QACf,IAAI,CAAC,mBAAmB,GAAC,kBAAQ,CAAC,WAAW,EAAE,CAAC,aAAa,EAAE,CAAC;QAChE,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAG,yBAAW,CAAC,WAAW,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAA,CAAA,kFAAkF;QACpN,IAAI,CAAC,SAAS,EAAE,CAAC;IAErB,CAAC;IAED,4BAAS,GAAT;QAEI,IAAI,OAAO,GAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC;QACzF,KAAI,IAAI,CAAC,GAAC,sBAAS,CAAC,YAAY,EAAE,CAAC,GAAC,sBAAS,CAAC,QAAQ,EAAE,CAAC,EAAE,EAC3D;YACI,IAAI,MAAM,GAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YAC1C,MAAM,CAAC,IAAI,GAAG,MAAM,GAAG,CAAC,CAAC;YACzB,MAAM,CAAC,MAAM,GAAC,OAAO,CAAC;YACtB,uGAAuG;YACvG,MAAM,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,sBAAsB,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAE,yBAAW,CAAC,WAAW,EAAE,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAA,CAAA,2DAA2D;YAClM,IAAI,GAAG,GAAC,MAAM,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;YACvC,6CAA6C;YAC7C,oCAAoC;YACpC,IAAI,UAAU,GAAC,IAAI,EAAE,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC;YAC/C,UAAU,CAAC,MAAM,GAAC,IAAI,CAAC,IAAI,CAAC;YAC5B,UAAU,CAAC,SAAS,GAAC,UAAU,CAAC;YAChC,UAAU,CAAC,OAAO,GAAC,gBAAgB,CAAC;YACpC,UAAU,CAAC,eAAe,GAAC,CAAC,GAAC,EAAE,CAAC;YAChC,GAAG,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACjC,IAAG,CAAC,IAAI,IAAI,CAAC,mBAAmB,EAAC;gBAC7B,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC;gBAC5B,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC,CAAC;aACvC;SACJ;QACD,0BAA0B;QACtB,qDAAqD;QACzD,kCAAkC;QAClC,+BAA+B;QAC/B,kBAAkB;IACtB,CAAC;IAEF,iCAAc,GAAd,UAAe,GAAG,EAAC,QAAe;QAE9B,qBAAW,CAAC,WAAW,EAAE,CAAC,aAAa,CAAC,SAAS,CAAC,2BAAU,CAAC,KAAK,CAAC,CAAC;QACpE,IAAI,KAAK,GAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAC7B,IAAG,IAAI,CAAC,mBAAmB,IAAE,KAAK,EAClC;YACK,IAAI,CAAC,mBAAmB,GAAC,KAAK,CAAC;YAC/B,IAAI,CAAC,gBAAgB,EAAE,CAAC;SAC5B;IACL,CAAC;IAED,mCAAgB,GAAhB;QAEK,iDAAiD;QACjD,mCAAmC;QACnC,IAAI;QACJ,gDAAgD;QAChD,IAAI;QACJ,4FAA4F;QAC5F,uFAAuF;QACvF,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAG,yBAAW,CAAC,WAAW,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAA,CAAA,kFAAkF;QACpN,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,sBAAsB,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,MAAM,GAAG,IAAI,CAAC,mBAAmB,CAAC,CAAC;QAC/H,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC,CAAC;IACzC,CAAC;IAED,6BAAU,GAAV;QAEK,qBAAW,CAAC,WAAW,EAAE,CAAC,aAAa,CAAC,SAAS,CAAC,2BAAU,CAAC,KAAK,CAAC,CAAC;QACpE,kBAAQ,CAAC,WAAW,EAAE,CAAC,cAAc,CAAC,IAAI,CAAC,mBAAmB,GAAC,EAAE,CAAC,CAAC;QACnE,iBAAM,OAAO,WAAE,CAAC;IACrB,CAAC;IA5EA;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;mDACS;IAE3B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;+CACK;IAEvB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;4CACE;IAPH,QAAQ;QAD5B,OAAO;OACa,QAAQ,CAiF5B;IAAD,eAAC;CAjFD,AAiFC,CAjFqC,qBAAW,GAiFhD;kBAjFoB,QAAQ","file":"","sourceRoot":"/","sourcesContent":["import GameData from \"../../GameData\";\r\nimport GameManager from \"../../GameManager\";\r\nimport { HeroManager } from \"../../Hero/Data/HeroManager\";\r\nimport { Hero_Type } from \"../../Hero/Game/HeroConfig\";\r\nimport { PropManager } from \"../../Prop/PropManager\";\r\nimport { SoundIndex } from \"../../Sound/AudioConstants\";\r\nimport UserData from \"../../UserData\";\r\nimport UIComponent from \"../UIComponent\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class AvatarUi extends UIComponent {\r\n\r\n    @property(cc.Node)\r\n    head_portrait:cc.Node=null;\r\n    @property(cc.Node)\r\n    head_item:cc.Node=null;\r\n    @property(cc.Node)\r\n    select:cc.Node=null;\r\n    select_avatar_index:number=0;\r\n\r\n    onLoad(): void {\r\n        super.onLoad();\r\n        this.select_avatar_index=UserData.getInstance().getUserAvatar();\r\n        this.head_portrait.getComponent(cc.Sprite).spriteFrame = PropManager.getInstance().getSpheadPortraitType(this.select_avatar_index)//HeroManager.getInstance().getSpriteFrameByName('hero'+this.select_avatar_index);\r\n        this.addAvatar();\r\n\r\n    }\r\n\r\n    addAvatar()\r\n    {\r\n        let content=this.node.getChildByName('avatarScroll').getComponent(cc.ScrollView).content;\r\n        for(let i=Hero_Type.ChangMaoShou; i<Hero_Type.Hero_Num; i++)\r\n        {\r\n            let avatar=cc.instantiate(this.head_item);\r\n            avatar.name = \"icon\" + i;\r\n            avatar.parent=content;\r\n            // avatar.addComponent(cc.Sprite).spriteFrame=HeroManager.getInstance().getSpriteFrameByName('hero'+i);\r\n            avatar.getChildByName(\"headPortrait\").getComponentInChildren(cc.Sprite).spriteFrame =PropManager.getInstance().getSpheadPortraitType(i)//HeroManager.getInstance().getSpriteFrameByName('hero'+i);\r\n            let btn=avatar.addComponent(cc.Button);\r\n            // btn.transition=cc.Button.Transition.COLOR;\r\n            // btn.disabledColor=cc.Color.WHITE;\r\n            let clickEvent=new cc.Component.EventHandler();\r\n            clickEvent.target=this.node;\r\n            clickEvent.component='AvatarUi';\r\n            clickEvent.handler='clickBtnAvatar';\r\n            clickEvent.customEventData=i+'';\r\n            btn.clickEvents.push(clickEvent);\r\n            if(i == this.select_avatar_index){\r\n                this.select.parent = avatar;\r\n                this.select.setPosition(cc.v2(0,0));\r\n            }\r\n        }\r\n        // this.scheduleOnce(()=>{\r\n            //     content.getComponent(cc.Layout).enabled=false;\r\n        //     this.select.parent=content;\r\n        //     this.showSelectAvatar();\r\n        // },0.1);        \r\n    }\r\n\r\n   clickBtnAvatar(btn,indexStr:string)\r\n   {\r\n       GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n       let index=parseInt(indexStr);\r\n       if(this.select_avatar_index!=index)\r\n       {\r\n            this.select_avatar_index=index;\r\n            this.showSelectAvatar();\r\n       }\r\n   }\r\n\r\n   showSelectAvatar()\r\n   {\r\n        // let spName='TY_TX_0'+this.select_avatar_index;\r\n        // if(this.select_avatar_index>=10)\r\n        // {\r\n        //     spName='TY_TX_'+this.select_avatar_index;\r\n        // }\r\n        // let content=this.node.getChildByName('avatarScroll').getComponent(cc.ScrollView).content;\r\n        // this.select.setPosition(content.children[this.select_avatar_index-1].getPosition());\r\n        this.head_portrait.getComponent(cc.Sprite).spriteFrame = PropManager.getInstance().getSpheadPortraitType(this.select_avatar_index)//HeroManager.getInstance().getSpriteFrameByName('hero'+this.select_avatar_index);\r\n        this.select.parent = this.node.getComponentInChildren(cc.ScrollView).content.getChildByName(\"icon\" + this.select_avatar_index);\r\n        this.select.setPosition(cc.v2(0,0));\r\n   }\r\n\r\n   clickBtnOk()\r\n   {\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n        UserData.getInstance().saveUserAvatar(this.select_avatar_index+'');\r\n        super.onClose();\r\n   }\r\n\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\Wish\\WishingCardUi.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { RewardData } from \"../JsonData/LevelJsonData\";\r\nimport { ItemManager } from \"../Prop/Data/Item\";\r\nimport WishingItemUi, { WishingItemState } from \"./WishingItemUi\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class WishingCardUi extends cc.Component {\r\n\r\n    @property(cc.Prefab)\r\n    item: cc.Prefab = null;\r\n    @property(cc.SpriteAtlas)\r\n    wishing_ui:cc.SpriteAtlas = null;\r\n\r\n    wishingItems:WishingItemUi[] = [];\r\n    /**\r\n     * 初始化翻牌界面\r\n     * @param type 1,单抽 2，十抽\r\n     */\r\n    initCard(type: number, reward: RewardData[],func:Function) {\r\n        let canvas = cc.find(\"Canvas\")\r\n        if (canvas.height / canvas.width < 2) {\r\n            this.node.getChildByName(\"itemRoot\").scale = canvas.height / canvas.width - 1;\r\n        }\r\n        this.node.getChildByName(\"itemRoot\").getComponent(cc.Widget).target = canvas;\r\n        this.node.getChildByName(\"btn\").getComponent(cc.Widget).target = canvas;\r\n        if (type == 1) {\r\n            // 单抽\r\n            let item = cc.instantiate(this.item);\r\n            item.parent = this.node.getChildByName(\"itemRoot\")\r\n            item.getComponent(WishingItemUi).initItem(reward[0])\r\n            this.wishingItems.push(item.getComponent(WishingItemUi));\r\n            item.getChildByName(\"backEffect\").getComponent(cc.Sprite).spriteFrame = this.wishing_ui.getSpriteFrame(\"CommonSpirit_BackLight_\" + ItemManager.getInstance().getQuality(reward[0].reward_id))\r\n            item.setPosition(cc.v3(0, 0, 0));\r\n        } else {\r\n            // 十连\r\n            for (let i = 0; i < 10; i++) {\r\n                let item = cc.instantiate(this.item);\r\n                let itemRoot = this.node.getChildByName(\"itemRoot\")\r\n                item.parent = itemRoot\r\n                item.scale = 0.78;\r\n                item.getComponent(WishingItemUi).initItem(reward[i])\r\n                item.getChildByName(\"backEffect\").getComponent(cc.Sprite).spriteFrame = this.wishing_ui.getSpriteFrame(\"CommonSpirit_BackLight_\" + ItemManager.getInstance().getQuality(reward[i].reward_id))\r\n                this.wishingItems.push(item.getComponent(WishingItemUi));\r\n                item.setPosition(cc.v3(0, 0, 0));\r\n                let pos = itemRoot.getChildByName(\"pos\" + i).getPosition();\r\n                cc.tween(item).to(0.5,{position:cc.v3(pos.x,pos.y,0)}).start();\r\n            }\r\n            this.node.getChildByName(\"btn\").active = true;\r\n        }\r\n\r\n        this.node.getChildByName(\"bg\").on(cc.Node.EventType.TOUCH_END,()=>{\r\n            let isClose = true;\r\n            for(let i = 0;i<this.wishingItems.length;i++){\r\n                if(this.wishingItems[i].state != WishingItemState.Opened){\r\n                    isClose = false;\r\n                }\r\n            }\r\n            if(isClose){\r\n                func();\r\n                this.node.destroy();\r\n            }\r\n        })\r\n    }\r\n\r\n    onClickBtn(){\r\n        for(let i = 0;i<this.wishingItems.length;i++){\r\n            this.wishingItems[i].openCard();\r\n        }\r\n        this.node.getChildByName(\"btn\").active = false;\r\n    }\r\n\r\n    // onLoad () {}\r\n\r\n    start() {\r\n\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}
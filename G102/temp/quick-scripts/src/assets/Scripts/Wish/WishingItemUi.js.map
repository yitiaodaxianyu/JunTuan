{"version":3,"sources":["assets\\Scripts\\Wish\\WishingItemUi.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Go_Type } from \"../Constants\";\r\nimport GameManager from \"../GameManager\";\r\nimport { RewardData } from \"../JsonData/LevelJsonData\";\r\nimport LanguageManager from \"../multiLanguage/LanguageManager\";\r\n// import { SpiritMessageManager } from \"../Pet/Data/SpiritMessage\";\r\nimport { PetManager } from \"../Pet/PetManager\";\r\nimport { ItemManager } from \"../Prop/Data/Item\";\r\nimport { PropAction } from \"../Prop/PropConfig\";\r\nimport { PropManager } from \"../Prop/PropManager\";\r\nimport { SoundIndex } from \"../Sound/AudioConstants\";\r\nimport TutorailsManager from \"../Tutorials/TutorailsManager\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\nexport enum WishingItemState{\r\n    Close = 1,\r\n    Opened = 2,\r\n    Openning = 3,\r\n}\r\n\r\n@ccclass\r\nexport default class WishingItemUi extends cc.Component {\r\n\r\n    state:WishingItemState = WishingItemState.Close;\r\n    rewardData:RewardData = null;\r\n    initItem(rewardData:RewardData){\r\n        this.rewardData = rewardData;\r\n        this.state = WishingItemState.Close;\r\n        if(ItemManager.getInstance().getJsonItem(rewardData.reward_id).Type == 7){\r\n            // 宠物显示\r\n            // this.node.getChildByName(\"Card_Font\").getComponent(cc.Sprite).spriteFrame = \r\n            // PetManager.getInstance().getSpriteFrameByName(\"Sprite_Avatar_\" + PetManager.getInstance().getPetId(rewardData.reward_id));\r\n            // this.node.getChildByName(\"Sprite_Up_Quality_1\").getComponent(cc.Sprite).spriteFrame = \r\n            // PetManager.getInstance().getSpriteFrameByName(\"Sprite_Up_Quality_\" + \r\n            // SpiritMessageManager.getInstance().getInitialQuality(PetManager.getInstance().getPetId(rewardData.reward_id)));\r\n            let label = this.node.getChildByName(\"name\")\r\n            label.getComponent(cc.Label).string = LanguageManager.getInstance().\r\n            getStrByTextId(ItemManager.getInstance().getNameTextId(rewardData.reward_id))\r\n            label.color = PropManager.getInstance().getPropQualityTextColor\r\n            (ItemManager.getInstance().getQuality(rewardData.reward_id));\r\n            // console.log(\"宠物前图：\"+\"Sprite_Avatar_\" + this.getPetId(rewardData.reward_id));\r\n            // console.log(\"宠物质量：\"+\"Sprite_Up_Quality_\" + \r\n            // SpiritMessageManager.getInstance().getInitialQuality\r\n            // (this.getPetId(rewardData.reward_id)),rewardData.reward_id);\r\n            // console.log(this.node.getComponentInChildren(cc.Label).string,\"宠物名字：\"+ LanguageManager.getInstance().getStrByTextId(ItemManager.getInstance().getNameTextId(rewardData.reward_id)),ItemManager.getInstance().getNameTextId(rewardData.reward_id));\r\n        }else{\r\n            // 道具显示\r\n            this.node.getChildByName(\"Sprite_Up_Quality_1\").active = false;\r\n            let label = this.node.getChildByName(\"name\")\r\n            label.getComponent(cc.Label).string = LanguageManager.getInstance().getStrByTextId\r\n            (ItemManager.getInstance().getNameTextId(rewardData.reward_id));\r\n            if(ItemManager.getInstance().getJsonItem(rewardData.reward_id).Type==5){\r\n                let valueStr=24;\r\n                let yushu=ItemManager.getInstance().getJsonItem(rewardData.reward_id).ItemID%10-1;\r\n                if(yushu<=4){\r\n                    valueStr=Math.pow(2,yushu);\r\n                }\r\n                if(valueStr == 16) valueStr = 24;\r\n                label.getComponent(cc.Label).string=label.getComponent(cc.Label).string.replace('~',valueStr.toString());\r\n                // detailStr=detailStr.replace('~',valueStr.toString());\r\n            }\r\n            label.color = PropManager.getInstance().getPropQualityTextColor\r\n            (ItemManager.getInstance().getQuality(rewardData.reward_id));\r\n            label.getComponent(cc.LabelOutline).color = PropManager.getInstance().\r\n            getPropQualityTextOutlineColor();\r\n            let item = PropManager.getInstance().createPropItem\r\n            (rewardData.reward_id,rewardData.reward_num,PropAction.Null);\r\n            let type=ItemManager.getInstance().getType(rewardData.reward_id);\r\n            if(type != 3){\r\n                item.getComponent(cc.Sprite).enabled = false;\r\n            }else{\r\n                item.getChildByName('bg').getComponent(cc.Sprite).enabled = false;\r\n            }\r\n            item.parent = this.node.getChildByName(\"Card_Font\");\r\n            item.scale = 1.5;\r\n            item.setPosition(cc.v3(0,0,0));\r\n        }\r\n\r\n        this.node.getChildByName(\"Card_Back\").on(cc.Node.EventType.TOUCH_END,this.openCard,this)\r\n        // if(TutorailsManager.getInstance().isShowTutorials(212)){\r\n        //     this.openCard();\r\n        // }\r\n    }\r\n\r\n    openCard(){\r\n        if(this.state == WishingItemState.Close){\r\n            this.state = WishingItemState.Openning;\r\n            let anim = this.getComponent(cc.Animation)\r\n            anim.enabled = true;\r\n            GameManager.getInstance().sound_manager.playSound(SoundIndex.YX_Fanka);\r\n            switch(ItemManager.getInstance().getQuality(this.rewardData.reward_id)){\r\n                case 0:\r\n                    anim.play(\"card_common\");\r\n                    break;\r\n                case 1:\r\n                    anim.play(\"card_green\");\r\n                    break;\r\n                case 2:\r\n                    anim.play(\"card_blue\");\r\n                    break;\r\n                case 3:\r\n                    anim.play(\"card_purple\");\r\n                    break;\r\n                case 4:\r\n                    anim.play(\"card_sp\");\r\n                    let backAnim = this.node.getChildByName(\"backEffect\").getComponent(cc.Animation);\r\n                    backAnim.enabled = true;\r\n                    backAnim.play(\"card_sp_back\");\r\n                    break;\r\n                case 5:\r\n                    anim.play(\"card_red\");\r\n                    let bbackAnim = this.node.getChildByName(\"backEffect\").getComponent(cc.Animation);\r\n                    bbackAnim.enabled = true;\r\n                    bbackAnim.play(\"card_red_back\");\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    overOpen(){\r\n        this.state = WishingItemState.Opened;\r\n          \r\n    }\r\n\r\n    showBackEffect(){\r\n        let backAnim = this.node.getComponentInChildren(cc.Animation);\r\n        backAnim.enabled = true;\r\n        backAnim.play(\"car_common_back\");\r\n    }\r\n\r\n\r\n\r\n}\r\n"]}
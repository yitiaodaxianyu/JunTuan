{"version":3,"sources":["assets\\Scripts\\VipSystem\\VIPPrivileges.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport WXManagerEX, { WXADEnvnt } from \"../../startscene/WXManagerEX\";\r\nimport { BossRewardManager } from \"../Activity/BossReward\";\r\nimport ApkManager from \"../Ads/ApkManager\";\r\nimport { BattlePassDataManager } from \"../BattlePass/BattlePassData\";\r\nimport GameManager from \"../GameManager\";\r\nimport { Follow_Type } from \"../multiLanguage/FollowConstants\";\r\nimport FollowManager from \"../multiLanguage/FollowManager\";\r\nimport LanguageManager from \"../multiLanguage/LanguageManager\";\r\nimport TextLanguage from \"../multiLanguage/TextLanguage\";\r\nimport { PayManager } from \"../Payment/PayManager\";\r\nimport { PropId } from \"../Prop/PropConfig\";\r\nimport { PropManager } from \"../Prop/PropManager\";\r\nimport { SoundIndex } from \"../Sound/AudioConstants\";\r\nimport { StorageKey } from \"../Storage/StorageConfig\";\r\nimport { TheStorageManager } from \"../Storage/StorageManager\";\r\nimport { TurntableInformationManager } from \"../Turntable/TurntableInformation\";\r\nimport UIComponent from \"../UI/UIComponent\";\r\nimport VipSystem from \"./VipSystem\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class VIPPrivileges extends cc.Component {\r\n\r\n\r\n    @property(cc.Node)\r\n    itme:cc.Node[]=[]//每天领取的500钻石道具父节点\r\n    id=\"c401\"//c401  c501\r\n    Gemnum:number=360\r\n    // propid=[PropId.Gem,10002,40004,101004]\r\n    // num=[this.Gemnum,500,10,20]\r\n    propid=[10002,40004,101004]\r\n    num=[500,10,20]\r\n    @property(cc.Node)\r\n    lanText:cc.Node=null//价格\r\n\r\n    maxAadNum:number=10;\r\n    start () {\r\n        for (let index = 0; index < this.itme.length; index++) {\r\n            let itme=PropManager.getInstance().createPropItem(this.propid[index],this.num[index]);\r\n            itme.scale=0.85\r\n            itme.parent=this.itme[index]\r\n        }\r\n    }\r\n    onEnable(){\r\n        let adNum = TheStorageManager.getInstance().getNumber(StorageKey.VIPADNum,0);//观看广告次数\r\n        this.lanText.getComponent(cc.Label).string=\"已观看\"+adNum+\"次广告，还差\"+(this.maxAadNum-adNum)+\"次可解锁\";\r\n\r\n        cc.director.on(WXADEnvnt.ZHANLINGJIESUOSHIPIN, this.onShipinComp, this);\r\n    }\r\n    clickBtnbtnLan(){//购买\r\n\r\n        if (cc.sys.platform === cc.sys.BYTEDANCE_GAME) {\r\n\r\n          \r\n\r\n            WXManagerEX.getInstance().zhanlingjiesuoShipin= tt.createRewardedVideoAd({\r\n                adUnitId: '7q83ef0lin4192mi9l'\r\n            });\r\n\r\n            WXManagerEX.getInstance().zhanlingjiesuoShipin.offError();\r\n            WXManagerEX.getInstance().zhanlingjiesuoShipin.onError(err => {\r\n                console.log(err)\r\n            });\r\n            WXManagerEX.getInstance().zhanlingjiesuoShipin.offClose();\r\n            WXManagerEX.getInstance().zhanlingjiesuoShipin.show().catch(() => {\r\n                // 失败重试\r\n                WXManagerEX.getInstance().zhanlingjiesuoShipin.load()\r\n                    .then(() => WXManagerEX.getInstance().zhanlingjiesuoShipin.show())\r\n                    .catch(err => {\r\n                        GameManager.getInstance().showMessage(\"广告拉取失败\");\r\n                    })\r\n            })\r\n            WXManagerEX.getInstance().zhanlingjiesuoShipin.onClose(res => {\r\n                // 用户点击了【关闭广告】按钮\r\n                // 小于 2.1.0 的基础库版本，res 是一个 undefined\r\n                if (res && res.isEnded || res === undefined) {\r\n                  // 正常播放结束，可以下发游戏奖励\r\n                  this.onShipinComp();\r\n                }\r\n                else {\r\n                    // 播放中途退出，不下发游戏奖励\r\n                }\r\n            })\r\n\r\n        }else{\r\n            this.onShipinComp();\r\n        }\r\n\r\n\r\n        // ApkManager.getInstance().showPay({result:(isPay:boolean)=>{\r\n        //     if(isPay){\r\n        //         FollowManager.getInstance().followEvent(Follow_Type.战令购买高级战令成功人数);\r\n        //         let itme=[]\r\n        //         for (let index = 0; index < this.itme.length; index++) {\r\n        //             PropManager.getInstance().changePropNum(this.propid[index],this.num[index]);\r\n        //             let itmes=PropManager.getInstance().createPropItem(this.propid[index],this.num[index]);\r\n        //             itme.push(itmes)\r\n        //         }\r\n        //         GameManager.getInstance().showMultipleGetTip(itme);\r\n        //         TheStorageManager.getInstance().setItem(StorageKey.VipIdentity,1)\r\n        //         PayManager.getInstance().addPayNum(this.id);\r\n        //         this.node.parent.getComponent(VipSystem).Refresh()\r\n        //         this.clickBtnClose()\r\n        //     }\r\n        // }},this.id) \r\n    }\r\n    private onShipinComp():void{\r\n        let adNum = TheStorageManager.getInstance().getNumber(StorageKey.VIPADNum,0)+1;//观看广告次数\r\n        TheStorageManager.getInstance().setItem(StorageKey.VIPADNum,adNum);\r\n        if(adNum==10){\r\n            FollowManager.getInstance().followEvent(Follow_Type.战令购买高级战令成功人数);\r\n            let itme=[]\r\n            for (let index = 0; index < this.itme.length; index++) {\r\n                PropManager.getInstance().changePropNum(this.propid[index],this.num[index]);\r\n                let itmes=PropManager.getInstance().createPropItem(this.propid[index],this.num[index]);\r\n                itme.push(itmes)\r\n            }\r\n            GameManager.getInstance().showMultipleGetTip(itme);\r\n            TheStorageManager.getInstance().setItem(StorageKey.VipIdentity,1)\r\n            PayManager.getInstance().addPayNum(this.id);\r\n            this.node.parent.getComponent(VipSystem).Refresh()\r\n            this.clickBtnClose()\r\n        }else{\r\n            this.lanText.getComponent(cc.Label).string=\"已观看\"+adNum+\"次广告，还差\"+(this.maxAadNum-adNum)+\"次可解锁\";\r\n        }\r\n        \r\n      \r\n       \r\n    }\r\n    clickBtnClose()//关闭\r\n    {\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n        cc.director.off(WXADEnvnt.ZHANLINGJIESUOSHIPIN, this.onShipinComp, this);\r\n        this.node.active=false\r\n    }\r\n\r\n\r\n    // update (dt) {}\r\n}\r\n"]}
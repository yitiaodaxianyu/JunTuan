{"version":3,"sources":["assets\\Scripts\\copy\\endlesschallenges\\purchasesnumbe.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport WXManagerEX from \"../../../startscene/WXManagerEX\";\r\nimport ApkManager from \"../../Ads/ApkManager\";\r\nimport CoinPop from \"../../CoinPop\";\r\nimport { VIDEO_TYPE } from \"../../Constants\";\r\nimport GameManager from \"../../GameManager\";\r\nimport { Follow_Type } from \"../../multiLanguage/FollowConstants\";\r\nimport FollowManager from \"../../multiLanguage/FollowManager\";\r\nimport TextLanguage from \"../../multiLanguage/TextLanguage\";\r\nimport { PropId } from \"../../Prop/PropConfig\";\r\nimport { PropManager } from \"../../Prop/PropManager\";\r\nimport { SoundIndex } from \"../../Sound/AudioConstants\";\r\nimport { StorageKey } from \"../../Storage/StorageConfig\";\r\nimport { TheStorageManager } from \"../../Storage/StorageManager\";\r\nimport UIComponent from \"../../UI/UIComponent\";\r\nimport { UIPath, UILayerLevel } from \"../../UI/UIConfig\";\r\nimport { UIManager } from \"../../UI/UIManager\";\r\nimport { BossWeeklyRewardManager } from \"./BossWeeklyReward\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class purchasesnumbe extends UIComponent {\r\n    @property(cc.Node)\r\n    num: cc.Node = null\r\n    mynum: number[] = [50, 200, 300]//[50,100,150]\r\n    type: number = 0//2:无尽挑战   3：boss挑战\r\n\r\n    initUi(type) {\r\n        let buynum\r\n        this.type = type\r\n        if (this.type == 2) {\r\n            buynum = TheStorageManager.getInstance().getNumber(StorageKey.BuyUnlimitedChallengeTimes, 3);\r\n        } else if (this.type == 3) {\r\n            buynum = TheStorageManager.getInstance().getNumber(StorageKey.BuyBossChallengeTimes, 3);\r\n        } else if (this.type == 4) {\r\n            buynum = TheStorageManager.getInstance().getNumber(StorageKey.BuyVoidCrackChallengeTimes, 3);\r\n        }\r\n        this.num.getComponent(cc.Label).string = \"\" + this.mynum[3 - buynum]\r\n    }\r\n    clickBtnBuy() {//钻石购买\r\n        let buynum\r\n        if (this.type == 2) {\r\n            buynum = TheStorageManager.getInstance().getNumber(StorageKey.BuyUnlimitedChallengeTimes, 3);\r\n        } else if (this.type == 3) {\r\n            buynum = TheStorageManager.getInstance().getNumber(StorageKey.BuyBossChallengeTimes, 3);\r\n        }\r\n        else if (this.type == 4) {\r\n            buynum = TheStorageManager.getInstance().getNumber(StorageKey.BuyVoidCrackChallengeTimes, 3);\r\n        }\r\n        let gem = PropManager.getInstance().getPropNum(PropId.Gem);\r\n\r\n\r\n        if (gem >= this.mynum[3 - buynum]) {\r\n            //可以购买\r\n            PropManager.getInstance().changePropNum(PropId.Gem, -this.mynum[3 - buynum]);\r\n            buynum--\r\n            if (this.type == 2) {\r\n                FollowManager.getInstance().followEvent(Follow_Type.无尽挑战挑战次数购买数);\r\n                FollowManager.getInstance().followEvent(Follow_Type.无尽挑战_挑战次数购买数_每日第x次购买 + (3 - buynum));\r\n                TheStorageManager.getInstance().setItem(StorageKey.BuyUnlimitedChallengeTimes, buynum);\r\n                let num = TheStorageManager.getInstance().getNumber(StorageKey.UnlimitedChallengeTimes, 0);\r\n                num++\r\n                TheStorageManager.getInstance().setItem(StorageKey.UnlimitedChallengeTimes, num);\r\n            } else if (this.type == 3) {\r\n                FollowManager.getInstance().followEvent(Follow_Type.BOSS挑战挑战次数购买数);\r\n                FollowManager.getInstance().followEvent(Follow_Type.BOSS挑战_挑战次数购买数_每日第x次购买 + (3 - buynum));\r\n                TheStorageManager.getInstance().setItem(StorageKey.BuyBossChallengeTimes, buynum);\r\n                let num = TheStorageManager.getInstance().getNumber(StorageKey.BossChallengeTimes, 0);\r\n                num++\r\n                TheStorageManager.getInstance().setItem(StorageKey.BossChallengeTimes, num);\r\n            }\r\n            else if (this.type == 4) {\r\n                FollowManager.getInstance().followEvent(Follow_Type.虚空裂缝挑战次数购买数);\r\n                FollowManager.getInstance().followEvent(Follow_Type.虚空裂缝_挑战次数购买数_每日第x次购买 + (3 - buynum));\r\n                TheStorageManager.getInstance().setItem(StorageKey.BuyVoidCrackChallengeTimes, buynum);\r\n                let num = TheStorageManager.getInstance().getNumber(StorageKey.VoidCrackChallengeTimes, 0);\r\n                num++\r\n                TheStorageManager.getInstance().setItem(StorageKey.VoidCrackChallengeTimes, num);\r\n            }\r\n            this.clickBtnClose()\r\n        } else {\r\n            //钱不够\r\n            UIManager.getInstance().showUiDialog(UIPath.CoinPop, UILayerLevel.Three, {\r\n                onCompleted: (uiNode) => {\r\n                    uiNode.getComponent(CoinPop).initUi(PropId.Gem)\r\n                },\r\n            });\r\n        }\r\n    }\r\n    clickBtnBuyAd() {//广告购买\r\n\r\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\r\n\r\n\r\n            if (this.type == 2) {\r\n      \r\n                WXManagerEX.getInstance().cardByAd = wx.createRewardedVideoAd({\r\n                    adUnitId: 'adunit-f93dddec700f320f'\r\n                });\r\n            } else if (this.type == 3) {\r\n \r\n\r\n                WXManagerEX.getInstance().cardByAd = wx.createRewardedVideoAd({\r\n                    adUnitId: 'adunit-a569c3a5f40ffd43'\r\n                });\r\n            }\r\n            else if (this.type == 4) {\r\n\r\n                WXManagerEX.getInstance().cardByAd = wx.createRewardedVideoAd({\r\n                    adUnitId: 'adunit-5d9c656083442416'\r\n                });\r\n            }\r\n\r\n           \r\n            WXManagerEX.getInstance().cardByAd.offError();\r\n            WXManagerEX.getInstance().cardByAd.onError(err => {\r\n                console.log(err)\r\n            });\r\n            WXManagerEX.getInstance().cardByAd.offClose();\r\n            WXManagerEX.getInstance().cardByAd.show().catch(() => {\r\n                // 失败重试\r\n                WXManagerEX.getInstance().cardByAd.load()\r\n                    .then(() => WXManagerEX.getInstance().cardByAd.show())\r\n                    .catch(err => {\r\n                        GameManager.getInstance().showMessage(\"广告拉取失败\");\r\n                    })\r\n            })\r\n            WXManagerEX.getInstance().cardByAd.onClose(res => {\r\n                // 用户点击了【关闭广告】按钮\r\n                // 小于 2.1.0 的基础库版本，res 是一个 undefined\r\n                if (res && res.isEnded || res === undefined) {\r\n                    // 正常播放结束，可以下发游戏奖励\r\n                    this.onShipinComp();\r\n                }\r\n                else {\r\n                    // 播放中途退出，不下发游戏奖励\r\n                }\r\n            })\r\n\r\n        } else {\r\n            this.onShipinComp();\r\n        }\r\n\r\n    }\r\n    private onShipinComp(): void {\r\n        let buynum\r\n        if (this.type == 2) {\r\n            buynum = TheStorageManager.getInstance().getNumber(StorageKey.BuyUnlimitedChallengeTimes, 3);\r\n        } else if (this.type == 3) {\r\n            buynum = TheStorageManager.getInstance().getNumber(StorageKey.BuyBossChallengeTimes, 3);\r\n        }\r\n        else if (this.type == 4) {\r\n            buynum = TheStorageManager.getInstance().getNumber(StorageKey.BuyVoidCrackChallengeTimes, 3);\r\n        }\r\n        //可以购买\r\n        PropManager.getInstance().changePropNum(PropId.Gem, -this.mynum[3 - buynum]);\r\n        buynum--\r\n        if (this.type == 2) {\r\n            FollowManager.getInstance().followEvent(Follow_Type.无尽挑战挑战次数购买数);\r\n            FollowManager.getInstance().followEvent(Follow_Type.无尽挑战_挑战次数购买数_每日第x次购买 + (3 - buynum));\r\n            TheStorageManager.getInstance().setItem(StorageKey.BuyUnlimitedChallengeTimes, buynum);\r\n            let num = TheStorageManager.getInstance().getNumber(StorageKey.UnlimitedChallengeTimes, 0);\r\n            num++\r\n            TheStorageManager.getInstance().setItem(StorageKey.UnlimitedChallengeTimes, num);\r\n        } else if (this.type == 3) {\r\n            FollowManager.getInstance().followEvent(Follow_Type.BOSS挑战挑战次数购买数);\r\n            FollowManager.getInstance().followEvent(Follow_Type.BOSS挑战_挑战次数购买数_每日第x次购买 + (3 - buynum));\r\n            TheStorageManager.getInstance().setItem(StorageKey.BuyBossChallengeTimes, buynum);\r\n            let num = TheStorageManager.getInstance().getNumber(StorageKey.BossChallengeTimes, 0);\r\n            num++\r\n            TheStorageManager.getInstance().setItem(StorageKey.BossChallengeTimes, num);\r\n        }\r\n        else if (this.type == 4) {\r\n            FollowManager.getInstance().followEvent(Follow_Type.虚空裂缝挑战次数购买数);\r\n            FollowManager.getInstance().followEvent(Follow_Type.虚空裂缝_挑战次数购买数_每日第x次购买 + (3 - buynum));\r\n            TheStorageManager.getInstance().setItem(StorageKey.BuyVoidCrackChallengeTimes, buynum);\r\n            let num = TheStorageManager.getInstance().getNumber(StorageKey.VoidCrackChallengeTimes, 0);\r\n            num++\r\n            TheStorageManager.getInstance().setItem(StorageKey.VoidCrackChallengeTimes, num);\r\n        }\r\n        this.clickBtnClose()\r\n    }\r\n    clickBtnClose()//关闭\r\n    {\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n        this.onClose();\r\n    }\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n\r\n    // start () {\r\n\r\n    // }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}
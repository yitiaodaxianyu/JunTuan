{"version":3,"sources":["assets\\Scripts\\Boss\\BossHpProgressBar.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { GameEffectsManager } from \"../Game/GameEffectsManager\";\r\nimport { MonsterConfigureManager } from \"../Monster/Data/MonsterConfigure\";\r\nimport { MonsterIconManager } from \"../Monster/MonsterIconManager\";\r\nimport LanguageManager from \"../multiLanguage/LanguageManager\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class BossHpProgressBar extends cc.ProgressBar {\r\n\r\n    @property([cc.SpriteFrame])\r\n    sp_hp:cc.SpriteFrame[]=[];\r\n    yellow:cc.Node=null;\r\n    next_bar:cc.Sprite=null;\r\n    /**初始速度 */\r\n    @property()\r\n    speed:number=56;\r\n    /**当前速度 */\r\n    cur_speed:number=56;\r\n    /**血条条数 */\r\n    cur_hp_num:number=0;\r\n    hp_num_label:cc.Label=null;\r\n    /**最大的血量值 */\r\n    max_hp:number=0;\r\n    /**当前的血量值 */\r\n    cur_hp:number=0;\r\n    /**每条血条的血量 */\r\n    once_hp:number=0;\r\n    /**加速度，死亡时有效 */\r\n    acc_speed:number=640;   \r\n\r\n    onLoad()\r\n    {\r\n        this.yellow=this.node.getChildByName('yellow');\r\n        this.hp_num_label=this.node.getChildByName('hpNum').getComponent(cc.Label);\r\n        this.next_bar=this.node.getChildByName('nextBar').getComponent(cc.Sprite)\r\n    }\r\n\r\n    init(maxHp:number,monsterId:number,level:number){\r\n        this.max_hp=maxHp;\r\n        this.once_hp=this.max_hp/30;\r\n        this.yellow.width=0;\r\n        this.setHp(this.max_hp);        \r\n        let nameLabel=this.node.getChildByName('name').getComponent(cc.Label);\r\n        nameLabel.string='Lv.'+level+' '+LanguageManager.getInstance().getStrByTextId(MonsterConfigureManager.getInstance().getNameTextId(monsterId));\r\n        this.node.active=true;\r\n        //图标\r\n        let icon=this.node.getChildByName('icon');\r\n        icon.getComponent(cc.Sprite).spriteFrame=MonsterIconManager.getInstance().getSpByMonsterId(monsterId);\r\n        this.cur_speed=this.speed;\r\n    }\r\n\r\n    setHp(num:number)\r\n    {\r\n        this.cur_hp=num;\r\n        //直接算出当前的血条数和进度\r\n        let curHpNum=Math.floor(this.cur_hp/this.once_hp);        \r\n        if(curHpNum<0){\r\n            curHpNum=0;\r\n        }\r\n        if(curHpNum!=this.cur_hp_num){\r\n            this.yellow.width=this.totalLength;\r\n        }\r\n        this.cur_hp_num=curHpNum;\r\n        let remain=(this.cur_hp-(this.once_hp*curHpNum));\r\n        this.progress=remain/this.once_hp;\r\n        this.hp_num_label.string='x'+this.cur_hp_num;\r\n        this.barSprite.spriteFrame=this.sp_hp[this.cur_hp_num%5];\r\n        if(this.cur_hp_num>=1){\r\n            this.next_bar.spriteFrame=this.sp_hp[(this.cur_hp_num-1)%5];\r\n        }\r\n        this.next_bar.node.active=this.cur_hp_num>=1;\r\n    }\r\n\r\n    //显示白色色\r\n    update(dt)\r\n    {\r\n        let curWidth=this.progress*this.totalLength;\r\n        if(this.yellow.width>curWidth)\r\n        {\r\n            if(this.cur_hp<=0){\r\n                this.cur_speed+=dt*this.acc_speed;\r\n            }\r\n            this.yellow.width-=this.cur_speed*dt;        \r\n            if(this.yellow.width<curWidth)\r\n            {\r\n                this.yellow.width=curWidth;\r\n            }\r\n            if(this.yellow.width<=0){\r\n                this.node.active=false;\r\n            }\r\n        }else if(this.yellow.width<curWidth&&this.yellow.width>0)\r\n        {\r\n            if(curWidth<=0){\r\n                curWidth=0;\r\n                this.node.active=false;\r\n            }\r\n            this.yellow.width=curWidth;\r\n        }\r\n    }\r\n}\r\n"]}
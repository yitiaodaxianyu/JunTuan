{"version":3,"sources":["assets\\Scripts\\Monster\\Elite\\Elite73.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { GameState } from \"../../Constants\";\r\nimport { Enemy_State } from \"../../Enemy/EnemyConfig\";\r\nimport { GameEffectsManager, GameEffectId } from \"../../Game/GameEffectsManager\";\r\nimport GameManager from \"../../GameManager\";\r\nimport { BuffId } from \"../../Hero/Game/HeroConfig\";\r\nimport MyTool from \"../../Tools/MyTool\";\r\nimport Wall from \"../../Wall/Wall\";\r\nimport { WallType } from \"../../Wall/WallConfig\";\r\nimport WallManager from \"../../Wall/WallManager\";\r\nimport { KeyFrameData } from \"../MonsterData\";\r\nimport MonsterNewNormal from \"../MonsterNewNormal\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Elite73 extends MonsterNewNormal {    \r\n\r\n    is_skill_state:boolean=false;\r\n    gou:cc.Node=null;\r\n    is_gou_ok:boolean=false;\r\n    /**铁链之间的间隔距离 */\r\n    lian_jiange:number=65;\r\n    lian_height:number=74;\r\n    lian_jiaoji:number=-9;\r\n    lian_root:cc.Node=null;\r\n    /**勾的终点,勾的锚点 */\r\n    dis_yy:number=-1000;\r\n    gou_speed:number=4000;\r\n\r\n    protected onLoad(): void {\r\n        super.onLoad();\r\n        super.addMonsterNormalInited(this.onMonsterNormalInited);\r\n        super.addMonsterNormalXuanYun(this.onMonsterNormalXuanYun);\r\n        super.addMonsterNormalDeath(this.onMonsterNormalDeath);\r\n        GameEffectsManager.getInstance().addEffectPoolById(GameEffectId.monster73_skill_lian,8);\r\n        GameEffectsManager.getInstance().addEffectPoolById(GameEffectId.monster73_skill_lian_root);\r\n        GameEffectsManager.getInstance().addEffectPoolById(GameEffectId.monster73_skill_mao);\r\n    }\r\n\r\n    onMonsterNormalInited () {        \r\n        this.dis_yy=-1000;\r\n    }\r\n\r\n    onMonsterNormalXuanYun(isXuanYun:boolean){\r\n       \r\n    }\r\n\r\n    onMonsterNormalDeath(){\r\n        this.is_skill_state=false;\r\n        this.destroyLian();\r\n    }\r\n\r\n    startSkill(){\r\n        //冷却完毕，可以判断是否可以出钩\r\n        let walls=WallManager.getInstance().getAllWall();\r\n        let attWall:Wall=null;\r\n        let offsetYY=0;\r\n        walls.forEach((wall:Wall,wallType:WallType)=>{\r\n            //出钩满足大于80小于500.\r\n            offsetYY=Math.abs(this.node.y-wall.getWallMaxYY());\r\n            if(this.node.y>=wall.getWallMaxYY()&&offsetYY>80 && offsetYY<500){                \r\n                let newYY=wall.getWallMaxYY()+80;\r\n                if(newYY>this.dis_yy){\r\n                    attWall=wall;\r\n                    this.dis_yy=newYY;\r\n                }\r\n            }\r\n        })\r\n        \r\n        if(attWall){\r\n            this.setEnemyState(Enemy_State.skill);\r\n            this.skill_cold_down[0]=this.skill_data.getSkillColdDown(1);\r\n            let pos=this.getAttPos();\r\n            let data=new KeyFrameData();\r\n            data.name=\"Skill\"\r\n            data.callback=()=>{\r\n                this.is_skill_state=true;\r\n                this.skill_cold_down[0]=this.skill_data.getSkillColdDown(1);\r\n                //链锁Root\r\n                this.lian_root=GameEffectsManager.getInstance().createGameEffectById(GameEffectId.monster73_skill_lian_root,pos);\r\n                //出钩\r\n                this.gou=GameEffectsManager.getInstance().createGameEffectById(GameEffectId.monster73_skill_mao,pos);\r\n                if(this.node.scaleX>0){\r\n                    this.gou.angle=200;\r\n                }else{\r\n                    this.gou.angle=130;\r\n                }\r\n                //计算铁链数量\r\n                let lianNum=Math.ceil(offsetYY/this.lian_jiange)+4;\r\n                for(let i=0; i<lianNum; i++){\r\n                    GameEffectsManager.getInstance().createGameEffectForParent(GameEffectId.monster73_skill_lian,cc.v2(0,i*65),this.lian_root);\r\n                }\r\n                this.lian_root.height=0;\r\n                this.lian_root.angle=180;\r\n            };\r\n            super.playSpinAnimaton(\"Side_Skill_1\",false,data,()=>{\r\n                super.playSpinAnimaton(\"Side_Skill_2\",true);\r\n            })\r\n            \r\n        }         \r\n    }\r\n\r\n    endSkill(){\r\n        this.is_skill_state=false;\r\n        this.destroyLian();\r\n        super.playSpinAnimaton(\"Side_Skill_3\",false,null,()=>{\r\n            if(this.getIsDie()==false){\r\n                this.startIdle();\r\n                this.setEnemyState(Enemy_State.move);\r\n            }            \r\n        })\r\n    }\r\n\r\n    destroyLian() {\r\n        if(this.gou){\r\n            GameEffectsManager.getInstance().destroyGameEffectById(GameEffectId.monster73_skill_mao,this.gou);\r\n            this.gou=null;\r\n        }\r\n        if(this.lian_root){\r\n            for(let i=this.lian_root.childrenCount-1; i>=0; i--){\r\n                GameEffectsManager.getInstance().destroyGameEffectById(GameEffectId.monster73_skill_lian,this.lian_root.children[i]);\r\n            }\r\n            GameEffectsManager.getInstance().destroyGameEffectById(GameEffectId.monster73_skill_lian_root,this.lian_root);\r\n            this.lian_root=null;\r\n        }                                \r\n    }\r\n\r\n    onGouColliderWall(){\r\n        this.is_gou_ok=true;\r\n    }\r\n\r\n    update(dt: any): void {\r\n        super.update(dt);\r\n        this.checkSkill(dt);\r\n        if(this.is_skill_state&&GameManager.getInstance().cur_game_state==GameState.Game_Playing){\r\n            if(this.gou){\r\n                if(this.isHaveDeBuff(BuffId.Hero_MeiMo_Active_MeiHuo)){\r\n                    this.onMonsterNormalXuanYun(true);\r\n                    return;\r\n                }\r\n                let pos=super.getAttPos();\r\n                if(this.gou.y<=this.dis_yy){\r\n                    this.gou.y=this.dis_yy;\r\n                    //跟随勾走\r\n                    let offsetPos=this.gou.getPosition().sub(this.getAttPos());\r\n                    let dir=Math.atan2(offsetPos.y,offsetPos.x);\r\n                    this.node.y=this.node.y+Math.sin(dir)*dt*this.gou_speed/3;\r\n                    this.node.x=this.node.x+Math.cos(dir)*dt*this.gou_speed/3;\r\n                    pos=super.getAttPos();\r\n                    let walls=WallManager.getInstance().getAllWall();\r\n                    let attWall:Wall=null;\r\n                    walls.forEach((wall:Wall,wallType:WallType)=>{\r\n                        //攻击城墙的条件1，必须在城墙之上,2达到攻击距离\r\n                        if(this.node.y>=wall.getWallMaxYY()){                \r\n                            attWall=wall;\r\n                        }\r\n                    })\r\n                    //this.gou.setPosition(pos);                    \r\n                    offsetPos=this.gou.getPosition().sub(pos);\r\n                    this.lian_root.height=offsetPos.mag();\r\n                    dir=Math.atan2(offsetPos.y,offsetPos.x);\r\n                    this.lian_root.angle=MyTool.radianToAngle(dir)-90;\r\n                    this.lian_root.setPosition(pos);\r\n                    if(pos.y<=(attWall.getWallMaxYY()+80)){\r\n                        this.endSkill();\r\n                        return\r\n                    }\r\n                }\r\n                else{                    \r\n                    //钩要先走\r\n                    this.gou.y-=dt*this.gou_speed;\r\n                    //铁链\r\n                    let offsetPos=this.gou.getPosition().sub(pos);\r\n                    this.lian_root.height=offsetPos.mag();\r\n                    let dir=Math.atan2(offsetPos.y,offsetPos.x);\r\n                    this.lian_root.angle=MyTool.radianToAngle(dir)-90;\r\n                    this.lian_root.setPosition(pos);\r\n                    let walls=WallManager.getInstance().getAllWall();                    \r\n                    walls.forEach((wall:Wall,wallType:WallType)=>{\r\n                        //攻击城墙的条件1，必须在城墙之上,2达到攻击距离\r\n                        if(this.gou.y>=wall.getWallMaxYY()){                                            \r\n                            let newYY=wall.getWallMaxYY()+80;\r\n                            if(newYY>this.dis_yy){\r\n                                this.dis_yy=newYY;\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n                if((pos.y<=this.dis_yy)){\r\n                    this.endSkill();\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    checkSkill(dt:number){\r\n        for(let i=0; i<1; i++){            \r\n            if(this.skill_cold_down[i]>0){\r\n                this.skill_cold_down[i]-=dt;\r\n                if(this.skill_cold_down[i]<0){\r\n                    this.skill_cold_down[i]=0;\r\n                    this.startSkill();\r\n                }                \r\n            }else{\r\n                this.startSkill();\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\CombatNumEffect.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { HeroData } from \"./Hero/Data/HeroData\";\r\nimport LanguageManager from \"./multiLanguage/LanguageManager\";\r\nimport MyTool from \"./Tools/MyTool\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class CombatNumEffect extends cc.Component {\r\n\r\n    startAnimation(oldCombatNum:number,newCombatNum:number,oldHeroData:HeroData,newHeroData:HeroData){\r\n        // startAnimation(oldCombatNum:number,newCombatNum:number,oldHeroData:HeroData,newHeroData:HeroData,callback:Function){\r\n        let attribute = this.node.getChildByName(\"attribute\")\r\n        this.unscheduleAllCallbacks();\r\n        cc.Tween.stopAllByTarget(attribute);\r\n        cc.Tween.stopAllByTarget(this.node);\r\n        attribute.setPosition(0,-100,0);\r\n        cc.tween(this.node).to(0.2,{opacity:255}).to(0.8,{opacity:255}).to(0.3,{opacity:0}).start();\r\n        let combat = this.node.getChildByName(\"combat\");\r\n        combat.children[1].getComponent(cc.Label).string = MyTool.getCoinDanwei(oldCombatNum);\r\n        let s = '';\r\n        // s += LanguageManager.getInstance().getStrByTextId(110014) + \"+\" + (newHeroData.Attack - oldHeroData.Attack) + '\\n';\r\n        // s += LanguageManager.getInstance().getStrByTextId(110015) + \"+\" + (newHeroData.Defense - oldHeroData.Defense) + '\\n';\r\n        // s += LanguageManager.getInstance().getStrByTextId(110016) + \"+\" + (newHeroData.Health - oldHeroData.Health) + '\\n';\r\n        // s += LanguageManager.getInstance().getStrByTextId(110017) + \"+\" + (newHeroData.Hit - oldHeroData.Hit) + '\\n';\r\n        // s += LanguageManager.getInstance().getStrByTextId(110018) + \"+\" + (newHeroData.Miss - oldHeroData.Miss) + '\\n';\r\n        // s += LanguageManager.getInstance().getStrByTextId(110019) + \"+\" + (newHeroData.Critical - oldHeroData.Critical) + '\\n';\r\n        // s += LanguageManager.getInstance().getStrByTextId(110021) + \"+\" + (newHeroData.AntiCritical - oldHeroData.AntiCritical) + '\\n';\r\n        // s += LanguageManager.getInstance().getStrByTextId(110020) + \"+\" + (newHeroData.ExtraCritical - oldHeroData.ExtraCritical) + '\\n';\r\n        // s += LanguageManager.getInstance().getStrByTextId(110022) + \"+\" + (newHeroData.AntiExtraCritical - oldHeroData.AntiExtraCritical) + '\\n';\r\n        s += this.getColor(110014,newHeroData.total_attack,oldHeroData.total_attack);\r\n        s += this.getColor(110015,newHeroData.total_defense,oldHeroData.total_defense);\r\n        s += this.getColor(110016,newHeroData.total_hp,oldHeroData.total_hp);\r\n        s += this.getColor(110017,newHeroData.Hit,oldHeroData.Hit);\r\n        s += this.getColor(110018,newHeroData.Miss,oldHeroData.Miss);\r\n        s += this.getColor(110019,newHeroData.Critical,oldHeroData.Critical);\r\n        s += this.getColor(110021,newHeroData.AntiCritical,oldHeroData.AntiCritical);\r\n        if(newHeroData.ExtraCritical * 100 != oldHeroData.ExtraCritical * 100)\r\n            s += this.getPercentColor(110020,newHeroData.ExtraCritical,oldHeroData.ExtraCritical);\r\n        if(newHeroData.AntiExtraCritical * 100 != oldHeroData.AntiExtraCritical * 100)\r\n            s += this.getPercentColor(110022,newHeroData.AntiExtraCritical,oldHeroData.AntiExtraCritical);\r\n        s = \"<b><color=#69FF5E><outline color=#010900 width=2><size = 26>\" + s + \"</b></outline></color></size>\";\r\n        attribute.getComponent(cc.RichText).string = s;\r\n        cc.tween(attribute).by(0.2,{position:cc.v3(0,130,0)}).start();\r\n        let temp = 0;\r\n        let offset = Math.floor(newCombatNum - oldCombatNum);\r\n        combat.children[2].getComponent(cc.Label).string = \"\";\r\n        if(offset < 0){\r\n            combat.children[2].color = cc.color(255,78,78);\r\n            combat.children[2].getComponent(cc.LabelOutline).color = cc.color(57,0,0);\r\n        }else{\r\n            combat.children[2].color = cc.color(109,255,98);\r\n            combat.children[2].getComponent(cc.LabelOutline).color = cc.color(5, 77, 0); \r\n        }\r\n        let t = 0;\r\n        let num = 17;\r\n        let incremental = Math.floor(offset/num)\r\n        this.schedule(()=>{\r\n            temp += incremental;\r\n            if(Math.abs(offset) - Math.abs(temp) < Math.abs(incremental)){\r\n                temp = offset;\r\n            }\r\n            if(temp > 0){\r\n                combat.children[2].getComponent(cc.Label).string = \"+\" + MyTool.mynum_con1(temp+\"\");\r\n            }else{\r\n                combat.children[2].getComponent(cc.Label).string = MyTool.mynum_con1(temp+\"\");\r\n            }\r\n            t++;\r\n            if(t == num){\r\n                this.scheduleOnce(()=>{\r\n                    this.node.active = false;\r\n            //         callback();\r\n                },0.9);\r\n            }\r\n        },0.03,num,0);\r\n    }\r\n\r\n    getColor(tid:number,newNum:number,oldNum:number):string{\r\n        let s = '';\r\n        let result = Math.floor(newNum - oldNum);\r\n        if(result != 0){\r\n            if(result > 0){\r\n                s = LanguageManager.getInstance().getStrByTextId(tid) + \"+\" + result + '\\n';\r\n            }else{\r\n                s = \"<color = #ff4e4e> <outline color = #390000 width=2>\" + LanguageManager.getInstance().getStrByTextId(tid) + result + \"</outline></color>\" + '\\n';\r\n            }\r\n        }\r\n        return s;\r\n    }\r\n\r\n    getPercentColor(tid:number,newNum:number,oldNum:number):string{\r\n        let s = '';\r\n        let result = Math.floor(Math.floor(newNum * 100) - Math.floor(oldNum * 100));\r\n        if(result != 0){\r\n            if(result > 0){\r\n                s = LanguageManager.getInstance().getStrByTextId(tid) + \"+\" + result + \"%\" + '\\n';\r\n            }else{\r\n                s = \"<color = #ff4e4e> <outline color = #390000 width=2>\" + LanguageManager.getInstance().getStrByTextId(tid) + result + \"%\" + \"</outline></color>\" + '\\n';\r\n            }\r\n        }\r\n        return s;\r\n    }\r\n\r\n}\r\n"]}
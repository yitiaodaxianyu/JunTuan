{"version":3,"sources":["assets\\Scripts\\Hero\\Game\\SheShou\\JianShi.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport { GameEffectsManager, GameEffectId } from \"../../../Game/GameEffectsManager\";\r\nimport Monster from \"../../../Monster/Monster\";\r\nimport { FeedBackType } from \"../../../Monster/MonsterData\";\r\nimport MonsterManager from \"../../../Monster/MonsterManager\";\r\nimport MyTool from \"../../../Tools/MyTool\";\r\nimport { BuffData } from \"../BuffData\";\r\nimport Bullect from \"../Bullect\";\r\nimport { BuffId, BuffType, DamageType, JianShi_Type, SkillType } from \"../HeroConfig\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class JianShi extends Bullect {\r\n\r\n    @property({type:cc.Enum(JianShi_Type)})\r\n    jianshi_type:JianShi_Type=JianShi_Type.putong;\r\n\r\n    onLoad(): void {\r\n        super.onLoad();\r\n        super.addCollisionMonsterListen(this.onCollisionMonster);\r\n    }\r\n    \r\n    ////--------------------------------------碰撞开始----------------------------------------------------\r\n    onCollisionMonster(monsterTs:Monster) {\r\n        if(monsterTs){\r\n            switch(this.jianshi_type){\r\n                case JianShi_Type.putong:{\r\n                    let data=monsterTs.beFlashInjured(this.gongji_data);\r\n                    if(data.getDamageNum()>0){\r\n                        //本次攻击有效                        \r\n                        if(data.feedback_type==FeedBackType.BaoJi){\r\n                            if(this.gongji_data.hero_data.getIsUnlock(SkillType.Passive_2)){\r\n                                //判断锥形范围的敌人\r\n                                let fanweiData=cc.instantiate(this.gongji_data);\r\n                                fanweiData.damage_type=DamageType.Skill;\r\n                                fanweiData.is_bullet=false;\r\n                                fanweiData.skill_damage_rate=this.gongji_data.hero_data.getSkillValue1(SkillType.Passive_2);\r\n                                let shanxing=GameEffectsManager.getInstance().createGameEffectById(GameEffectId.sheshou_attack_ctrl_hit,this.node.getPosition());\r\n                                shanxing.angle=this.node.angle;\r\n                                //减速\r\n                                let distance=220;\r\n                                let min=this.move_direction-Math.PI/4;//45°+90\r\n                                let max=min+Math.PI/2;//135°\r\n                                //cc.log(MyTool.radianToAngle(this.move_direction),MyTool.radianToAngle(min),MyTool.radianToAngle(max))\r\n                                let allMonsters=MonsterManager.getInstance().getMonstersForRadian(-1,this.node.getPosition(),distance,min,max);\r\n                                if(allMonsters){\r\n                                    for(let i=0; i<allMonsters.length; i++){\r\n                                        let monsterTTs=allMonsters[i].getComponent(Monster);\r\n                                        monsterTTs.beFlashInjured(fanweiData);;                                    \r\n                                    }\r\n                                }\r\n                            }else{\r\n                                GameEffectsManager.getInstance().createGameEffectById(GameEffectId.sheshou_jianshi_att_hit,this.node.getPosition());\r\n                            }\r\n                        }else{\r\n                            GameEffectsManager.getInstance().createGameEffectById(GameEffectId.sheshou_jianshi_att_hit,this.node.getPosition());\r\n                        }\r\n                    }\r\n                    this.is_att=true;\r\n                    this.destroySelf();\r\n                }break;\r\n                case JianShi_Type.jineng:{\r\n                    let data=monsterTs.beFlashInjured(this.gongji_data);\r\n                    if(data.getDamageNum()>0){\r\n                        //本次攻击有效\r\n                        let node=GameEffectsManager.getInstance().createGameEffectById(GameEffectId.sheshou_jianshi_att_hit,this.getHeadPos());\r\n                        //node.scale=monsterTs.getSheShouAttackScale();\r\n                        this.is_att=true;\r\n                        this.destroySelf();\r\n                    }else{\r\n                        if(data.feedback_type!=FeedBackType.Die)\r\n                            this.destroySelf();\r\n                    }\r\n                }break;\r\n                case JianShi_Type.super:{\r\n                    let data=monsterTs.beFlashInjured(this.gongji_data);\r\n                    if(data.getDamageNum()>0){\r\n\r\n                    }\r\n                }break;\r\n            }\r\n            \r\n        }\r\n    }\r\n}\r\n"]}
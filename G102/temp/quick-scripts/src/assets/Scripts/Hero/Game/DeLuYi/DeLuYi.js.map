{"version":3,"sources":["assets\\Scripts\\Hero\\Game\\DeLuYi\\DeLuYi.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport { GameState, IsDebug, JiaSu } from \"../../../Constants\";\r\nimport FightingManager from \"../../../Game/FightingManager\";\r\nimport { GameEffectId, GameEffectsManager } from \"../../../Game/GameEffectsManager\";\r\nimport GroundManager from \"../../../Game/GroundManager\";\r\nimport SkillManager from \"../../../Game/SkillManager\";\r\nimport GameManager from \"../../../GameManager\";\r\nimport Monster from \"../../../Monster/Monster\";\r\nimport { KeyFrameData, StrengthType } from \"../../../Monster/MonsterData\";\r\nimport MonsterManager from \"../../../Monster/MonsterManager\";\r\nimport { SoundIndex } from \"../../../Sound/AudioConstants\";\r\nimport { GongJiData } from \"../../Data/HeroData\";\r\nimport { BuffData } from \"../BuffData\";\r\nimport Hero from \"../Hero\";\r\nimport { BuffId, BuffType, DamageType, GongJi_FangXiang,Hero_State,SkillType,} from \"../HeroConfig\";\r\nimport SuperManTeng from \"./SuperManTeng\";\r\nimport WuNvDan from \"./WuNvDan\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class WuNv extends Hero {\r\n    \r\n\r\n    onLoad()\r\n    {\r\n        super.onLoad();\r\n        //加载技能指示器\r\n        //super.loadZhiShiQi(\"manteng_zhishi_qi\",SkillIndicatorType.target);\r\n        super.addLoadByGameEffectId(GameEffectId.deluyi_att,1);\r\n        super.addLoadByGameEffectId(GameEffectId.deluyi_att_hit,1);\r\n        super.addLoadByGameEffectId(GameEffectId.deluyi_att_baoji,4);\r\n        super.addLoadByGameEffectId(GameEffectId.deluyi_skill_manteng,4);\r\n        super.addLoadByGameEffectId(GameEffectId.deluyi_active_skill_hit,4);\r\n        super.addLoadByGameEffectId(GameEffectId.deluyi_active_skill,4);\r\n        super.addLoadByGameEffectId(GameEffectId.deluyi_skill_beidong_create,1);\r\n        super.addLoadByGameEffectId(GameEffectId.xuanyun,4);\r\n        //super.addLoadByGameEffectId(GameEffectId.monster_zhongdu,4);\r\n        this.addSkillListen(this.useSkill);\r\n        this.addAttackListen(this.normalAttack);\r\n        this.addXuanYunListen(this.onXuanYunResult);\r\n        this.addHitListen(this.onHitMonster);\r\n    }\r\n\r\n    start()\r\n    {        \r\n        super.start();\r\n        this.is_need_check_distance=true;\r\n        super.setSkillTipSize(1680,384);\r\n        if(this.hero_data.ExclusiveWeaponSkillValue_1&&this.hero_data.ExclusiveWeaponSkillValue_1>0)\r\n        {\r\n            SkillManager.getInstance().setDeLuYiEx(this.hero_data.ExclusiveWeaponSkillValue_1)\r\n        }\r\n        // if(IsDebug){\r\n        //     SkillManager.getInstance().setDeLuYiEx(10)\r\n        // }\r\n    }\r\n    \r\n    onXuanYunResult(isXuanYun:boolean){\r\n        if(isXuanYun){\r\n            this.unscheduleAllCallbacks();\r\n        }else{\r\n            //根据上个状态判断需要做什么\r\n            this.setHeroState(Hero_State.idle,GongJi_FangXiang.zhong);\r\n        }\r\n    }\r\n\r\n    //---------------------------------------------攻击----------------------------------------------\r\n    /**暴击时对{参数1}范围内的敌人额外造成{参数2}%伤害并造成1秒眩晕效果 */\r\n    onHitMonster(damageType:DamageType,isCrit:boolean,monster:cc.Node){\r\n        if(damageType==DamageType.Normal){\r\n            let monsterTsT=monster.getComponent(Monster);\r\n            //圆形眩晕\r\n            let monsters=MonsterManager.getInstance().getMonstersForCenterPos(-1,monsterTsT.getCenterPos(),this.hero_data.getSkillValue1(SkillType.Passive_1));\r\n            if(monsters){\r\n                let fanweiData=super.getGongJiData(DamageType.Skill,false,SkillType.Passive_1,this.hero_data.getSkillValue2(SkillType.Passive_1));\r\n                for(let i=0; i<monsters.length; i++){\r\n                    let monsterTs=monsters[i].getComponent(Monster);\r\n                    let data=monsterTs.beFlashInjured(fanweiData);\r\n                    if(!data.is_die && data.getDamageNum()>0){\r\n                        if(isCrit){\r\n                            GameEffectsManager.getInstance().createGameEffectById(GameEffectId.deluyi_att_baoji,monsterTs.getCenterPos());\r\n                        }else{\r\n                            GameEffectsManager.getInstance().createGameEffectById(GameEffectId.deluyi_att_hit,monsterTs.getCenterPos());   \r\n                        }\r\n                        /**概率眩晕 */\r\n                        let rate=this.hero_data.getSkillValue3(SkillType.Passive_1);\r\n                        if(monsterTs.getStrengthType()!=StrengthType.Boss&&Math.random()<rate){\r\n                            let buffData=new BuffData();\r\n                            buffData.buff_id=BuffId.Hero_XuanYun;\r\n                            buffData.buff_type=BuffType.Vertigo;\r\n                            buffData.buff_value=[0];\r\n                            buffData.remain_time=0.5;\r\n                            buffData.game_effect_id=GameEffectId.xuanyun;\r\n                            monsterTs.addDeBuff(buffData,fanweiData);\r\n                            //蔓藤特效\r\n                            let node=GameEffectsManager.getInstance().createGameEffectById(GameEffectId.deluyi_skill_manteng,this.node.getPosition());\r\n                            node.getComponent(cc.Animation).play();\r\n                            cc.tween(node).delay(buffData.remain_time).call(()=>{\r\n                                GameEffectsManager.getInstance().destroyGameEffectById(GameEffectId.deluyi_skill_manteng,node);\r\n                            }).start();\r\n                        }\r\n                        \r\n                    }\r\n                }\r\n            }         \r\n        }\r\n    }\r\n\r\n    createWuNvDan(id:GameEffectId,jianshiPos:cc.Vec2,speed:number,dir:number,gjData:GongJiData){\r\n        let node=FightingManager.getInstance().createGameEffectById(id,jianshiPos);\r\n        node.getComponent(WuNvDan).init(id,speed,dir,gjData);\r\n    }   \r\n\r\n    createSuperManTeng(id:GameEffectId,jianshiPos:cc.Vec2,speed:number,dir:number,gjData:GongJiData):cc.Node{\r\n        let node=GroundManager.getInstance().createGameEffectById(id,jianshiPos);\r\n        node.getComponent(SuperManTeng).init(id,speed,dir,gjData);\r\n        return node;\r\n    }\r\n\r\n    normalAttack(monster:cc.Node)\r\n    {\r\n        if(GameManager.getInstance().cur_game_state!=GameState.Game_Playing)\r\n        return;\r\n        this.is_can_gongji=false;\r\n        this.startAttack(monster);\r\n    }\r\n\r\n    startAttack(enemyNode:cc.Node)\r\n    {\r\n        let enemyPos=enemyNode.getComponent(Monster).getSheShouPos();\r\n        let fangxiang=this.getFangXiangByPos(enemyPos);\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.YX_FashiAttack);\r\n        let data=new KeyFrameData();\r\n        data.name=\"Attack\";\r\n        data.callback=()=>{\r\n            // let rate=this.hero_data.getSkillValue1(SkillType.Passive_1);\r\n            // if(rate&&Math.random()<rate){\r\n            //     let gjData=super.getGongJiData(DamageType.Skill,true,this.hero_data.getSkillValue2(SkillType.Passive_1),0.5);//0.5是专武的\r\n            //     let offsetPos=enemyPos.sub(this.node.getPosition());\r\n            //     let jianshiDir=Math.atan2(offsetPos.y,offsetPos.x);\r\n            //     this.createManTeng(GameEffectId.nvwu_att_manteng_bg,this.node.getPosition(),this.bullet_speed,jianshiDir,gjData);\r\n            // }else{\r\n            //     let jianshiPos=this.getCreateBulletPos();\r\n            //     let offsetPos=enemyPos.sub(jianshiPos);\r\n            //     let jianshiDir=Math.atan2(offsetPos.y,offsetPos.x);\r\n            //     let gjData=super.getGongJiData(DamageType.Normal,true);\r\n            //     this.createWuNvDan(GameEffectId.nvwu_att,jianshiPos,this.bullet_speed,jianshiDir,gjData);\r\n            // }\r\n            let jianshiPos=this.getCreateBulletPos();\r\n            let offsetPos=enemyPos.sub(jianshiPos);\r\n            let jianshiDir=Math.atan2(offsetPos.y,offsetPos.x);\r\n            let gjData=super.getGongJiData(DamageType.Normal,true,SkillType.Null);\r\n            this.createWuNvDan(GameEffectId.deluyi_att,jianshiPos,this.bullet_speed,jianshiDir,gjData);     \r\n            if(this.is_double_attack){\r\n                this.resetNormalAttack();\r\n            }else{\r\n                this.gongji_jishu=0;\r\n            }\r\n        }\r\n        super.setHeroState(Hero_State.attack,fangxiang,[data],()=>{\r\n            this.setHeroState(Hero_State.idle,this.cur_fangxiang);\r\n        });\r\n    }\r\n\r\n    //---------------------------------------------技能----------------------------------------------    \r\n    useSkill(pos:cc.Vec2):number\r\n    {\r\n        SkillManager.getInstance().releaseSkill(()=>{\r\n            this.startSelfXuLi(pos);\r\n        },this.node);\r\n        return 0;\r\n    }\r\n\r\n    startSelfXuLi(pos:cc.Vec2){\r\n        //蓄力帧监听\r\n        let heroRoot=cc.find('Canvas/Hero_Root');        \r\n        //发射帧监听\r\n        let fasheData=new KeyFrameData();\r\n        fasheData.name=\"FaShe\";\r\n        fasheData.callback=()=>{\r\n            //可以发射\r\n            SkillManager.getInstance().setTimeStop(false);\r\n            this.node.parent=heroRoot;\r\n            this.node.zIndex=2;\r\n            this.startLaunch(pos);\r\n        }\r\n        //英雄动作播放\r\n        this.setHeroState(Hero_State.skill,GongJi_FangXiang.zhong,[fasheData],()=>{\r\n            //动作完毕后状态还是技能状态，动画要播放待机的\r\n            this.resetGongJiJiShu();\r\n            this.setHeroState(Hero_State.idle,GongJi_FangXiang.zhong);\r\n        });\r\n        this.spine.timeScale=JiaSu;\r\n    }\r\n    /**在目标区域的左右两边各召唤一阵藤蔓冲击波，藤蔓冲击波会向屏幕另一端滚动，途中速度会逐渐加快，对触碰到的敌人造成{参数1}%伤害，并造成{参数2}秒眩晕效果 */\r\n    startLaunch(pos:cc.Vec2){\r\n        super.setAttSpineScale();\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.YX_FashiSkill1);        \r\n        let initYY=pos.y-192+192/2;\r\n        let gjData=super.getGongJiData(DamageType.Skill,false,SkillType.Active,this.hero_data.getSkillValue1(SkillType.Active));\r\n        //右边\r\n        for(let i=0; i<2; i++){\r\n            let xx=350;\r\n            let yy=initYY+i*192;\r\n            let mt=this.createSuperManTeng(GameEffectId.deluyi_active_skill,cc.v2(xx,yy),this.bullet_speed/2,Math.PI,gjData);            \r\n            let bc=mt.getComponent(cc.BoxCollider);\r\n            bc.enabled=i==1;\r\n            bc.offset=cc.v2(-96,0);\r\n        }\r\n        //左边\r\n        for(let i=0; i<2; i++){\r\n            let xx=-350;\r\n            let yy=initYY+i*192;\r\n            let mt=this.createSuperManTeng(GameEffectId.deluyi_active_skill,cc.v2(xx,yy),this.bullet_speed/2,0,gjData);\r\n            let bc=mt.getComponent(cc.BoxCollider);\r\n            bc.enabled=i==1;\r\n            bc.offset=cc.v2(96,0);\r\n        }\r\n        SkillManager.getInstance().setIsSkillState(false);\r\n    }\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\Hero\\Game\\DamageRecord.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { GameState } from \"../../Constants\";\r\nimport { GameEffectId, GameEffectsManager } from \"../../Game/GameEffectsManager\";\r\nimport GameManager from \"../../GameManager\";\r\nimport { HeroManager } from \"../Data/HeroManager\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class DamageRecord extends cc.Component {\r\n    /**游戏特效id */\r\n    game_effect_id:GameEffectId=GameEffectId.Null;\r\n    private value_label:cc.Label=null;\r\n    private total_value:number=0;\r\n    private remain_time:number=5;\r\n    /**销毁回调 */\r\n    private destroy_callback:Function=null;\r\n    private skill_release_id:number=0;\r\n\r\n    init(gameEffectId:GameEffectId,skillReleaseId:number,value:number,callback:Function){                \r\n        this.game_effect_id=gameEffectId;\r\n        this.skill_release_id=skillReleaseId;\r\n        this.destroy_callback=callback;\r\n        let heroId=Math.floor(skillReleaseId/10000);\r\n        let icon=this.node.getChildByName('icon').getComponent(cc.Sprite);\r\n        icon.spriteFrame=HeroManager.getInstance().getSpriteFrameByNames('Hero_'+heroId+'_Skill_0');\r\n        if(!this.value_label){\r\n            this.value_label=this.node.getChildByName('num').getComponent(cc.Label);\r\n        }\r\n        this.total_value=0;\r\n        this.refreshValue(value);\r\n    }\r\n    /**刷新伤害值 */\r\n    refreshValue(value:number){\r\n        this.remain_time=5;\r\n        this.node.opacity=255;\r\n        this.total_value+=Math.round(value);\r\n        this.value_label.string=this.total_value.toString();\r\n    }\r\n\r\n    destroySelf(){\r\n        GameEffectsManager.getInstance().destroyGameEffectById(this.game_effect_id,this.node);\r\n        if(this.destroy_callback){\r\n            this.destroy_callback(this.skill_release_id);\r\n        }\r\n    }\r\n\r\n    protected update(dt: number): void {\r\n        if(GameManager.getInstance().cur_game_state==GameState.Game_Playing){\r\n            if(this.remain_time>0){\r\n                this.remain_time-=dt;\r\n                if(this.remain_time<=2){\r\n                    this.node.opacity-=2;\r\n                    if(this.remain_time<=0){\r\n                        this.remain_time=0;\r\n                        this.destroySelf();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\Hero\\Game\\LeiShen\\LeiShen.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport { GameState, IsDebug, JiaSu } from \"../../../Constants\";\r\nimport { GameEffectId, GameEffectsManager } from \"../../../Game/GameEffectsManager\";\r\nimport GroundManager from \"../../../Game/GroundManager\";\r\nimport SkillManager from \"../../../Game/SkillManager\";\r\nimport GameManager from \"../../../GameManager\";\r\nimport Monster from \"../../../Monster/Monster\";\r\nimport { KeyFrameData } from \"../../../Monster/MonsterData\";\r\nimport MonsterManager from \"../../../Monster/MonsterManager\";\r\nimport { SoundIndex } from \"../../../Sound/AudioConstants\";\r\nimport MyTool from \"../../../Tools/MyTool\";\r\nimport { BuffData } from \"../BuffData\";\r\nimport Hero from \"../Hero\";\r\nimport { BuffId, BuffType, DamageType, GongJi_FangXiang,Hero_State, SkillType } from \"../HeroConfig\";\r\nimport ChainLightning from \"./ChainLightning\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class LeiShen extends Hero {\r\n    /**被闪电过的怪的uuid */\r\n    shandian_monster:string[]=[];\r\n\r\n//---------------------------------------------加载----------------------------------------------\r\n    onLoad()\r\n    {\r\n        super.onLoad();\r\n        super.addLoadByGameEffectId(GameEffectId.xuanyun,4);\r\n        super.addLoadByGameEffectId(GameEffectId.lei_shen_shandian,4);\r\n        super.addLoadByGameEffectId(GameEffectId.lei_shen_shandian_hit,4);\r\n        super.addLoadByGameEffectId(GameEffectId.lei_shen_skill_ground,4);\r\n        super.addLoadByGameEffectId(GameEffectId.lei_shen_skill_sky,1);\r\n        this.is_LoadLoad=true;\r\n\r\n        this.addSkillListen(this.useSkill);\r\n        this.addAttackListen(this.normalAttack);\r\n        this.addXuanYunListen(this.onXuanYunResult);\r\n        this.addHitListen(this.onHitMonster);\r\n        this.addResetListen(this.onResetState);\r\n    }\r\n\r\n    onResetState(){\r\n\r\n        \r\n    }\r\n\r\n    onXuanYunResult(isXuanYun:boolean){\r\n        /**雷神技能状态无法被控制 */\r\n        if(isXuanYun&&this.getHeroState()!=Hero_State.skill){\r\n            this.unscheduleAllCallbacks();\r\n            \r\n        }else{\r\n            //根据上个状态判断需要做什么\r\n            this.setHeroState(Hero_State.idle,GongJi_FangXiang.zhong);\r\n        }\r\n    }\r\n\r\n    //---------------------------------------------攻击-------------------------------------------------\r\n    onHitMonster(damageType:DamageType,isCrit:boolean,monster:cc.Node){\r\n        \r\n    }\r\n\r\n    normalAttack(monster:cc.Node)\r\n    {\r\n        if(GameManager.getInstance().cur_game_state!=GameState.Game_Playing)\r\n        return;\r\n        //求出方向\r\n        this.is_can_gongji=false;\r\n        this.startAttack(monster);\r\n    }\r\n    /**普攻对敌人释放一道闪电，可以连续弹射{参数1}名敌人（每个敌人人只能被弹射一次），造成{参数2}%伤害并施加一层“超负荷” */\r\n    startAttack(enemyNode:cc.Node)\r\n    {\r\n        let enemyPos=enemyNode.getComponent(Monster).getSheShouPos();\r\n        let fangxiang=this.getFangXiangByPos(enemyPos);        \r\n        let data=new KeyFrameData();\r\n        data.name=\"Attack\";\r\n        data.callback=()=>{\r\n            this.shandian_monster=new Array();\r\n            this.createShanDian(null,enemyNode.getComponent(Monster));\r\n            GameManager.getInstance().sound_manager.playSound(SoundIndex.YX_LeiGodAttack);\r\n            if(this.is_double_attack){\r\n                this.resetNormalAttack();\r\n            }else{\r\n                this.gongji_jishu=0;\r\n            }\r\n        }\r\n        super.setHeroState(Hero_State.attack,fangxiang,[data],()=>{\r\n            this.setHeroState(Hero_State.idle,this.cur_fangxiang);\r\n        });\r\n    }\r\n    /**当敌人身上的超负荷达到5层时，会受到落雷攻击造成{参数1}伤害并击晕{参数2}秒 */\r\n    createShanDian(firstMonster:Monster,endMonster:Monster){        \r\n        this.shandian_monster.push(endMonster.uuid);\r\n        let shandian=GameEffectsManager.getInstance().createGameEffectById(GameEffectId.lei_shen_shandian,this.getCreateBulletPos());\r\n        shandian.getComponent(ChainLightning).init(GameEffectId.lei_shen_shandian,firstMonster,endMonster,this.onEndMonster.bind(this));\r\n        let gjData=this.getGongJiData(DamageType.Skill,false,SkillType.Passive_1,this.hero_data.getSkillValue2(SkillType.Passive_1))\r\n        let data=endMonster.beFlashInjured(gjData);\r\n        GameEffectsManager.getInstance().createGameEffectById(GameEffectId.lei_shen_shandian_hit,endMonster.getCenterPos());\r\n        if(this.hero_data.getIsUnlock(SkillType.Passive_2)&&data.getDamageNum()>0&&data.is_die==false){\r\n            let buffData=new BuffData();\r\n            buffData.buff_id=BuffId.Hero_LeiShen_ChaoFuHe;\r\n            buffData.remain_time=60;\r\n            buffData.buff_type=BuffType.Burst;\r\n            buffData.buff_value=[4];\r\n            buffData.game_effect_id=GameEffectId.Null;\r\n            buffData.add_floor=1;            \r\n            let damageRate=this.hero_data.getSkillValue1(SkillType.Passive_2)\r\n            endMonster.addDeBuff(buffData,this.getGongJiData(DamageType.Skill,false,SkillType.Passive_2,damageRate));\r\n        }\r\n    }\r\n\r\n    onEndMonster(endMonster:Monster){        \r\n        let tansheNum=this.hero_data.getSkillValue1(SkillType.Passive_1);\r\n        if(this.shandian_monster.length<tansheNum){\r\n            let nextMonster=this.getMonster(endMonster.getCenterPos());\r\n            if(nextMonster){\r\n                this.createShanDian(endMonster,nextMonster);\r\n            }\r\n        }\r\n    }\r\n\r\n    getIsTanShe(uuid:string):boolean{\r\n        return this.shandian_monster.indexOf(uuid)>=0;\r\n    }\r\n\r\n    getMonster(pos:cc.Vec2):Monster\r\n    {\r\n        let em=MonsterManager.getInstance();        \r\n        if(em.node.childrenCount<=0)\r\n        {\r\n            return null;\r\n        }\r\n        //1.先检测在攻击范围内符合攻击单位的敌人\r\n        let attMonsters:Monster[]=new Array();\r\n        for(let enemy of em.node.children)\r\n        {\r\n            let enemyTS=enemy.getComponent(Monster);\r\n            if(enemyTS && enemyTS.getIsCanCheck()==true)\r\n            {\r\n                let distance=pos.sub(enemyTS.getCenterPos()).mag();\r\n                if(this.getIsTanShe(enemyTS.uuid)==false && distance<=500)\r\n                {\r\n                    attMonsters.push(enemyTS);\r\n                }\r\n            }\r\n        }\r\n        if(attMonsters.length<=0)\r\n        {\r\n            return null;\r\n        }\r\n        if(1==attMonsters.length)\r\n        {\r\n            return attMonsters[0];\r\n        }\r\n        //2.1优先攻击跟目标位置最近的单位\r\n        attMonsters.sort((a:Monster,b:Monster)=>{\r\n            return a.getCenterPos().sub(pos).mag()-b.getCenterPos().sub(pos).mag();\r\n        });\r\n        return attMonsters[0];\r\n    }\r\n\r\n    //---------------------------------------------技能-----------------------------------------------------\r\n\r\n    useSkill(pos:cc.Vec2):number\r\n    {        \r\n        SkillManager.getInstance().releaseSkill(()=>{\r\n            this.startSelfXuLi();\r\n        },this.node);\r\n        return 0;\r\n    }\r\n\r\n    startSelfXuLi(){\r\n        //发射帧监听\r\n        let fasheData=new KeyFrameData();\r\n        fasheData.name=\"FaShe\";\r\n        fasheData.callback=()=>{\r\n                        \r\n        }        \r\n        //英雄动作播放\r\n        this.setHeroState(Hero_State.skill,GongJi_FangXiang.zhong,[fasheData],()=>{\r\n            //隐身\r\n            SkillManager.getInstance().setTimeStop(false);  \r\n            this.node.parent=cc.find('Canvas/Hero_Root');\r\n            this.node.zIndex=2;\r\n            //可以发射\r\n            this.startLaunch();\r\n            \r\n        });\r\n        this.spine.timeScale=JiaSu;\r\n    }\r\n    /**3秒内在战场上的随机位置召唤{参数1}道闪电，闪电会对半径80圆形范围内的敌人造成{参数2}%伤害，并施加一层“超负荷” */\r\n    startLaunch(){\r\n        this.node.opacity=0;\r\n        this.node_shadow.opacity=0;\r\n        super.setAttSpineScale();\r\n        let gjData=super.getGongJiData(DamageType.Skill,false,SkillType.Active,this.hero_data.getSkillValue2(SkillType.Active));\r\n        let num=this.hero_data.getSkillValue1(SkillType.Active);\r\n        let jiange=3/num;\r\n        let ex1=this.hero_data.ExclusiveWeaponSkillValue_1;\r\n        let exFanwei=0;\r\n        if(ex1&&ex1>0){\r\n            //增加范围\r\n            exFanwei=ex1;            \r\n        }\r\n        // if(IsDebug){\r\n        //     exFanwei=200;\r\n        // }\r\n        for(let i=0; i<num; i++){\r\n            this.scheduleOnce(()=>{\r\n                let pos=cc.v2(Math.random()*550-275,Math.random()*800-400);\r\n                GroundManager.getInstance().createGameEffectById(GameEffectId.lei_shen_skill_ground,pos);\r\n                let node=GameEffectsManager.getInstance().createGameEffectById(GameEffectId.lei_shen_skill_sky,pos);\r\n                node.scale=1;\r\n                MyTool.randomSceneShake(-6,6,0.015,6);\r\n                let monsters=MonsterManager.getInstance().getMonstersForCenterPos(-1,pos,180*(1+exFanwei));\r\n                if(monsters){\r\n                    GameManager.getInstance().sound_manager.playSound(SoundIndex.YX_LeiGodSkill2);\r\n                    for(let n=0; n<monsters.length; n++){\r\n                        let monster=monsters[n].getComponent(Monster);\r\n                        let data=monster.beFlashInjured(gjData);\r\n                        if(this.hero_data.getIsUnlock(SkillType.Passive_2)&&data.getDamageNum()>0){                            \r\n                            if(data.is_die==false){\r\n                                let buffData=new BuffData();\r\n                                buffData.buff_id=BuffId.Hero_LeiShen_ChaoFuHe;\r\n                                buffData.remain_time=60;\r\n                                buffData.buff_type=BuffType.Burst;\r\n                                buffData.buff_value=[4];\r\n                                buffData.game_effect_id=GameEffectId.Null;\r\n                                buffData.add_floor=2;\r\n                                let damageRate=this.hero_data.getSkillValue1(SkillType.Passive_2)\r\n                                monster.addDeBuff(buffData,this.getGongJiData(DamageType.Skill,false,SkillType.Passive_2,damageRate));\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },i*jiange);\r\n        }\r\n        this.scheduleOnce(()=>{\r\n            this.node.opacity=255;\r\n            this.node_shadow.opacity=255;\r\n            super.playSpineAnimation('SkillEnd',false,null,()=>{\r\n                this.node.opacity=255;\r\n                super.setHeroState(Hero_State.idle,GongJi_FangXiang.zhong,null,null);\r\n            })\r\n        },3)\r\n        SkillManager.getInstance().setIsSkillState(false);\r\n    }\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\Pet\\Game\\Gully.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { GameState } from \"../../Constants\";\r\nimport { GameEffectId, GameEffectsManager } from \"../../Game/GameEffectsManager\";\r\nimport GameManager from \"../../GameManager\";\r\nimport { GongJiData } from \"../../Hero/Data/HeroData\";\r\nimport GongJi from \"../../Hero/Game/GongJi\";\r\n\r\nimport Monster from \"../../Monster/Monster\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Gully extends GongJi {\r\n\r\n    is_end:boolean=false;\r\n    game_effect_id:number=0;\r\n    move_speed:number=700;\r\n    move_direction:number=Math.PI/2;\r\n    end_height:number=1200;\r\n    destory_countdown:number=2;\r\n    max_time:number=2;\r\n    box_collision:cc.BoxCollider=null;\r\n\r\n    onLoad(){\r\n        this.box_collision=this.node.getComponent(cc.BoxCollider);\r\n    }\r\n\r\n    init(gameEffectId:GameEffectId,dir:number,gjData:GongJiData){\r\n        super.initData(gjData);\r\n        this.game_effect_id=gameEffectId;\r\n        this.move_direction=dir;\r\n        this.node.angle=180*dir/Math.PI-90;\r\n        this.destory_countdown=this.max_time;\r\n        this.node.height=0;\r\n        this.is_end=false;\r\n        this.node.opacity=255;\r\n        let animation=this.node.getComponent(cc.Animation);\r\n        animation.play('e30191');\r\n        this.box_collision.enabled=true;\r\n        animation.on(cc.Animation.EventType.FINISHED,()=>{\r\n            this.box_collision.enabled=false;\r\n            animation.off(cc.Animation.EventType.FINISHED);\r\n            animation.play('e30191_2');            \r\n            this.scheduleOnce(()=>{\r\n                cc.tween(this.node).to(0.4,{opacity:64}).start();\r\n                animation.play('e30191_3');\r\n                animation.on(cc.Animation.EventType.FINISHED,()=>{\r\n                    animation.off(cc.Animation.EventType.FINISHED);\r\n                    this.destroySelf();\r\n                });\r\n            },1);\r\n        });\r\n    }\r\n\r\n    onCollisionEnter(other:cc.Collider,self:cc.Collider) {\r\n        let gm=GameManager.getInstance();        \r\n        if(gm.cur_game_state==GameState.Game_Lose )\r\n            return;\r\n        let group=other.node.group;\r\n        switch(group){\r\n            case 'enemy':{                \r\n                let monsterTs=other.node.getComponent(Monster);\r\n                if(monsterTs.is_can_gully){\r\n                    let data=monsterTs.beFlashInjured(this.gongji_data);\r\n                    if(data.getDamageNum()>0){\r\n                        monsterTs.is_can_gully=false;\r\n                    }\r\n                }\r\n            }break;\r\n        }\r\n    }\r\n\r\n\r\n    destroySelf()\r\n    {\r\n        GameEffectsManager.getInstance().destroyGameEffectById(this.game_effect_id,this.node);\r\n    }\r\n\r\n}\r\n"]}
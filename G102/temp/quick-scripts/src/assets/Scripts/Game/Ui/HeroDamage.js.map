{"version":3,"sources":["assets\\Scripts\\Game\\Ui\\HeroDamage.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport GameManager from \"../../GameManager\";\r\nimport { HeroManager } from \"../../Hero/Data/HeroManager\";\r\nimport { Hero_Type } from \"../../Hero/Game/HeroConfig\";\r\nimport MyTool from \"../../Tools/MyTool\";\r\nimport StatsUi from \"./StatsUi\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class HeroDamage extends cc.Component {\r\n\r\n    // @property(cc.Label)\r\n    // label: cc.Label = null;\r\n\r\n    // @property\r\n    // text: string = 'hello';\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n    @property(cc.Prefab)\r\n    prefab_hero_stats:cc.Prefab=null;\r\n\r\n    @property(cc.Node)\r\n    hero_stats_parent:cc.Node=null;\r\n\r\n    hero:cc.Node[]=[]\r\n    onEnable(){\r\n        // console.log(\"+++++++\")\r\n        this.showStats();//显示英雄\r\n    }\r\n    showStats(){\r\n        //队伍\r\n        let hm=HeroManager.getInstance();\r\n        let teamList=GameManager.getInstance().cur_team_list;\r\n        let attStats=GameManager.getInstance().hero_attack_dps;\r\n        let skillStats=GameManager.getInstance().hero_skill_dps;\r\n        let maxDps=0;\r\n        //先判断哪个是最高的\r\n        for(let i=0; i<Hero_Type.Hero_Num; i++)\r\n        {\r\n            if(attStats[i]+skillStats[i]>maxDps)\r\n            {\r\n                maxDps=attStats[i]+skillStats[i];\r\n            }\r\n        }\r\n        let heroarrnum=[]//已上陣的英雄\r\n        //找出所有的解锁的英雄\r\n        for(let i=0; i<5; i++)\r\n        { \r\n            let heroType=teamList[i];\r\n            if(heroType>0){\r\n                heroarrnum.push(heroType)\r\n            }\r\n        }\r\n        let heightup=0-((this.prefab_hero_stats.data.height/2)+10)\r\n        let Data_Bg_1height=this.prefab_hero_stats.data.height+10+5\r\n        //生成英雄伤害列表\r\n        for (let hero_index = this.hero.length; hero_index < heroarrnum.length; hero_index++) {\r\n                let heroStats=cc.instantiate(this.prefab_hero_stats);\r\n                this.hero_stats_parent.addChild(heroStats);\r\n                heightup= heightup-heroStats.height-5\r\n                Data_Bg_1height+=(heroStats.height+5)\r\n                heroStats.setPosition(0,heightup)\r\n                this.hero.push(heroStats)\r\n        }\r\n        if(this.hero_stats_parent.height<100){\r\n            this.hero_stats_parent.height=(Data_Bg_1height+10)\r\n        }\r\n        let cons=[]//技能和伤害加起来的数据\r\n        let shanghaizonhe=0//伤害总和\r\n        for (let cons_index = 0; cons_index < this.hero.length; cons_index++) {\r\n            let aNum=attStats[heroarrnum[cons_index]];//普通攻击\r\n            let sNum=skillStats[heroarrnum[cons_index]];//技能\r\n            cons[cons_index]=aNum+sNum\r\n            shanghaizonhe+=cons[cons_index]\r\n        }\r\n        //从大到小排列伤害数据\r\n        let cun\r\n        let herocun\r\n        for (let index = 0; index < cons.length; index++) {\r\n            for (let paixvindex = 0; paixvindex < cons.length-1; paixvindex++) {\r\n                if(cons[paixvindex+1]>cons[paixvindex]){\r\n                    cun=cons[paixvindex]\r\n                    cons[paixvindex]=cons[paixvindex+1]\r\n                    cons[paixvindex+1]=cun\r\n\r\n                    herocun=heroarrnum[paixvindex]\r\n                    heroarrnum[paixvindex]=heroarrnum[paixvindex+1]\r\n                    heroarrnum[paixvindex+1]=herocun\r\n                }\r\n            }\r\n        }\r\n        //刷新英雄的伤害\r\n        for (let shuaxing_index = 0; shuaxing_index < this.hero.length; shuaxing_index++) {\r\n            let myhero=this.hero[shuaxing_index]\r\n            if(shuaxing_index < heroarrnum.length){\r\n                myhero.active=true\r\n                let icon=myhero.getChildByName('icon');\r\n                icon.getComponent(cc.Sprite).spriteFrame=hm.getHeroSpriteFrames(heroarrnum[shuaxing_index]);\r\n                let aNum=attStats[heroarrnum[shuaxing_index]];//普通攻击\r\n                let sNum=skillStats[heroarrnum[shuaxing_index]];//技能\r\n                let con=aNum+sNum\r\n                let skillNum=0\r\n                if(shanghaizonhe>0){\r\n                    skillNum=Number(((con/shanghaizonhe)*100).toFixed(0))\r\n                }\r\n                myhero.getChildByName(\"skillNum\").getComponent(cc.Label).string=\"\"+Number(MyTool.numberFormat(skillNum,0))+\"%\"\r\n                myhero.getChildByName(\"attNum\").getComponent(cc.Label).string=\"\"+Number(MyTool.numberFormat(con,0))\r\n                let att=skillNum/100\r\n                myhero.getChildByName(\"att\").getComponent(cc.ProgressBar).progress=att\r\n                myhero.getChildByName(\"skill\").getComponent(cc.ProgressBar).progress=att\r\n            }else{\r\n                myhero.active=false\r\n            }\r\n        }\r\n    }\r\n    // update (dt) {}\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\Payment\\PayGitBag.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameManager from \"../GameManager\";\r\nimport { CyclePackManager, JsonCyclePack } from \"./Data/CyclePack\";\r\nimport { SoundIndex } from \"../Sound/AudioConstants\";\r\nimport PayGitBagItem from \"./PayGitBagItem\";\r\nimport { PayManager } from \"./PayManager\";\r\nimport { EventManager, RedEventString, RedEventType } from \"../Tools/EventManager\";\r\nimport { PayUiIndex } from \"../thirdParty/ThirdParty\";\r\nimport FollowManager from \"../multiLanguage/FollowManager\";\r\nimport { Follow_Type } from \"../multiLanguage/FollowConstants\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nenum GitState {\r\n    Day = 1,\r\n    Week,\r\n    Month\r\n}\r\n\r\n@ccclass\r\nexport default class PayGitBag extends cc.Component {\r\n\r\n    private git_state = GitState.Day;\r\n\r\n    @property(cc.Prefab)\r\n    git_bag_item:cc.Prefab = null;\r\n    @property(cc.SpriteAtlas)\r\n    pay_git_bag_ui:cc.SpriteAtlas = null;\r\n\r\n    protected onEnable(): void {\r\n        this.adaptation();\r\n        this.refreshUI();\r\n    }\r\n\r\n    private adaptation()\r\n    {        \r\n        let bottomNode=this.node.parent.getChildByName('bottom');\r\n        let bottomHeight=bottomNode.height;\r\n        let bottomY=bottomNode.y;        \r\n        let topNode=this.node.parent.getChildByName('top')\r\n        let topHeight=topNode.height;\r\n        let topY=topNode.y;\r\n        let height=((topY-topHeight)-(bottomY+bottomHeight));\r\n        let centerY=(topY-topHeight-height/2);\r\n        let scrollView=this.node.getChildByName('itemScroll');\r\n        scrollView.height=height;\r\n        scrollView.y=centerY - 120;\r\n        scrollView.getChildByName('view').height=height;\r\n        this.node.getChildByName(\"top\").y = topNode.y - (topNode.height/2 + this.node.getChildByName(\"top\").height);\r\n    }\r\n\r\n    protected start(): void {\r\n        PayManager.getInstance().addTodayShow(PayUiIndex.Gift);\r\n        EventManager.postRedEvent(RedEventString.RED_CHECK,RedEventType.Btn_Main_Shop_Gift);\r\n    }\r\n\r\n    refreshUI() {\r\n        for (let i = 1; i <= 3; i++) {\r\n            let btn = this.node.getChildByName(\"top\").getChildByName(\"btn\" + i);\r\n            if(i == this.git_state){\r\n                btn.getComponents(cc.Button).forEach((v,k) =>{\r\n                    v.interactable = false;\r\n                })\r\n            }\r\n            else{\r\n                btn.getComponents(cc.Button).forEach((v,k) => {\r\n                    v.interactable = true;\r\n                })\r\n            }\r\n        }\r\n\r\n        let content = this.node.getChildByName(\"itemScroll\").getComponent(cc.ScrollView).content;\r\n        content.removeAllChildren();\r\n        let dataList:JsonCyclePack[] = [];\r\n        dataList = CyclePackManager.getInstance().getDataByType(this.git_state);\r\n        dataList.forEach((v,k) => {\r\n            let item = cc.instantiate(this.git_bag_item);\r\n            item.getComponent(PayGitBagItem).initData(v);\r\n            if(v.GiftText == 1){\r\n                item.getChildByName(\"Cycle_Bg_Day\").getComponent(cc.Sprite).spriteFrame = this.pay_git_bag_ui.getSpriteFrame(\"Cycle_Bg_Day\");\r\n            }else if(v.GiftText == 2){\r\n                item.getChildByName(\"Cycle_Bg_Day\").getComponent(cc.Sprite).spriteFrame = this.pay_git_bag_ui.getSpriteFrame(\"Cycle_Bg_Week\");\r\n            }else{\r\n                item.getChildByName(\"Cycle_Bg_Day\").getComponent(cc.Sprite).spriteFrame = this.pay_git_bag_ui.getSpriteFrame(\"Cycle_Bg_Month\");\r\n            }\r\n            content.addChild(item);\r\n        });\r\n    }\r\n\r\n    onBtnClick(e,index:number){\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n        index=Number(index);\r\n        if(index == 1){\r\n            FollowManager.getInstance().followEvent(Follow_Type.每日礼包页签展示次数);\r\n        }else if(index == 2){\r\n            FollowManager.getInstance().followEvent(Follow_Type.每周礼包页签展示次数);\r\n        }else{\r\n            FollowManager.getInstance().followEvent(Follow_Type.每月礼包页签展示次数);\r\n        }\r\n        if(this.git_state!=index){\r\n            this.git_state=index;\r\n            this.refreshUI();\r\n        }\r\n    }\r\n\r\n    \r\n\r\n}\r\n"]}
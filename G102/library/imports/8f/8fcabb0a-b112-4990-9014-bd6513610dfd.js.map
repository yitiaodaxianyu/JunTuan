{"version":3,"sources":["assets\\Scripts\\Hero\\Game\\PaoShou\\PaoShou.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport { GameState, JiaSu } from \"../../../Constants\";\r\nimport FightingManager from \"../../../Game/FightingManager\";\r\nimport { GameEffectId } from \"../../../Game/GameEffectsManager\";\r\nimport SkillManager from \"../../../Game/SkillManager\";\r\nimport SkyManager from \"../../../Game/SkyManager\";\r\nimport GameManager from \"../../../GameManager\";\r\nimport { LevelManager } from \"../../../Level/LevelManager\";\r\nimport { KeyFrameData } from \"../../../Monster/MonsterData\";\r\nimport { SoundIndex } from \"../../../Sound/AudioConstants\";\r\nimport TutorailsManager from \"../../../Tutorials/TutorailsManager\";\r\nimport { GongJiData } from \"../../Data/HeroData\";\r\nimport Hero from \"../Hero\";\r\nimport { DamageType, GongJi_FangXiang, Hero_State, ShieldId, ShieldType, SkillType } from \"../HeroConfig\";\r\nimport PaoDan from \"./PaoDan\";\r\nimport PaoDanNormal from \"./PaoDanNormal\";\r\nimport TouDan from \"./TouDan\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class PaoShou extends Hero {\r\n    \r\n    /**没有触发被动炮弹的次数 */\r\n    no_paopao_num:number=0;\r\n\r\n    onLoad()\r\n    {\r\n        super.onLoad();\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_paodan_att,8);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_paodan_skill,8);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_paodan_skill_ex,2);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_paodan_hit,8);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_skill_hit,8);\r\n        super.addLoadByGameEffectId(GameEffectId.xuanyun,4);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_skill_2,1);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_active_skill_1,1);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_active_skill_2,6);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_active_skill_toudan,6);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_dazhao_xinhaodan,6);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_dazhao_weiyan,6);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_dazhao_weiyan_end,1);\r\n        super.addLoadByGameEffectId(GameEffectId.paoshou_dazhao_xinhaodan_miaozhun,1);\r\n        this.is_LoadLoad=true;\r\n        this.addSkillListen(this.useSkill);\r\n        this.addAttackListen(this.normalAttack);\r\n        this.addXuanYunListen(this.onXuanYunResult);        \r\n    }\r\n    \r\n    start()\r\n    {\r\n        super.start();\r\n        // if(this.hero_data.getSkillValue1(SkillType.Passive_2)){\r\n        //     this.schedule(this.checkSkill2,this.hero_data.getSkillColdDown(SkillType.Passive_2));\r\n        // }\r\n        this.is_need_check_distance=true;\r\n        super.setSkillTipSize(400,400);\r\n        if(LevelManager.getInstance().start_level==2&&TutorailsManager.getInstance().isShowTutorials(206)){\r\n            this.hideHero();\r\n        }\r\n    }\r\n\r\n    onXuanYunResult(isXuanYun:boolean){\r\n        if(isXuanYun){\r\n            this.unscheduleAllCallbacks();\r\n            // if(this.hero_data.getSkillValue1(SkillType.Passive_2)){\r\n            //     this.schedule(this.checkSkill2,this.hero_data.getSkillColdDown(SkillType.Passive_2));\r\n            // }\r\n        }else{\r\n            //根据上个状态判断需要做什么\r\n            this.setHeroState(Hero_State.idle,GongJi_FangXiang.zhong);\r\n        }\r\n    }\r\n    //---------------------------------------------攻击----------------------------------------------\r\n    createPaoDan(id:GameEffectId,pos:cc.Vec2,targetPos:cc.Vec2,speed:number,size:number,gjData:GongJiData){\r\n        let node=FightingManager.getInstance().createGameEffectById(id,pos);\r\n        node.getComponent(PaoDan).init(id,speed,targetPos,gjData,size);\r\n    }\r\n\r\n    createNormalPaoDan(id:GameEffectId,pos:cc.Vec2,dir:number,speed:number,gjData:GongJiData){\r\n        let node=FightingManager.getInstance().createGameEffectById(id,pos);\r\n        node.getComponent(PaoDanNormal).init(id,speed,dir,gjData);\r\n    }\r\n\r\n    normalAttack(monster:cc.Node)\r\n    {\r\n        if(GameManager.getInstance().cur_game_state!=GameState.Game_Playing)\r\n            return;\r\n        this.is_can_gongji=false;\r\n        this.startAttack(monster.getPosition());      \r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.YX_PaoshouAttack);\r\n    }\r\n    /**每次攻击会对半径{参数1}范围内造成{参数2}%伤害 */\r\n    startAttack(enemyPos:cc.Vec2)\r\n    {\r\n        let fangxiang=super.getFangXiangByPos(enemyPos);\r\n        let data=new KeyFrameData();\r\n        data.name=\"Attack\";\r\n        data.callback=()=>{\r\n            //正中心\r\n            let gjData=super.getGongJiData(DamageType.Skill,false,SkillType.Passive_1,this.hero_data.getSkillValue2(SkillType.Passive_1));\r\n            let bullectPos=super.getCreateBulletPos();  \r\n            let paoDanId=GameEffectId.paoshou_paodan_skill;\r\n            let size=this.hero_data.getSkillValue1(SkillType.Passive_1);\r\n            this.createPaoDan(paoDanId,bullectPos,enemyPos,this.bullet_speed,size,gjData);\r\n            if(this.is_double_attack){\r\n                this.resetNormalAttack();\r\n            }else{\r\n                this.gongji_jishu=0;\r\n            }\r\n        }\r\n        super.setHeroState(Hero_State.attack,fangxiang,[data],()=>{            \r\n            super.setHeroState(Hero_State.idle,fangxiang);\r\n        });\r\n    }\r\n\r\n    // checkSkill1(enemyPos:cc.Vec2):boolean{\r\n    //     //概率\r\n    //     let rate=this.hero_data.getSkillValue1(SkillType.Passive_1);\r\n    //     let paoDanId=GameEffectId.paoshou_paodan_skill;\r\n    //     if(this.hero_data.ExclusiveWeaponSkillValue_1>0 && this.no_paopao_num>=this.hero_data.ExclusiveWeaponSkillValue_1)\r\n    //     {\r\n    //         rate=1;\r\n    //         paoDanId=GameEffectId.paoshou_paodan_skill_ex;\r\n    //     }\r\n        \r\n    //     if(rate&&Math.random()<rate){\r\n    //         this.is_can_jishu=false;\r\n    //         let data=new KeyFrameData();\r\n    //         data.name=\"Attack\";\r\n    //         data.callback=()=>{\r\n    //             let bullectPos=super.getCreateBulletPos();    \r\n    //             let gjData=super.getGongJiData(DamageType.Skill,false,SkillType.Passive_1,this.hero_data.getSkillValue3(SkillType.Passive_1));\r\n    //             //码数*2\r\n    //             let size=this.hero_data.getSkillValue2(SkillType.Passive_1);\r\n    //             this.createPaoDan(paoDanId,bullectPos,enemyPos,this.bullet_speed,size,gjData);\r\n    //             GameManager.getInstance().sound_manager.playSound(SoundIndex.cannon);\r\n    //         }\r\n    //         super.setHeroStateAndAnimation(Hero_State.skill,'KaiShi_Attack',false,[data],()=>{\r\n    //             this.is_can_jishu=true;\r\n    //             super.setHeroState(Hero_State.idle,this.cur_fangxiang);\r\n    //         })\r\n    //         this.no_paopao_num=0;\r\n    //         return true;\r\n    //     }else{\r\n    //         this.no_paopao_num++;\r\n    //         return false;;\r\n    //     }\r\n    // }\r\n    // /**BUG：可能被眩晕后无法再次释放了,使用update计数 */\r\n    // checkSkill2(){\r\n    //     if(GameManager.getInstance().cur_game_state!=GameState.Game_Playing){\r\n    //         return;\r\n    //     }\r\n    //     let node=this.node.getChildByName('progressBar');\r\n    //     node.active=true;\r\n    //     let progressBar=node.getComponent(cc.ProgressBar);\r\n    //     progressBar.progress=0;\r\n    //     this.is_can_jishu=false;\r\n    //     super.setHeroStateAndAnimation(Hero_State.skill,'Buff',false,null,()=>{\r\n    //         this.is_can_jishu=true;\r\n    //         super.setHeroState(Hero_State.idle,this.cur_fangxiang);\r\n    //     })\r\n    //     cc.tween(progressBar).to(0.5,{progress:1}).call(()=>{\r\n            \r\n    //         //加血10秒\r\n    //         // let buffData=new BuffData();\r\n    //         // buffData.buff_id=BuffId.Hero_PaoShou_Skill_2_Add_Hp;\r\n    //         // buffData.buff_type=BuffType.Normal;\r\n    //         // buffData.buff_value=[this.hero_data.getSkillValue2(SkillType.Passive_2)+this.hero_data.getSkillValue3(SkillType.Passive_2)*GameManager.getInstance().wall_data.getMaxHp()];\r\n    //         // buffData.recovery_jiange_time=1;\r\n    //         // buffData.remain_time=10;\r\n    //         // super.addBuff(buffData)\r\n    //         // node.active=false;\r\n    //         // //加伤害5秒\r\n    //         // let buffData1=new BuffData();\r\n    //         // buffData1.buff_id=BuffId.Hero_PaoShou_Skill_2_Add_Damage;\r\n    //         // buffData1.buff_type=BuffType.Normal;\r\n    //         // buffData1.game_effect_id=GameEffectId.paoshou_skill_2;\r\n    //         // buffData1.buff_value=[this.hero_data.getSkillValue1(SkillType.Passive_2)];\r\n    //         // buffData1.remain_time=5;\r\n    //         // super.addBuff(buffData1)\r\n    //     }).start();\r\n    // }\r\n\r\n    useSkill(pos:cc.Vec2):number\r\n    {\r\n        SkillManager.getInstance().releaseSkill(()=>{\r\n            this.startSelfXuLi(pos);\r\n        },this.node);\r\n        return 1;\r\n    }\r\n\r\n    startSelfXuLi(pos:cc.Vec2){\r\n        //蓄力帧监听\r\n        let heroRoot=cc.find('Canvas/Hero_Root');        \r\n        //发射帧监听\r\n        let fasheData=new KeyFrameData();\r\n        fasheData.name=\"FaShe\";\r\n        fasheData.callback=()=>{\r\n            //可以发射\r\n            SkillManager.getInstance().setTimeStop(false);\r\n            this.node.parent=heroRoot;\r\n            this.node.zIndex=2;            \r\n            this.startLaunch(pos);\r\n        }\r\n        //英雄动作播放\r\n        this.setHeroState(Hero_State.skill,GongJi_FangXiang.zhong,[fasheData],()=>{\r\n            //动作完毕后状态还是技能状态，动画要播放待机的\r\n            this.resetGongJiJiShu();\r\n            this.setHeroState(Hero_State.idle,GongJi_FangXiang.zhong);\r\n        });\r\n        this.spine.timeScale=JiaSu;\r\n    }\r\n    /**发射数枚炮弹，对半径200的目标区域进行{参数1}次轰炸，每次造成{参数2}%伤害 */\r\n    startLaunch(pos:cc.Vec2){\r\n        super.setAttSpineScale();\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.YX_PaoShouSkill1);\r\n        let num=this.hero_data.getSkillValue1(SkillType.Active)\r\n        let gjData=super.getGongJiData(DamageType.Skill,false,SkillType.Active,this.hero_data.getSkillValue2(SkillType.Active));\r\n        let pi2=Math.PI*2;\r\n        for(let i=0; i<num; i++){\r\n            this.scheduleOnce(()=>{\r\n                //半径随机\r\n                let r=Math.random()*200;\r\n                //弧度随机\r\n                let hudu=Math.random()*pi2;\r\n                //求点\r\n                let posX=pos.x+Math.cos(hudu)*r;\r\n                let posY=pos.y+Math.sin(hudu)*r;\r\n                let toudan=SkyManager.getInstance().createGameEffectById(GameEffectId.paoshou_active_skill_toudan,cc.v2(posX,posY+1600));\r\n                toudan.getComponent(TouDan).init(GameEffectId.paoshou_active_skill_toudan,cc.v2(posX,posY),gjData);\r\n            },0.15*i);\r\n        }\r\n        SkillManager.getInstance().setIsSkillState(false);\r\n        // let xinhaodan=GameEffectsManager.getInstance().createGameEffectForParent(GameEffectId.paoshou_dazhao_xinhaodan,this.getCreateBulletPos(),SkillManager.getInstance().node);\r\n        // let cenPos=GameManager.getInstance().getFightCenter();\r\n        // let oldParent=this.node.parent;\r\n        // this.node.parent=SkillManager.getInstance().node;\r\n        // SkillManager.getInstance().setTimeStop(true);\r\n        // SkillManager.getInstance().startBaiPing();\r\n        // MyTool.randomSceneShake(-5,5,0.02,6);\r\n        // let monsters=MonsterManager.getInstance().getMonstersForMaxAttak(1,this.node.getPosition(),this.hero_data.gongji_fanwei);        \r\n        // if(monsters){\r\n        //     cenPos=monsters[0].getPosition().add(cc.v2(0,-25));\r\n        //     if(cenPos.y<GameManager.getInstance().enemy_att_y){\r\n        //         cenPos=monsters[0].getPosition();\r\n        //     }\r\n        // }\r\n        // this.spine.timeScale=JiaSu;\r\n        // xinhaodan.getComponent(SignalFlare).init(GameEffectId.paoshou_dazhao_xinhaodan,600,cenPos,()=>{            \r\n        //     this.node.parent=oldParent;\r\n        //     this.node.zIndex=2;\r\n        //     this.spine.timeScale=1;\r\n        //     SkillManager.getInstance().setTimeStop(false);\r\n        //     this.resetGongJiJiShu();\r\n        //     super.setHeroState(Hero_State.idle,this.cur_fangxiang);\r\n        //     let startY=-(cc.winSize.height/2+200)\r\n        //     let endY=cc.winSize.height+400;\r\n        //     let speed=(endY-startY)/3;\r\n        //     let node=SkyManager.getInstance().createGameEffectById(GameEffectId.paoshou_active_skill_1,cc.v2(0,startY));\r\n        //     let gjData=super.getGongJiData(DamageType.Skill,false,this.hero_data.getSkillValue2(SkillType.Active));\r\n        //     cc.tween(node).by(3,{y:endY}).call(()=>{\r\n        //         GameEffectsManager.getInstance().destroyGameEffectById(GameEffectId.paoshou_active_skill_1,node);\r\n        //     }).start();\r\n        //     let paoNum=0;\r\n        //     let radius=50;\r\n        //     let toudanCall=()=>{\r\n                \r\n        //         let radian=(paoNum*Math.PI/3)\r\n        //         let posX=cenPos.x+Math.cos(radian)*radius;\r\n        //         let posY=cenPos.y+Math.sin(radian)*radius;\r\n        //         let toudan=SkyManager.getInstance().createGameEffectById(GameEffectId.paoshou_active_skill_toudan,cc.v2(posX,posY+1600));\r\n        //         // let toudan=SkyManager.getInstance().createGameEffectById(GameEffectId.paoshou_active_skill_toudan,cc.v2(posX,(cc.winSize.height/2+200+speed*paoNum)));\r\n        //         // let xx=108*(paoNum%2==0?-1:1);\r\n        //         // let yy=node.y+100;\r\n        //         toudan.getComponent(TouDan).init(GameEffectId.paoshou_active_skill_toudan,cc.v2(posX,posY),gjData);\r\n        //         paoNum++;\r\n        //     };\r\n        //     this.schedule(toudanCall,0.25,5,1);\r\n        //     SkillManager.getInstance().setIsSkillState(false);\r\n        // });                    \r\n        // GameManager.getInstance().wall_data.addShieldValue(ShieldId.PaoShou_ActiveSkill,ShieldType.All,5,this.hero_data.total_attack*this.hero_data.getSkillValue1(SkillType.Active));\r\n    }\r\n    \r\n}\r\n"]}
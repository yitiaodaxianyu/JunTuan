{"version":3,"sources":["assets\\Scripts\\Monster\\Elite\\Elite76.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { GameState } from \"../../Constants\";\r\nimport { GameEffectId, GameEffectsManager } from \"../../Game/GameEffectsManager\";\r\nimport GroundManager from \"../../Game/GroundManager\";\r\nimport GameManager from \"../../GameManager\";\r\nimport { HaloData, HaloId } from \"../../Hero/Game/HeroConfig\";\r\nimport Monster from \"../Monster\";\r\nimport MonsterManager from \"../MonsterManager\";\r\nimport MonsterNewNormal from \"../MonsterNewNormal\";\r\n\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Elite76 extends MonsterNewNormal {\r\n\r\n    light:cc.Node=null;\r\n    halo_data:HaloData=null;\r\n    is_loaded:boolean=false;\r\n    halo_radius:number=200;\r\n\r\n    protected onLoad(): void {\r\n        super.onLoad();\r\n        super.addMonsterNormalInited(this.onMonsterNormalInited);\r\n        super.addMonsterNormalDeath(this.onMonsterNormalDeath);\r\n        GameEffectsManager.getInstance().addEffectPoolById(GameEffectId.monster76_attack_guanghuan,1,()=>{\r\n            //添加光环特效\r\n            if(!this.light){\r\n                this.light=GroundManager.getInstance().createGameEffectById(GameEffectId.monster76_attack_guanghuan,this.node.getPosition());\r\n            }\r\n            this.is_loaded=true;\r\n        });\r\n    }\r\n\r\n    onMonsterNormalInited () {\r\n        this.halo_radius=this.skill_data.getSkillValue1(1);\r\n        this.halo_data=new HaloData();\r\n        this.halo_data.halo_id=HaloId.Monster76_JianDuZhe_Skill_Halo;\r\n        this.halo_data.halo_value=[this.skill_data.getSkillValue2(1)];\r\n        this.halo_data.halo_source_uuid=this.uuid;\r\n        if(this.is_loaded){\r\n            if(!this.light){\r\n                this.light=GroundManager.getInstance().createGameEffectById(GameEffectId.monster76_attack_guanghuan,this.node.getPosition());\r\n            }\r\n        }\r\n    }\r\n\r\n    onMonsterNormalDeath(){\r\n        //以及删除所有光环数据\r\n        if(this.light){\r\n            GameEffectsManager.getInstance().destroyGameEffectById(GameEffectId.monster76_attack_guanghuan,this.light);\r\n            this.light=null;\r\n        }        \r\n        let allMonster=MonsterManager.getInstance().node.children;\r\n        let len=allMonster.length;\r\n        if(len<=0)\r\n        {\r\n            return null;\r\n        }            \r\n        for(let i=0;i<len; i++)\r\n        {\r\n            let monster=allMonster[i];\r\n            let monsterTS=monster.getComponent(Monster);\r\n            if(monsterTS && monsterTS.getIsCanCheck())\r\n            {\r\n                //移除光环效果\r\n                monsterTS.subHalo(HaloId.Monster76_JianDuZhe_Skill_Halo,this.uuid);\r\n            }\r\n        }\r\n    }    \r\n\r\n    update (dt) {\r\n        if((GameManager.getInstance().cur_game_state!=GameState.Game_Playing)||this.getIsDie())\r\n        {\r\n            return;\r\n        }\r\n        super.update(dt);\r\n        this.checkSkill();\r\n        if(this.light){\r\n            this.light.setPosition(this.node.getPosition());\r\n        }\r\n    }\r\n\r\n    checkSkill(){\r\n        let allMonster=MonsterManager.getInstance().node.children;\r\n        let len=allMonster.length;\r\n        if(len<=0)\r\n        {\r\n            return null;\r\n        }            \r\n        for(let i=0;i<len; i++)\r\n        {\r\n            let monster=allMonster[i];\r\n            let monsterTS=monster.getComponent(Monster);\r\n            if(monsterTS && monsterTS.getIsCanCheck())\r\n            {\r\n                let distance=this.getCenterPos().sub(monsterTS.getCenterPos()).mag();\r\n                if(distance<=200)\r\n                {\r\n                    //添加光环效果                    \r\n                    monsterTS.addHalo(this.halo_data);\r\n                }else{\r\n                    //移除光环效果\r\n                    monsterTS.subHalo(HaloId.Monster76_JianDuZhe_Skill_Halo,this.uuid);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}
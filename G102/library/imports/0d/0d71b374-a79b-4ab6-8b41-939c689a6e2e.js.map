{"version":3,"sources":["assets\\Scripts\\Hero\\Game\\PaoShou\\PaoDan.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport { PaoDan_Type } from \"../HeroConfig\";\r\nimport GongJi from \"../GongJi\";\r\nimport PaoDanBaoZha from \"./PaoDanBaoZha\";\r\nimport { GameEffectId, GameEffectsManager } from \"../../../Game/GameEffectsManager\";\r\nimport GameManager from \"../../../GameManager\";\r\nimport { SoundIndex } from \"../../../Sound/AudioConstants\";\r\nimport { GongJiData } from \"../../Data/HeroData\";\r\nimport MyTool from \"../../../Tools/MyTool\";\r\nimport MonsterManager from \"../../../Monster/MonsterManager\";\r\nimport Monster from \"../../../Monster/Monster\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class PaoDan extends GongJi {\r\n\r\n    @property({type:cc.Enum(PaoDan_Type)})\r\n    paodan_type:PaoDan_Type=PaoDan_Type.skill;\r\n\r\n    game_effect_id:GameEffectId=GameEffectId.Null;\r\n    move_speed:number=700;\r\n    move_direction:number=Math.PI/2;\r\n\r\n    bomb_size:number=100;\r\n    //目标地点，到达后爆炸\r\n    target_pos:cc.Vec2=null;\r\n\r\n    init(id:GameEffectId,speed:number,targetPos:cc.Vec2,gjData:GongJiData,size:number)\r\n    {\r\n        super.initData(gjData);\r\n        this.game_effect_id=id;\r\n        this.move_speed=speed;\r\n        this.target_pos=targetPos;        \r\n\r\n        let offsetPos=targetPos.sub(this.node.getPosition());\r\n        this.move_direction=Math.atan2(offsetPos.y,offsetPos.x);\r\n        //距离\r\n        let distance=offsetPos.mag();\r\n        let sp=this.move_speed/GameManager.getInstance().getGameRate();\r\n        let jtTime=distance/sp/GameManager.getInstance().getGameRate();;\r\n        this.node.scale=0.5;\r\n        cc.tween(this.node).then(cc.spawn(cc.sequence(cc.scaleTo(jtTime/4,1.1),cc.scaleTo(jtTime*3/4,0.8)),cc.jumpTo(jtTime,targetPos,distance/2.5,1))).call(this.destroySelf,this).start();\r\n        this.bomb_size=size;\r\n        // let node=GroundManager.getInstance().createGameEffectById(GameEffectId.paoshou_paodan_luodi,this.target_pos);\r\n        // node.setContentSize(size);\r\n        // cc.tween(node).delay(jtTime*GameManager.getInstance().getGameRate()).call(()=>{\r\n        //     GameEffectsManager.getInstance().destroyGameEffectById(GameEffectId.paoshou_paodan_luodi,node);\r\n        // }).start();\r\n    }\r\n\r\n    destroySelf()\r\n    {\r\n        //销毁后爆炸\r\n        this.createBomb();\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.YX_boom2);\r\n        GameEffectsManager.getInstance().destroyGameEffectById(this.game_effect_id,this.node);\r\n    }\r\n    /**每次攻击会对半径{参数1}范围内造成{参数2}%伤害 */\r\n    createBomb(){\r\n        let baozha=GameEffectsManager.getInstance().createGameEffectById(GameEffectId.paoshou_skill_hit,this.target_pos);\r\n        //baozha.angle=MyTool.radianToAngle(this.move_direction)-90;\r\n        //MyTool.randomSceneShake(-5,5,0.02,6);\r\n        let monsters=MonsterManager.getInstance().getMonstersForCenterPos(-1,this.node.getPosition(),this.bomb_size);\r\n        if(monsters){            \r\n            for(let i=0; i<monsters.length; i++){\r\n                let monsterTs=monsters[i].getComponent(Monster);\r\n                monsterTs.beFlashInjured(this.gongji_data);\r\n                \r\n            }\r\n        }\r\n        //baozha.getComponent(PaoDanBaoZha).init(GameEffectId.paoshou_paodan_hit,this.paodan_type,this.gongji_data);\r\n\r\n        baozha.scale=this.bomb_size/100;\r\n        //baozha.scale=1;\r\n    }\r\n}\r\n"]}
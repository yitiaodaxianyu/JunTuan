{"version":3,"sources":["assets\\Scripts\\GuaJi\\MapManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { LevelManager } from \"../Level/LevelManager\";\r\nimport { MissionLevelManager } from \"../Level/MissionLevel\";\r\nimport Loading from \"../Loading/Loading\";\r\nimport levelnode from \"./levelnode\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class MapManager extends cc.Component {\r\n    private static _instance: MapManager = null;\r\n    /**进入哪个关卡 */\r\n    public static Currentlevel=0    //    0：关闭游戏重新开始游戏\r\n    @property(cc.Prefab)\r\n    levelnode: cc.Prefab = null;//关卡节点\r\n    @property(cc.Node)\r\n    levelpanten: cc.Node = null;//关卡的父节点\r\n\r\n    levelarr:cc.Node[]=[]//已生成的关卡节点\r\n\r\n\r\n    @property(cc.SpriteFrame)\r\n    bjarr:cc.SpriteFrame[]=[];//章节地图\r\n    \r\n    @property(cc.SpriteFrame)\r\n    bjarr1:cc.SpriteFrame[]=[];//章节地图\r\n    \r\n    @property(cc.SpriteFrame)\r\n    bjarr2:cc.SpriteFrame[]=[];//章节地图\r\n    @property(cc.Node)\r\n    Main_Bg: cc.Node = null;//地图背景\r\n    \r\n    @property(cc.Node)\r\n    Main_Bg_Level_2: cc.Node = null;//背景地图下面\r\n\r\n    @property(cc.Node)\r\n    Main_Bg_Level_1: cc.Node = null;//背景地图上面\r\n    // @property(cc.SpriteAtlas)\r\n    // bjarr:cc.SpriteAtlas=null;//章节地图\r\n    // @property\r\n    // text: string = 'hello';\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n\r\n\r\n    @property(cc.Node)\r\n    ChallengeRoundPop: cc.Node = null;//关卡挑战弹窗\r\n\r\n    @property(cc.Node)\r\n    WarChariot: cc.Node = null;//战车\r\n\r\n\r\n\r\n    \r\n    @property(cc.Node)\r\n    shan: cc.Node[] = [];//背景山\r\n        \r\n    @property(cc.Node)\r\n    shu: cc.Node[] = [];//树\r\n\r\n    @property(cc.Node)\r\n    caodi: cc.Node[] = [];//草地\r\n\r\n    @property(cc.Node)\r\n    cao: cc.Node[] = [];//草\r\n\r\n    public static ChallengeRoundPops: cc.Node = null;//关卡挑战弹窗\r\n    start () {\r\n        MapManager.ChallengeRoundPops=this.ChallengeRoundPop\r\n        // console.log(\"_____\",MapManager.ChallengeRoundPops)\r\n        this.instantiatelevelnode()\r\n    }\r\n    public static getInstance():MapManager\r\n    {\r\n        return this._instance;\r\n    }\r\n    protected onLoad(): void {\r\n        // if(MapManager._instance==null){\r\n            MapManager._instance=this;\r\n            //拉取主页图片\r\n        // }\r\n    }\r\n\r\n    instantiatelevelnode(){\r\n        let startLevel=LevelManager.getInstance().finish_level+1;//当前最大关卡\r\n        let myCurrentlevel=startLevel\r\n        if(startLevel>=MissionLevelManager.getMaxLevel()){\r\n            myCurrentlevel=MissionLevelManager.getMaxLevel()\r\n        }        \r\n        if(MapManager.Currentlevel==0){\r\n\r\n        }else{\r\n            myCurrentlevel=MapManager.Currentlevel;//当前最大关卡\r\n        }\r\n        let Chapter=MissionLevelManager.getInstance().getChapter(myCurrentlevel)//当前关卡的章节\r\n\r\n        // console.log(\"章节：\",Chapter,this.Main_Bg)\r\n        // console.log(\"++++++\",myCurrentlevel,Chapter)\r\n        this.Main_Bg.getComponent(cc.Sprite).spriteFrame=this.bjarr[Chapter-1]\r\n        this.Main_Bg_Level_2.getComponent(cc.Sprite).spriteFrame=this.bjarr2[Chapter-1]\r\n        this.Main_Bg_Level_1.getComponent(cc.Sprite).spriteFrame=this.bjarr1[Chapter-1]\r\n        this.WarChariot.getComponent(sp.Skeleton).setSkin(\"WarChariot_\"+Chapter)\r\n\r\n        // console.log(\"++++++++++\",LevelManager.getInstance().maininterfacemap)\r\n\r\n\r\n        for (let shanindex = 0; shanindex < this.shan.length; shanindex++) {\r\n            this.shan[shanindex].getComponent(cc.Sprite).spriteFrame=LevelManager.getInstance().maininterfacemap.get(\"Home_Chapter\"+Chapter+\"_0\");\r\n        }\r\n        for (let caodindex = 0; caodindex < this.caodi.length; caodindex++) {\r\n            this.caodi[caodindex].getComponent(cc.Sprite).spriteFrame=LevelManager.getInstance().maininterfacemap.get(\"Home_Chapter\"+Chapter+\"_1\");\r\n        }\r\n        for (let shuindex = 0; shuindex < this.shu.length; shuindex++) {\r\n            this.shu[shuindex].getComponent(cc.Sprite).spriteFrame=LevelManager.getInstance().maininterfacemap.get(\"Home_Chapter\"+Chapter+\"_2\");\r\n        }\r\n        for (let caoindex = 0; caoindex < this.cao.length; caoindex++) {\r\n            this.cao[caoindex].getComponent(cc.Sprite).spriteFrame=LevelManager.getInstance().maininterfacemap.get(\"Home_Chapter\"+Chapter+\"_3\");\r\n        }\r\n        \r\n        \r\n        // console.log(\"坐标：\",this.Main_Bg.parent.parent.parent.parent.getPosition())\r\n        for (let index = this.levelarr.length; index <= MissionLevelManager.getInstance().getJsonLevelchapterLength(Chapter); index++) {\r\n            let mylevelnode=cc.instantiate(this.levelnode)\r\n            mylevelnode.parent=this.levelpanten\r\n            this.levelarr.push(mylevelnode)\r\n        }\r\n        for (let levelindex = 0; levelindex < this.levelarr.length; levelindex++) {\r\n            if(levelindex<MissionLevelManager.getInstance().getJsonLevelchapterLength(Chapter)){\r\n                let level=MissionLevelManager.getInstance().getJsonLevelchapterwholeLength(Chapter)+levelindex+1\r\n                this.levelarr[levelindex].getComponent(levelnode).init(level)\r\n                \r\n                // let pos=MissionLevelManager.getInstance().getJsonLevelPosXY(poslevel)\r\n                // this.levelarr[levelindex].setPosition(pos)\r\n                // this.levelarr[levelindex].getChildByName(\"level\").getComponent(cc.Label).string=\"\"+MissionLevelManager.getInstance().getLevelName\r\n                this.levelarr[levelindex].active=true\r\n            }else{\r\n                this.levelarr[levelindex].active=false\r\n            }\r\n        }\r\n    }\r\n    OnxiayizhangBtn(){//点击这个按钮进入下一关\r\n        MapManager.Currentlevel+=1\r\n        if(MapManager.Currentlevel>=35){\r\n            MapManager.Currentlevel=1\r\n        }\r\n        this.instantiatelevelnode()\r\n    }\r\n    // update (dt) {}\r\n}\r\n"]}
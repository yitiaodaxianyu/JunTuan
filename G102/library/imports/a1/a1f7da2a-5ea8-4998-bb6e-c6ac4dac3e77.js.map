{"version":3,"sources":["assets\\Scripts\\Tools\\NumberLabel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import MyTool from \"./MyTool\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n@ccclass\r\nexport default class NumberLabel extends cc.Label {\r\n\r\n    /**当前数字 */\r\n    cur_num:number=2000;\r\n    /**目标数字 */\r\n    target_num:number=2000;\r\n    /**完成当前数字变化至目标数字所需的时间 秒 */\r\n    compelete_num:number=0.5;\r\n    /**每帧的变化值 */\r\n    private changing:number=0;\r\n    refresh_time:number=0.05;\r\n    jishi:number=0;\r\n    is_show_k:boolean=true;\r\n    // 初始化文本\r\n    init (num:number,isShowK:boolean) {\r\n        this.cur_num=this.target_num=num;\r\n        this.is_show_k=isShowK;\r\n        this.showCurNum();\r\n    }\r\n    // 设置文本特效\r\n    setTarget(num:number,compeleteTime:number,isScale:boolean=false){\r\n        this.target_num=num;\r\n        let totalFrame=Math.ceil(compeleteTime/cc.director.getDeltaTime());\r\n        let offsetNum=this.target_num-this.cur_num;\r\n        this.changing=offsetNum/totalFrame;\r\n        if(isScale&&this.target_num!=this.cur_num){\r\n            let scaleTo=1.2;\r\n            let averageTime=compeleteTime/6;\r\n            cc.tween(this.node).to(averageTime,{scale:scaleTo}).to(averageTime,{scale:1.0}).to(averageTime,{scale:scaleTo}).to(averageTime,{scale:1.0}).to(averageTime,{scale:scaleTo}).to(averageTime,{scale:1.0}).start();\r\n        }\r\n    }\r\n\r\n    showCurNum(){\r\n        if(this.is_show_k)\r\n            this.string=MyTool.getCoinDanwei(this.cur_num,1);\r\n        else{\r\n            this.string=this.cur_num+\"\";\r\n        }\r\n    }\r\n\r\n    update (dt) {\r\n        if(this.cur_num!=this.target_num){\r\n            this.jishi+=dt;\r\n            this.cur_num=Math.ceil(this.cur_num+this.changing);            \r\n            if(this.jishi>=this.refresh_time){\r\n                this.jishi=0;\r\n                this.showCurNum();\r\n            }\r\n            let offsetNum=this.target_num-this.cur_num;  \r\n            if(Math.abs(offsetNum)<Math.abs(this.changing)){\r\n                this.cur_num=this.target_num;\r\n                this.showCurNum();\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}
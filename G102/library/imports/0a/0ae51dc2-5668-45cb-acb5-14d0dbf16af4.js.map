{"version":3,"sources":["assets\\Scripts\\Store\\StoreHeroShowUi.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameManager from \"../GameManager\";\r\nimport { HeroBaseInfoManager } from \"../Hero/Data/HeroBaseInfo\";\r\nimport { HeroManager } from \"../Hero/Data/HeroManager\";\r\nimport { SkillLevelUnlockManager } from \"../Hero/Data/SkillLevelUnlock\";\r\nimport { Hero_Type } from \"../Hero/Game/HeroConfig\";\r\nimport HeroSkillUi from \"../Hero/Ui/HeroSkillUi\";\r\nimport { LevelManager } from \"../Level/LevelManager\";\r\nimport LanguageManager from \"../multiLanguage/LanguageManager\";\r\nimport { SoundIndex } from \"../Sound/AudioConstants\";\r\nimport { StorageKey } from \"../Storage/StorageConfig\";\r\nimport { TheStorageManager } from \"../Storage/StorageManager\";\r\nimport TutorailsManager from \"../Tutorials/TutorailsManager\";\r\nimport UIComponent from \"../UI/UIComponent\";\r\nimport { UIPath, UILayerLevel } from \"../UI/UIConfig\";\r\nimport { UiAction } from \"../UI/UiInterface\";\r\nimport { UIManager } from \"../UI/UIManager\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class StoreHeroShowUi extends UIComponent {\r\n\r\n    hero_type:Hero_Type = null;\r\n\r\n    @property({type:[sp.SkeletonData]})\r\n    hero_skeleton_data:sp.SkeletonData[]=[];\r\n\r\n    @property(cc.SpriteAtlas)\r\n    role_ui : cc.SpriteAtlas = null;\r\n\r\n    init(uiAc: UiAction): void {\r\n        super.init(uiAc);\r\n        let bbg=this.node.getChildByName('bbg');\r\n        bbg.on(cc.Node.EventType.TOUCH_START,()=>{\r\n            if(TutorailsManager.getInstance().is_tutorails_state==true&&LevelManager.getInstance().finish_level<=3&&this.hero_type==Hero_Type.DeLuYi){\r\n                UIManager.getInstance().closeAllUiDialog(UILayerLevel.One);\r\n            }else{\r\n                super.onClose();\r\n            }\r\n            \r\n        },this);\r\n    }\r\n\r\n    initData(heroType:Hero_Type,isRecord:boolean=true){\r\n        this.hero_type = heroType;\r\n        if(isRecord)\r\n        TheStorageManager.getInstance().setItem(StorageKey.StoreHeroID + heroType % 110000,\"1\");\r\n        this.refreshUi();\r\n    }\r\n\r\n    refreshUi(){\r\n        this.node.getChildByName(\"name\").getComponent(cc.Label).string = LanguageManager.getInstance().getStrByTextId(HeroBaseInfoManager.getInstance().getNameText_ID(this.hero_type));\r\n        this.node.getChildByName(\"position\").getComponent(cc.Label).string = LanguageManager.getInstance().getStrByTextId(HeroBaseInfoManager.getInstance().getHeroPositioning(this.hero_type));\r\n        this.node.getChildByName(\"quality\").getComponent(cc.Sprite).spriteFrame = HeroManager.getInstance().getSpriteFrameByNames(\"Hero_Title_\" + HeroBaseInfoManager.getInstance().getQuality(this.hero_type) + \"_0\")\r\n        this.node.getChildByName(\"nameBg\").getComponent(cc.Sprite).spriteFrame = HeroManager.getInstance().getSpriteFrameByNames(\"Hero_Title_\" + HeroBaseInfoManager.getInstance().getQuality(this.hero_type) + \"_1\")\r\n        let heroSp = this.node.getChildByName(\"heroSp\").getComponent(sp.Skeleton)\r\n\r\n        let skillRoot = this.node.getChildByName(\"skillRoot\");\r\n        let skillNum = HeroBaseInfoManager.getInstance().getSkillNum(this.hero_type);\r\n        for(let i = 1;i <= 4;i++){\r\n            if(i>skillNum){\r\n                skillRoot.getChildByName(\"btnSkill\" + i).active = false;\r\n            }else{\r\n                // let skill = skillRoot.getChildByName(\"btnSkill\" + i);\r\n                // skill.getComponent(cc.Sprite).spriteFrame = this.role_ui.getSpriteFrame(\"Hero_\"+ this.hero_type +\"_Skill_\" + (i-1));\r\n                // skill.active = true;\r\n                // skill.children[0].getComponentInChildren(cc.Label).string = \"1\";\r\n                let skill = skillRoot.getChildByName(\"btnSkill\" + i);\r\n                skill.active = true;\r\n                let unlockLevel =  SkillLevelUnlockManager.getInstance().getHeroLevel(i)\r\n                if(HeroManager.getInstance().getHeroLevel(this.hero_type) < unlockLevel){\r\n                    skill.getComponent(cc.Sprite).spriteFrame = this.role_ui.getSpriteFrame(\"Hero_\"+ this.hero_type +\"_Skill_\" + (i-1));\r\n                    skill.getComponent(cc.Sprite).setMaterial(0, cc.Material.getBuiltinMaterial(\"2d-gray-sprite\"));\r\n                    skill.children[0].active = false;\r\n                }else{\r\n                    skill.getComponent(cc.Sprite).setMaterial(0, cc.Material.getBuiltinMaterial(\"2d-sprite\"));\r\n                    skill.getComponent(cc.Sprite).spriteFrame = this.role_ui.getSpriteFrame(\"Hero_\"+ this.hero_type +\"_Skill_\" + (i-1));\r\n                    skill.children[0].active = true;\r\n                    skill.children[0].getComponentInChildren(cc.Label).string = '1';\r\n                }\r\n            }\r\n        }\r\n\r\n        heroSp.skeletonData = this.hero_skeleton_data[this.hero_type-1];\r\n        heroSp.setAnimation(0,\"Attack\",true);\r\n        // anima.listener=null;\r\n        heroSp.setCompleteListener(() =>{\r\n            // anima.listener=null;\r\n            let name = '';\r\n            let judge = Math.random();\r\n            if(judge < 0.6){\r\n                name = 'Idle';\r\n            }else if(judge < 0.8){\r\n                name = 'Attack';\r\n            }else{\r\n                name = 'Idle2';\r\n            }\r\n            heroSp.setAnimation(0,name,true);\r\n        });\r\n        // heroSp.node.scale = 0.4;\r\n    }\r\n\r\n    onSkillClick(e,skillSlot:number){\r\n        // GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n        UIManager.getInstance().showUiDialog(UIPath.HeroSkill,UILayerLevel.Four,{onCompleted:(uiNode)=> {\r\n            uiNode.getComponent(HeroSkillUi).init(null);\r\n            uiNode.getComponent(HeroSkillUi).initData(this.hero_type,skillSlot);\r\n        },});\r\n    }\r\n    \r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\Hero\\Game\\RenZhe\\EllipseMove.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["//椭圆公式\r\n// 当焦点在x轴时，椭圆的标准方程是：x^2/a^2+y^2/b^2=1，(a>b>0)；\r\n\r\n// 当焦点在y轴时，椭圆的标准方程是：y^2/a^2+x^2/b^2=1，(a>b>0)；\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class EllipseMove extends cc.Component {\r\n\r\n    //围绕的几点数量\r\n    revolve_num:number=1;\r\n    weapons:cc.Node[]=[];\r\n    //椭圆的参数\r\n    //长轴\r\n    @property()\r\n    ellipse_A:number=64;\r\n\r\n    //短轴\r\n    @property()\r\n    ellipse_B:number=32;\r\n\r\n    //椭圆的中心\r\n    @property()\r\n    ellipse_Oxy:cc.Vec2=cc.v2(0,0);\r\n\r\n    //环绕的角速度\r\n    revolve_speed:number=360;\r\n    //当前与正半轴的夹角\r\n    @property()\r\n    cur_angle:number=0;\r\n\r\n    /*倾斜的角度*/\r\n    tilt_angle:number=0;\r\n\r\n    weapon_streak:cc.Node=null;\r\n\r\n\r\n    /**\r\n     * \r\n     * @param initAngle 初始的角度\r\n     * @param tiltAngle 整个椭圆倾斜的角度\r\n     * @param centerPos 中心位置,圆心\r\n     */\r\n    init(initAngle:number,tiltAngle:number,centerPos:cc.Vec2)\r\n    {\r\n        this.cur_angle=initAngle;\r\n        this.tilt_angle=tiltAngle;\r\n        this.ellipse_Oxy=centerPos;\r\n        this.update(0.0);\r\n        // if(this.tilt_angle==0)\r\n        // {\r\n        //     this.ellipse_A=100;\r\n        //     this.ellipse_B=400;\r\n        // }else\r\n        // {\r\n        //     this.ellipse_A=400;\r\n        //     this.ellipse_B=80;\r\n        // }\r\n    }\r\n\r\n    refreshAngle(angle:number){\r\n        this.cur_angle=angle;\r\n    }\r\n\r\n    update (dt) {\r\n        //if(this.target_node){            \r\n            let endX=0;\r\n            let endY=0;\r\n            //this.tilt_angle=Math.atan2(this.ellipse_Oxy.y,this.ellipse_Oxy.x)+Math.PI/2;\r\n            if(this.tilt_angle==0)\r\n            {\r\n                //正椭圆\r\n                this.cur_angle=(this.cur_angle+this.revolve_speed*dt)%360;\r\n                //转换弧度\r\n                let hudu=Math.PI*(this.cur_angle)/180;\r\n                endX=this.ellipse_Oxy.x+this.ellipse_A*Math.cos(hudu);\r\n                endY=this.ellipse_Oxy.y+this.ellipse_B*Math.sin(hudu);                \r\n            }else\r\n            {\r\n                //斜椭圆,倾斜60°\r\n                if(this.tilt_angle>0)\r\n                {\r\n                    this.cur_angle=(this.cur_angle+this.revolve_speed*dt)%360;\r\n                }else\r\n                {\r\n                    this.cur_angle=(this.cur_angle-this.revolve_speed*dt)%360;\r\n                }\r\n                //转换弧度\r\n                let hudu=Math.PI*(this.cur_angle)/180;\r\n                let normalCos=Math.cos(hudu);\r\n                let normalSin=Math.sin(hudu);\r\n                //转换弧度\r\n                let qingxieAngle=this.tilt_angle;\r\n                let qingxieCos=Math.cos(qingxieAngle);\r\n                let qingxieSin=Math.sin(qingxieAngle);\r\n               \r\n                endX=this.ellipse_Oxy.x+this.ellipse_A*normalCos*qingxieCos-this.ellipse_B*normalSin*qingxieSin;\r\n                endY=this.ellipse_Oxy.y+this.ellipse_B*normalCos*qingxieSin+this.ellipse_B*normalSin*qingxieCos;\r\n            }\r\n            this.node.x=endX;\r\n            this.node.y=endY;\r\n            this.node.zIndex=this.node.y>this.ellipse_Oxy.y?0:3;\r\n        //}\r\n        \r\n    }\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\Wall\\MainWall.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import ApkManager from \"../Ads/ApkManager\";\r\nimport { GameState, JiaSu } from \"../Constants\";\r\nimport HpProgressBar from \"../Monster/HpProgressBar\";\r\nimport GameManager from \"../GameManager\";\r\nimport MyTool from \"../Tools/MyTool\";\r\nimport ImmunityShield from \"./ImmunityShield\";\r\nimport Shield from \"./Shield\";\r\nimport { BuffId, BuffType, Hero_State, Hero_Type, SkillType } from \"../Hero/Game/HeroConfig\";\r\nimport { LevelManager } from \"../Level/LevelManager\";\r\nimport TutorailsManager from \"../Tutorials/TutorailsManager\";\r\nimport BuffStateManager from \"../Game/BuffStateManager\";\r\nimport Wall from \"./Wall\";\r\nimport WallManager from \"./WallManager\";\r\nimport { WallType } from \"./WallConfig\";\r\nimport { GameEffectsManager } from \"../Game/GameEffectsManager\";\r\nimport FightingManager from \"../Game/FightingManager\";\r\nimport { BuffData } from \"../Hero/Game/BuffData\";\r\nimport { instance } from \"../Game/TouchPlane/TouchPlane\";\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class MainWall extends Wall {\r\n\r\n    /**城墙0特效 */\r\n    wall_spine0: sp.Skeleton = null;\r\n    /**城墙1特效 */\r\n    wall_spine1: sp.Skeleton = null;\r\n    /**当前城墙的阶段 */\r\n    cur_wall_stage: number = 0;\r\n    /**上一个城墙的阶段 */\r\n    pre_wall_stage: number = 0;\r\n    /**受伤的 */\r\n    node_injured: cc.Node = null;\r\n    injured_action: cc.Tween = null;\r\n    node_vertigo: cc.Node = null;\r\n    vertigo_action: cc.Tween = null;\r\n\r\n    onLoad() {\r\n        this.setHpChangeListen(this.onWallChangeHp.bind(this));\r\n        this.setHpShowListen(this.showWallTeXiao.bind(this));\r\n        super.setWallDieListen(this.onWallDie.bind(this));\r\n        let hpRoot = cc.find('Canvas/Ui_Root/hp_root');\r\n        this.hp_progress = hpRoot.getChildByName('hp').getComponent(HpProgressBar);\r\n        this.shield_progress = hpRoot.getChildByName('shield').getComponent(cc.ProgressBar);\r\n        this.hp_text = hpRoot.getChildByName('hpText').getComponent(cc.Label);\r\n        this.shield_text = hpRoot.getChildByName('shieldText').getComponent(cc.Label);\r\n        this.map_shield_value = new Map<number, Shield>();\r\n        this.map_immunity_shield_value = new Map<number, ImmunityShield>();\r\n        this.node_injured = hpRoot.parent.getChildByName('injured');\r\n        this.node_vertigo = hpRoot.parent.getChildByName('vertigo');\r\n        this.wall_spine0 = this.node.getChildByName('wall0').getComponent(sp.Skeleton);\r\n        this.wall_spine1 = this.node.getChildByName('wall1').getComponent(sp.Skeleton);\r\n        this.wall_spine0.node.active = false;\r\n        this.wall_spine1.node.active = false;\r\n        WallManager.getInstance().addWall(WallType.Main, this);\r\n        this.showHp();\r\n        this.showShildProgress();\r\n        instance.on(cc.Node.EventType.TOUCH_END, this.onTouchEndByJoy, this);\r\n\r\n    }\r\n\r\n    start() {\r\n        BuffStateManager.getInstance().createBuffRoot(cc.v2(this.node.x, this.node.y + 150), Hero_Type.Hero_Num);\r\n        //let wallDown = this.node.getChildByName('wall_down');\r\n        //let worldPos = wallDown.parent.convertToWorldSpaceAR(wallDown.getPosition());\r\n        //let pos = GameEffectsManager.getInstance().node.convertToNodeSpaceAR(worldPos);\r\n        // this.setWallRect(cc.rect(wallDown.x, wallDown.y, wallDown.width, wallDown.height));\r\n      \r\n    }\r\n    protected onDestroy(): void {\r\n        instance.off(cc.Node.EventType.TOUCH_END, this.onTouchEndByJoy, this);\r\n    }\r\n    targetX: number = 0;\r\n    easing: number = 0.1;\r\n    onTouchEndByJoy(event: cc.Event.EventTouch, data) {\r\n        this.targetX = (GameManager.getInstance().aniType - 4) * 75;\r\n    }\r\n    protected update(dt: number): void {\r\n\r\n        if (GameManager.getInstance().cur_game_state != GameState.Game_Playing)\r\n            return;\r\n        if(this.node){\r\n\r\n            let vx: number = (this.targetX - this.node.x) * this.easing;\r\n            this.node.x += vx;\r\n\r\n            this.setWallRect(cc.rect( this.node.x-this.node.width/2,  this.node.y-this.node.height/2,  this.node.width,  this.node.height));\r\n            let ggp = FightingManager.getInstance().node.getComponent(cc.Graphics);\r\n            ggp.rect(this.getWallRect().x, this.getWallRect().y, this.getWallRect().width, this.getWallRect().height);\r\n\r\n           \r\n               \r\n            \r\n\r\n        }\r\n         \r\n    }\r\n    onWallDie() {\r\n        GameManager.getInstance().onWallDie();\r\n    }\r\n\r\n    startNextLevel() {\r\n        this.resetWallTeXiao();\r\n        this.is_tutorail = false;\r\n    }\r\n\r\n    /** */\r\n    public onWallChangeHp(hp: number): boolean {\r\n        if (hp < 0) {\r\n            this.showInjured();\r\n        }\r\n        /**教程 */\r\n        if (TutorailsManager.getInstance().is_finish_game == false && this.is_tutorail == false && this.cur_hp <= this.max_hp * 0.2) {\r\n            if (LevelManager.getInstance().start_level == 1) {\r\n                //最后一波\r\n                if (TutorailsManager.getInstance().isShowTutorials(200)) {\r\n                    this.is_tutorail = true;\r\n                    let buffData = new BuffData();\r\n                    buffData.buff_id = BuffId.Wall_Tutorial_Add_hp;\r\n                    buffData.buff_type = BuffType.Gain;\r\n                    buffData.buff_value = [this.getMaxHp() * 0.05];\r\n                    buffData.remain_time = 10;\r\n                    // buffData.game_effect_id=GameEffectId.chang_mao_shou_skill_active_1;\r\n                    buffData.recovery_jiange_time = 0.2;\r\n                    let buff = WallManager.getInstance().getMainWall().addBuff(buffData);\r\n                    buff.addDestroyListen(() => {\r\n                        this.is_tutorail = false;\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    showInjured() {\r\n        if (this.injured_action) {\r\n            this.injured_action.stop();\r\n        }\r\n        this.node_injured.opacity = 255;\r\n        this.injured_action = cc.tween(this.node_injured).to(0.5, { opacity: 0 }).start();\r\n    }\r\n\r\n    hideInjured() {\r\n        if (this.injured_action) {\r\n            this.injured_action.stop();\r\n        }\r\n        cc.tween(this.node_injured).to(0.2, { opacity: 0 }).start();\r\n    }\r\n\r\n    showVertigo(dt: number) {\r\n        this.node_vertigo.active = true;\r\n        if (this.vertigo_action) {\r\n            this.vertigo_action.stop();\r\n        }\r\n        this.node_vertigo.opacity = 255;\r\n        this.vertigo_action = cc.tween(this.node_vertigo).to(dt, { opacity: 0 }).start();\r\n    }\r\n\r\n    hideVertigo() {\r\n        if (this.vertigo_action) {\r\n            this.vertigo_action.stop();\r\n        }\r\n        cc.tween(this.node_vertigo).to(0.5, { opacity: 0 }).start();\r\n    }\r\n\r\n    showWallTeXiao() {\r\n        this.pre_wall_stage = this.cur_wall_stage;\r\n        if (this.hp_progress.progress >= 0 && this.hp_progress.progress < 0.25) {\r\n            this.cur_wall_stage = 3;\r\n        } else if (this.hp_progress.progress >= 0.25 && this.hp_progress.progress < 0.5) {\r\n            this.cur_wall_stage = 2;\r\n        } else if (this.hp_progress.progress >= 0.5 && this.hp_progress.progress < 0.75) {\r\n            this.cur_wall_stage = 1;\r\n        } else if (this.hp_progress.progress >= 0.75) {\r\n            this.cur_wall_stage = 0;\r\n        }\r\n        if (this.cur_wall_stage != this.pre_wall_stage) {\r\n            MyTool.randomSceneShakeSmall();\r\n            ApkManager.getInstance().beVibrate(300);\r\n            if (this.cur_wall_stage > 0) {\r\n                this.wall_spine0.setAnimation(0, 'Hurt' + this.cur_wall_stage + '_2', true);\r\n                this.wall_spine0.node.active = true;\r\n                if (this.cur_wall_stage > 1) {\r\n                    this.wall_spine1.setAnimation(0, 'Hurt' + this.cur_wall_stage + '_1', true);\r\n                    this.wall_spine1.node.active = true;\r\n                } else {\r\n                    this.wall_spine1.node.active = false;\r\n                }\r\n            } else {\r\n                this.wall_spine0.node.active = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    resetWallTeXiao() {\r\n        this.pre_wall_stage = this.cur_wall_stage = 0;\r\n        if (this.wall_spine0) {\r\n            this.wall_spine0.node.active = false;\r\n        }\r\n        if (this.wall_spine1) {\r\n            this.wall_spine1.node.active = false;\r\n        }\r\n\r\n    }\r\n\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\Hero\\Skill\\FullScreenDamage.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,6CAA4C;AAC5C,oEAAiF;AACjF,iDAA4C;AAItC,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAA8C,oCAAY;IAA1D;QAAA,qEAkDC;QAhDG,UAAU;QACV,mBAAa,GAAQ,CAAC,CAAC;QACvB,UAAU;QACV,kBAAY,GAAQ,CAAC,CAAC;QACtB,QAAQ;QACR,oBAAc,GAAQ,CAAC,CAAC;QACxB,YAAY;QACZ,qBAAe,GAAU,IAAI,CAAC;QAC9B,UAAU;QACV,eAAS,GAAc,IAAI,CAAC;;IAuChC,CAAC;IArCG,+BAAI,GAAJ,UAAK,YAAyB,EAAC,YAAmB,EAAC,cAAuB;QACtE,IAAI,CAAC,cAAc,GAAC,YAAY,CAAC;QACjC,IAAI,CAAC,aAAa,GAAC,YAAY,CAAC;QAChC,IAAI,CAAC,YAAY,GAAC,CAAC,CAAC;QACpB,IAAI,CAAC,eAAe,GAAC,cAAc,CAAC;QACpC,IAAI,CAAC,IAAI,CAAC,OAAO,GAAC,GAAG,CAAC;QACtB,IAAI,CAAC,SAAS,GAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QACpD,IAAI,CAAC,WAAW,EAAE,CAAC;IACvB,CAAC;IAED,sCAAW,GAAX;QACI,uCAAkB,CAAC,WAAW,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,cAAc,EAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC1F,CAAC;IAED,sCAAW,GAAX;QAAA,iBAWC;QAVG,MAAM;QACN,IAAI,CAAC,IAAI,CAAC,OAAO,GAAC,GAAG,CAAC;QACtB,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;QACtB,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,SAAS,CAAC,QAAQ,EAAC;YAC9C,KAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,SAAS,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;YACpD,KAAI,CAAC,IAAI,CAAC,OAAO,GAAC,CAAC,CAAC;QACxB,CAAC,CAAC,CAAA;QACF,IAAG,IAAI,CAAC,eAAe,EAAC;YACpB,IAAI,CAAC,eAAe,EAAE,CAAC;SAC1B;IACL,CAAC;IAED,iCAAM,GAAN,UAAQ,EAAS;QACb,IAAG,qBAAW,CAAC,WAAW,EAAE,CAAC,cAAc,IAAE,qBAAS,CAAC,YAAY,EAAC;YAChE,OAAO;SACV;QACD,IAAI,CAAC,YAAY,IAAE,EAAE,CAAC;QACtB,IAAG,IAAI,CAAC,YAAY,IAAE,IAAI,CAAC,aAAa,EAAC;YACrC,IAAI,CAAC,YAAY,GAAC,CAAC,CAAC;YACpB,IAAI,CAAC,WAAW,EAAE,CAAC;SACtB;IACL,CAAC;IAjDgB,gBAAgB;QADpC,OAAO;OACa,gBAAgB,CAkDpC;IAAD,uBAAC;CAlDD,AAkDC,CAlD6C,EAAE,CAAC,SAAS,GAkDzD;kBAlDoB,gBAAgB","file":"","sourceRoot":"/","sourcesContent":["import { GameState } from \"../../Constants\";\r\nimport { GameEffectId, GameEffectsManager } from \"../../Game/GameEffectsManager\";\r\nimport GameManager from \"../../GameManager\";\r\n\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class FullScreenDamage extends cc.Component {\r\n\r\n    /**伤害间隔 */\r\n    damage_jiange:number=0;\r\n    /**伤害计数 */\r\n    damage_jishu:number=0;\r\n    /**特效 */\r\n    game_effect_id:number=0;\r\n    /**伤害监听回调 */\r\n    damage_callback:Function=null;\r\n    /**动画组件 */\r\n    animation:cc.Animation=null;\r\n\r\n    init(gameEffectId:GameEffectId,damageJiange:number,damageCallback:Function){\r\n        this.game_effect_id=gameEffectId;\r\n        this.damage_jiange=damageJiange;\r\n        this.damage_jishu=0;\r\n        this.damage_callback=damageCallback;\r\n        this.node.opacity=255;\r\n        this.animation=this.node.getComponent(cc.Animation);\r\n        this.checkDamage();\r\n    }\r\n\r\n    destroySelf(){\r\n        GameEffectsManager.getInstance().destroyGameEffectById(this.game_effect_id,this.node);\r\n    }\r\n\r\n    checkDamage(){\r\n        //播放特效\r\n        this.node.opacity=255;\r\n        this.animation.play();\r\n        this.animation.on(cc.Animation.EventType.FINISHED,()=>{                    \r\n            this.animation.off(cc.Animation.EventType.FINISHED);\r\n            this.node.opacity=0;\r\n        })\r\n        if(this.damage_callback){\r\n            this.damage_callback();\r\n        }\r\n    }\r\n\r\n    update (dt:number) {\r\n        if(GameManager.getInstance().cur_game_state!=GameState.Game_Playing){\r\n            return;\r\n        }\r\n        this.damage_jishu+=dt;\r\n        if(this.damage_jishu>=this.damage_jiange){\r\n            this.damage_jishu=0;\r\n            this.checkDamage();\r\n        }    \r\n    }\r\n}\r\n"]}
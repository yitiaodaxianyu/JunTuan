{"version":3,"sources":["assets\\Scripts\\Tools\\PressButton.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class PressButton extends cc.Component {\r\n\r\n    @property([cc.Component.EventHandler])\r\n    press_events: cc.Component.EventHandler[]=[];\r\n\r\n    // @property([cc.Component.EventHandler])\r\n    // release_events: cc.Component.EventHandler[]=[];\r\n\r\n    @property()\r\n    interval:number=0.1;\r\n\r\n    private is_can_press:boolean=true;\r\n\r\n    private is_click:boolean=false;\r\n    private is_press:boolean=false;\r\n\r\n    onLoad(): void {\r\n        this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this);\r\n        this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this);\r\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this);\r\n        if(this.interval<=0){\r\n            this.interval=0.1;\r\n        }\r\n    }\r\n    \r\n    onDestroy(): void {\r\n        this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this);\r\n        this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this);\r\n        this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this);\r\n    }\r\n\r\n    onTouchStart(btn:cc.Event.EventTouch)\r\n    {\r\n        if(this.is_can_press){\r\n            //默认使用放大处理按下操作\r\n            this.is_press=true;\r\n            cc.tween(btn.currentTarget).to(0.1,{scale:0.9}).start();\r\n            this.is_click=false;\r\n            this.onClick(btn);\r\n            this.schedule(this.onClick,this.interval);            \r\n            //cc.log('onTouchStart');\r\n        }\r\n    }\r\n\r\n    onTouchEnd(btn:cc.Event.EventTouch)\r\n    {\r\n        if(this.is_press){\r\n            this.is_press=false;\r\n            cc.tween(btn.currentTarget).to(0.1,{scale:1.0}).start();\r\n            this.unschedule(this.onClick);\r\n            if(!this.is_click){\r\n                this.onClick(btn);\r\n            }\r\n            // for(let i=0; i<this.release_events.length; i++){\r\n            //     this.release_events[i].emit([btn]);\r\n            // }\r\n            //cc.log('onTouchEnd');\r\n        }\r\n    }\r\n    \r\n    onClick(btn:cc.Event.EventTouch){\r\n        this.is_click=true;\r\n        for(let i=0; i<this.press_events.length; i++){\r\n            this.press_events[i].emit([this.node]);\r\n        }\r\n    }\r\n\r\n    setIsCanPress(isCan:boolean){\r\n        this.is_can_press=isCan;\r\n        this.setMat();\r\n    }\r\n\r\n    getIsCanPress():boolean{\r\n        return this.is_can_press;\r\n    }\r\n\r\n    setMat(){\r\n        let normalMaterial=cc.Material.getBuiltinMaterial('2d-sprite');\r\n        let grayMaterial=cc.Material.getBuiltinMaterial('2d-gray-sprite');\r\n        this.node.getComponent(cc.Sprite).setMaterial(0,this.is_can_press?normalMaterial:grayMaterial);\r\n        if(this.is_can_press==false){\r\n            this.unschedule(this.onClick);\r\n        }\r\n    }\r\n}\r\n"]}
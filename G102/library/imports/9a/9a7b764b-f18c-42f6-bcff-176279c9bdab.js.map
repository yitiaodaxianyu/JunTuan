{"version":3,"sources":["assets\\Scripts\\Monster\\Elite\\Elite1.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\nimport { GameState } from \"../../Constants\";\r\nimport { Enemy_State } from \"../../Enemy/EnemyConfig\";\r\nimport { GameEffectId, GameEffectsManager } from \"../../Game/GameEffectsManager\";\r\nimport GameManager from \"../../GameManager\";\r\nimport { DamageType } from \"../../Hero/Game/HeroConfig\";\r\nimport MyTool from \"../../Tools/MyTool\";\r\nimport Wall from \"../../Wall/Wall\";\r\nimport { WallType } from \"../../Wall/WallConfig\";\r\nimport WallManager from \"../../Wall/WallManager\";\r\nimport { KeyFrameData } from \"../MonsterData\";\r\nimport MonsterNewNormal from \"../MonsterNewNormal\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Elite1 extends MonsterNewNormal {\r\n\r\n    chongci_juli:number=0;\r\n    is_chongci:boolean=false;\r\n    is_xuli:boolean=false;\r\n    chong_ci_speed:number=1000;\r\n    jiasu:number=200;\r\n    cur_jiasu:number=0;\r\n    is_release_skill:boolean=false;\r\n\r\n    protected onLoad(): void {\r\n        super.onLoad();  \r\n        GameEffectsManager.getInstance().addEffectPoolById(GameEffectId.monster37_shitouren,1);\r\n        super.addMonsterNormalInited(this.onMonsterNormalInited);\r\n        this.addXuanYunListen(this.onXuanYunResult);\r\n    }\r\n\r\n    onMonsterNormalInited () {\r\n        this.chongci_juli=this.skill_data.getCastingRange(1);\r\n        this.is_chongci=false;\r\n        this.cur_jiasu=0;\r\n        this.is_release_skill=false;\r\n    }\r\n\r\n    onXuanYunResult(isXuanYun: boolean): void {\r\n        if(isXuanYun){\r\n            this.startXuanYun();\r\n        }else{\r\n            if(!super.getIsDie()){\r\n                this.startIdle();\r\n                this.setEnemyState(Enemy_State.move);\r\n            }\r\n        }\r\n    }\r\n\r\n    startXuanYun(): void {\r\n        this.unschedule(this.startChongCi);\r\n        this.is_xuli=false;\r\n    }\r\n\r\n    startSkill(){\r\n        this.setEnemyState(Enemy_State.skill);\r\n        //蓄力\r\n        super.playSpinAnimaton(\"Side_Skill1_1\",true,null,null);\r\n        this.is_xuli=true;\r\n        this.scheduleOnce(this.startChongCi,3);\r\n        this.is_release_skill=true;\r\n    }\r\n\r\n    startChongCi(){\r\n        if(this.is_xuli==true){\r\n            this.is_xuli=false;\r\n            this.is_chongci=true;\r\n            this.cur_toughness+=1;\r\n            //冲刺\r\n            super.playSpinAnimaton(\"Side_Skill1_2\",true,null,null);\r\n        }        \r\n    }\r\n\r\n    endChongCi(wall:Wall){\r\n        this.cur_toughness-=1;\r\n        this.is_chongci=false;\r\n        super.playSpinAnimaton(\"Side_Skill1_3\",false,null,()=>{\r\n            this.startIdle();\r\n            this.setEnemyState(Enemy_State.move);\r\n        });\r\n        let data=wall.beInjured(this.getAttData(DamageType.Skill,false,this.skill_data.getSkillValue1(1)));\r\n        if(data.getDamageNum()>0){\r\n            GameEffectsManager.getInstance().createGameEffectById(GameEffectId.monster37_shitouren,cc.v2(this.node.x,wall.getWallMaxYY()));\r\n        }\r\n        cc.tween(this.node).by(0.2,{y:this.base_data.AttackDistance}).start();\r\n        MyTool.randomSceneShakeSmall();\r\n    }\r\n\r\n    update (dt) {\r\n        if((GameManager.getInstance().cur_game_state!=GameState.Game_Playing)||this.getIsDie())\r\n        {\r\n            return;\r\n        }\r\n        super.update(dt);\r\n        //this.checkSkill(dt);\r\n        \r\n    }\r\n\r\n    checkSkill(dt:number){\r\n        if(this.getEnemyState()!=Enemy_State.skill){\r\n            if(this.is_release_skill==true){\r\n                return;\r\n            }\r\n            let walls=WallManager.getInstance().getAllWall();\r\n            let attWall=null;\r\n            walls.forEach((wall:Wall,wallType:WallType)=>{\r\n                //攻击城墙的条件1，必须在城墙之上,2达到攻击距离\r\n                let distance=Math.abs(this.node.y-wall.getWallMaxYY());\r\n                if(this.node.y>=wall.getWallMaxYY()&&distance<=this.chongci_juli&&distance>this.base_data.AttackDistance){                \r\n                    attWall=wall;\r\n                }\r\n            });\r\n            if(attWall){\r\n                this.startSkill();\r\n            }\r\n        }else{\r\n            if(this.is_chongci){\r\n                this.cur_jiasu+=dt*this.jiasu;\r\n                this.node.y-=dt*(this.chong_ci_speed+this.cur_jiasu);\r\n                let walls=WallManager.getInstance().getAllWall();\r\n                let attWall=null;\r\n                walls.forEach((wall:Wall,wallType:WallType)=>{\r\n                    //攻击城墙的条件1，必须在城墙之上,2达到攻击距离\r\n                    if(this.node.y>=wall.getWallMaxYY()&&Math.abs(this.node.y-wall.getWallMaxYY())<=this.base_data.AttackDistance/2){\r\n                        attWall=wall;\r\n                    }\r\n                });\r\n                if(attWall){\r\n                    this.endChongCi(attWall);\r\n                }else{\r\n                    let mainWall=WallManager.getInstance().getMainWall();\r\n                    if(this.node.y<=mainWall.getWallMaxYY()){\r\n                        this.endChongCi(mainWall);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n}\r\n"]}
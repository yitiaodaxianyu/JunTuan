{"version":3,"sources":["assets\\Scripts\\Maze\\MazeShop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import EquipItem from \"../Equipment/Ui/EquipItem\";\r\nimport GameManager from \"../GameManager\";\r\nimport { LevelManager } from \"../Level/LevelManager\";\r\nimport { MissionLevelManager } from \"../Level/MissionLevel\";\r\nimport { Follow_Type } from \"../multiLanguage/FollowConstants\";\r\nimport FollowManager from \"../multiLanguage/FollowManager\";\r\nimport { LanguageIndex } from \"../multiLanguage/LanguageConstants\";\r\nimport LanguageManager from \"../multiLanguage/LanguageManager\";\r\nimport Prop from \"../Prop/Prop\";\r\nimport { PropAction, PropId } from \"../Prop/PropConfig\";\r\nimport { PropManager } from \"../Prop/PropManager\";\r\nimport { SoundIndex } from \"../Sound/AudioConstants\";\r\nimport MyTool from \"../Tools/MyTool\";\r\nimport UIComponent from \"../UI/UIComponent\";\r\n// import { RogueShopManager } from \"./Data/RogueShop\";\r\nimport { RogueTextManager } from \"./Data/RogueText\";\r\nimport { MazeManager, PropIndex, ShopPropList } from \"./MazeManager\";\r\nimport MazeUi from \"./MazeUi\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class MazeShop extends UIComponent {\r\n    /**格子id */\r\n    box_id:number=0;\r\n    hexagon_type:number=4;\r\n    is_can_go:boolean=false;\r\n\r\n    initData(id:number,isCanGo:boolean){\r\n        this.box_id=id;\r\n        this.is_can_go=isCanGo;\r\n        this.initUi();\r\n    }\r\n\r\n    initUi(){\r\n        //标题\r\n        let jsonData=RogueTextManager.getInstance().getJsonRogueText(this.hexagon_type);\r\n        let titleLabel=this.node.getChildByName('titleLabel');\r\n        titleLabel.getComponent(cc.Label).string=LanguageManager.getInstance().getStrByTextId(jsonData.Roguetitle_ID);\r\n        let contentLabel=this.node.getChildByName('contentLabel');\r\n        contentLabel.getComponent(cc.Label).string=LanguageManager.getInstance().getStrByTextId(jsonData.RogueText_ID);        \r\n        let btnNo=this.node.getChildByName('btnNo');\r\n        btnNo.active=this.is_can_go;\r\n        let btnYes=this.node.getChildByName('btnYes');\r\n        btnYes.active=this.is_can_go;\r\n        if(this.is_can_go)\r\n        {\r\n            if(MazeManager.getInstance().getPassingId()==this.box_id){\r\n                btnNo.active=true;\r\n                btnYes.active=false;\r\n            }else{\r\n                btnNo.active=false;\r\n                btnYes.active=true;\r\n            }\r\n        }\r\n        this.initItemList();\r\n    }\r\n\r\n    initItemList(){\r\n        let level=LevelManager.getInstance().finish_level+1;\r\n        level=level>MissionLevelManager.getMaxLevel()?MissionLevelManager.getMaxLevel():level;\r\n        let finishChapter=MissionLevelManager.getInstance().getChapter(level);\r\n        return\r\n        // let jsonData=RogueShopManager.getInstance().getJsonRogueShop(finishChapter);\r\n        // //判断是不是第一次打开\r\n        // let list:PropIndex[]=MazeManager.getInstance().getAPropIndex(this.box_id);\r\n        // let saleArr=[0.2,0.3,0.4];\r\n        // if(list.length>0){\r\n        // }else{\r\n        //     let itemIndexs=MyTool.getWeightIndexs(jsonData.RogueWeight,4);\r\n        //     //折扣                                    \r\n        //     for(let i=0; i<itemIndexs.length; i++){\r\n        //         let propIndex:PropIndex={\r\n        //             prop_index: itemIndexs[i],\r\n        //             prop_sale: saleArr[Math.floor(Math.random()*saleArr.length)],\r\n        //         }\r\n        //         list.push(propIndex);\r\n        //     }\r\n        //     let al={\r\n        //         box_id: this.box_id,\r\n        //         prop_list: list,                \r\n        //     }\r\n        //     MazeManager.getInstance().setShopProp(al);\r\n        // }\r\n        // let itemRoot=this.node.getChildByName('item_root');\r\n        // let pac=this.is_can_go&&MazeManager.getInstance().getFightingId()==this.box_id?PropAction.Buy:PropAction.Look;\r\n        // for(let i=0; i<list.length; i++){\r\n        //     let itemIndex=list[i];\r\n        //     let item=PropManager.getInstance().createSalePropItem(jsonData.RogueProductList[itemIndex.prop_index],jsonData.RogueProductQuantity[itemIndex.prop_index],pac);\r\n        //     itemRoot.addChild(item);\r\n        //     let itemTs=item.getComponent(EquipItem)\r\n        //     if(itemTs){\r\n        //         itemTs.initSaleItem(PropId.Gem,jsonData.RogueProductPrice[itemIndex.prop_index],itemIndex.prop_sale*100);\r\n        //         itemTs.addBuyListen(()=>{\r\n        //             itemTs.soldOut();\r\n        //         });\r\n        //     }else{\r\n        //         let propTs=item.getComponent(Prop)\r\n        //         if(propTs){\r\n        //             propTs.initSaleItem(PropId.Gem,jsonData.RogueProductPrice[itemIndex.prop_index],itemIndex.prop_sale*100);\r\n        //             propTs.addBuyListen(()=>{\r\n        //                 propTs.soldOut();\r\n        //             });\r\n        //         }\r\n        //     }\r\n            \r\n        // }\r\n    }\r\n\r\n    clickBtnYes(){\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n        MazeManager.getInstance().setPassingId(this.box_id);\r\n        MazeManager.getInstance().setFightingId(this.box_id);\r\n        MazeUi.getInstance().refreshFloor();\r\n        super.onClose();\r\n        FollowManager.getInstance().followEvent(Follow_Type.rogue玩法商店事件);\r\n    }\r\n\r\n    clickBtnNo(){\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n        //MazeManager.getInstance().setPassingId(this.box_id);\r\n        MazeManager.getInstance().addMazePassedId(this.box_id);\r\n        MazeUi.getInstance().refreshFloor();\r\n        super.onClose();\r\n    }\r\n\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\copy\\endlesschallenges\\Shop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport GameManager from \"../../GameManager\";\r\nimport LanguageManager from \"../../multiLanguage/LanguageManager\";\r\nimport TextLanguage from \"../../multiLanguage/TextLanguage\";\r\nimport { ItemManager } from \"../../Prop/Data/Item\";\r\nimport { PropId } from \"../../Prop/PropConfig\";\r\nimport { PropManager } from \"../../Prop/PropManager\";\r\nimport { SoundIndex } from \"../../Sound/AudioConstants\";\r\nimport UIComponent from \"../../UI/UIComponent\";\r\nimport { RogueShopManager } from \"./RogueShop\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Shop extends UIComponent {\r\n    @property(cc.Node)\r\n    content: cc.Node = null//物品的父节点\r\n    @property(cc.Node)\r\n    num: cc.Node = null//虚空金币的数量\r\n    @property(cc.Node)\r\n    Maze_Shop_Bg_1: cc.Node = null//虚空商品的预制体\r\n    \r\n    item:cc.Node[]=[]//生成的节点\r\n    initUi() {//虚空裂缝\r\n        let max=RogueShopManager.getMaxShowLoacl()\r\n        this.Refresh()\r\n        for (let index = this.item.length; index < max; index++) {\r\n            let id=index+1\r\n            let myitem=cc.instantiate(this.Maze_Shop_Bg_1)\r\n            let name=myitem.getChildByName(\"name\")\r\n            let num=myitem.getChildByName(\"num\")\r\n            let item=myitem.getChildByName(\"item\")\r\n            let prop_id=RogueShopManager.getInstance().getProp_ID(id)\r\n            num.getComponent(cc.Label).string=\"\"+RogueShopManager.getInstance().getCostNum(id)\r\n            name.getComponent(TextLanguage).setTextId(ItemManager.getInstance().getNameTextId(prop_id))\r\n            let itemnode=PropManager.getInstance().createPropItem(prop_id,RogueShopManager.getInstance().getProp_Num(id));\r\n            itemnode.scale=0.6\r\n            itemnode.parent=item\r\n            myitem.on(cc.Node.EventType.TOUCH_END,(()=>{\r\n                this.clickBtnitem(id)   \r\n            }),this);\r\n            myitem.active=true\r\n\r\n            myitem.parent=this.content\r\n            this.item.push(myitem)\r\n        }\r\n    }\r\n    clickBtnitem(id){\r\n        let MazeCoin=PropManager.getInstance().getPropNum(PropId.MazeCoin);\r\n        let CostNum=RogueShopManager.getInstance().getCostNum(id)\r\n        if(MazeCoin>=CostNum){\r\n            // 可以购买\r\n            let prop_id=RogueShopManager.getInstance().getProp_ID(id)\r\n            let Prop_Num =RogueShopManager.getInstance().getProp_Num(id)\r\n            let itemnode=PropManager.getInstance().createPropItem(prop_id,Prop_Num);\r\n            PropManager.getInstance().changePropNum(prop_id,Prop_Num);\r\n            GameManager.getInstance().showGetTip(itemnode);\r\n            // MazeCoin-=CostNum\r\n            PropManager.getInstance().changePropNum(PropId.MazeCoin,-CostNum);\r\n            this.Refresh()\r\n        }else{  \r\n            // 虚空裂缝金币不足\r\n            GameManager.getInstance().showMessage(LanguageManager.getInstance().getStrByTextId(830030),3);\r\n        }\r\n    }\r\n    Refresh(){\r\n        let MazeCoin=PropManager.getInstance().getPropNum(PropId.MazeCoin);\r\n        this.num.getComponent(cc.Label).string=\"\"+MazeCoin\r\n    }\r\n    clickBtnClose()//关闭\r\n    {\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n        this.onClose();\r\n    }\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n\r\n    // start () {\r\n\r\n    // }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\Hero\\Game\\BuffState.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,6CAA4C;AAC5C,iDAA4C;AAC5C,2CAA6C;AAGvC,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAuC,6BAAY;IAAnD;QAAA,qEA+DC;QA9DG,WAAW;QACH,iBAAW,GAAQ,CAAC,CAAC;QAC7B,oBAAoB;QACZ,eAAS,GAAe,0BAAa,CAAC,MAAM,CAAC;QACrD,aAAa;QACL,sBAAgB,GAAU,IAAI,CAAC;QAEvC,iBAAW,GAAQ,CAAC,CAAC;;IAuDzB,CAAC;IArDG,wBAAI,GAAJ,UAAK,IAAkB,EAAC,UAAiB,EAAC,QAAiB;QACvD,IAAI,CAAC,WAAW,GAAC,UAAU,CAAC;QAC5B,IAAI,CAAC,SAAS,GAAC,IAAI,CAAC;QACpB,IAAI,CAAC,IAAI,CAAC,OAAO,GAAC,GAAG,CAAC;QACtB,IAAI,CAAC,gBAAgB,GAAC,QAAQ,CAAC;IACnC,CAAC;IAED,iCAAa,GAAb;QACI,OAAO,IAAI,CAAC,WAAW,CAAC;IAC5B,CAAC;IAED,+BAAW,GAAX;QACI,OAAO,IAAI,CAAC,SAAS,CAAC;IAC1B,CAAC;IAED,+BAAW,GAAX,UAAY,UAAiB;QACzB,IAAG,UAAU,GAAC,IAAI,CAAC,WAAW,EAC9B;YACI,IAAI,CAAC,WAAW,GAAC,UAAU,CAAC;YAC5B,IAAG,IAAI,CAAC,WAAW,IAAE,CAAC,EAAC;gBACnB,IAAI,CAAC,IAAI,CAAC,OAAO,GAAC,GAAG,CAAC;aACzB;SACJ;IACL,CAAC;IAEM,+BAAW,GAAlB;QACI,IAAG,IAAI,CAAC,gBAAgB,EAAC;YACrB,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACzC;QACD,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,CAAC;IACjC,CAAC;IAES,0BAAM,GAAhB,UAAiB,EAAU;QACvB,IAAG,qBAAW,CAAC,WAAW,EAAE,CAAC,cAAc,IAAE,qBAAS,CAAC,YAAY,EAAC;YAChE,IAAG,IAAI,CAAC,WAAW,GAAC,CAAC,EAAC;gBAClB,IAAI,CAAC,WAAW,IAAE,EAAE,CAAC;gBACrB,IAAG,IAAI,CAAC,WAAW,GAAC,CAAC,EAAC;oBAClB,IAAI,CAAC,WAAW,GAAC,CAAC,CAAC;oBACnB,IAAI,CAAC,WAAW,EAAE,CAAC;iBACtB;gBACD,IAAG,IAAI,CAAC,WAAW,IAAE,CAAC,EAAC;oBACnB,IAAI,CAAC,IAAI,CAAC,OAAO,IAAE,IAAI,CAAC,WAAW,CAAC;oBACpC,IAAG,IAAI,CAAC,IAAI,CAAC,OAAO,IAAE,GAAG,EAAC;wBACtB,IAAI,CAAC,WAAW,GAAC,CAAC,CAAC;qBACtB;yBAAK,IAAG,IAAI,CAAC,IAAI,CAAC,OAAO,IAAE,GAAG,EAAC;wBAC5B,IAAI,CAAC,WAAW,GAAC,CAAC,CAAC,CAAC;qBACvB;iBACJ;qBAAI;oBACD,IAAI,CAAC,IAAI,CAAC,OAAO,GAAC,GAAG,CAAC;iBACzB;aACJ;SACJ;IACL,CAAC;IA9DgB,SAAS;QAD7B,OAAO;OACa,SAAS,CA+D7B;IAAD,gBAAC;CA/DD,AA+DC,CA/DsC,EAAE,CAAC,SAAS,GA+DlD;kBA/DoB,SAAS","file":"","sourceRoot":"/","sourcesContent":["import { GameState } from \"../../Constants\";\r\nimport GameManager from \"../../GameManager\";\r\nimport { BuffStateType } from \"./HeroConfig\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class BuffState extends cc.Component {\r\n    /**剩余的时间 */\r\n    private remain_time:number=0;\r\n    /**护盾类型，可以抵消的伤害类型 */\r\n    private buff_type:BuffStateType=BuffStateType.Attack;\r\n    /**时间结束的回调 */\r\n    private destroy_callback:Function=null;\r\n\r\n    opacity_num:number=5;\r\n\r\n    init(type:BuffStateType,remainTime:number,callback:Function){\r\n        this.remain_time=remainTime;\r\n        this.buff_type=type;\r\n        this.node.opacity=255;\r\n        this.destroy_callback=callback;\r\n    }\r\n\r\n    getRemainTime():number{\r\n        return this.remain_time;\r\n    }\r\n\r\n    getBuffType():BuffStateType{\r\n        return this.buff_type;\r\n    }\r\n\r\n    refreshTime(remainTime:number){\r\n        if(remainTime>this.remain_time)\r\n        {\r\n            this.remain_time=remainTime;\r\n            if(this.remain_time>=3){\r\n                this.node.opacity=255;\r\n            }            \r\n        }\r\n    }\r\n\r\n    public destroySelf(){\r\n        if(this.destroy_callback){\r\n            this.destroy_callback(this.buff_type);\r\n        }\r\n        this.node.removeFromParent();        \r\n    }\r\n\r\n    protected update(dt: number): void {\r\n        if(GameManager.getInstance().cur_game_state==GameState.Game_Playing){\r\n            if(this.remain_time>0){\r\n                this.remain_time-=dt;\r\n                if(this.remain_time<0){\r\n                    this.remain_time=0;\r\n                    this.destroySelf();\r\n                }\r\n                if(this.remain_time<=3){                    \r\n                    this.node.opacity+=this.opacity_num;\r\n                    if(this.node.opacity<=128){\r\n                        this.opacity_num=5;\r\n                    }else if(this.node.opacity>=255){\r\n                        this.opacity_num=-5;\r\n                    }\r\n                }else{\r\n                    this.node.opacity=255;\r\n                }\r\n            }\r\n        }        \r\n    }\r\n}\r\n"]}
{"version":3,"sources":["assets\\Scripts\\Sound\\Muisc.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,8CAAyC;AAInC,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAmC,yBAAc;IAAjD;;IA4EA,CAAC;IA1EG,sBAAM,GAAN;QACI,qBAAW,CAAC,WAAW,EAAE,CAAC,aAAa,GAAC,IAAI,CAAC;QAC7C,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,QAAQ,EAAE,CAAC;IACpB,CAAC;IACD,yBAAS,GAAT;QAEI,qBAAW,CAAC,WAAW,EAAE,CAAC,aAAa,GAAC,IAAI,CAAC;QAC7C,IAAI,CAAC,IAAI,EAAE,CAAC;IAChB,CAAC;IACD,gGAAgG;IAEhG,0BAAU,GAAV;QAEI,IAAI,GAAG,GAAC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;QACpD,IAAG,GAAG,KAAG,IAAI,IAAE,GAAG,KAAG,EAAE,EACvB;YACI,GAAG,GAAC,CAAC,CAAC;SACT;QACD,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;IAC1C,CAAC;IAED,+BAAe,GAAf,UAAgB,GAAW;QAEvB,IAAG,GAAG,IAAE,SAAS,EACjB;YACI,IAAI,CAAC,MAAM,GAAC,GAAG,CAAC;SACnB;QACD,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,cAAc,EAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC5D,CAAC;IAED,wBAAQ,GAAR;QAEI,IAAI,IAAI,GAAC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;QACnD,IAAG,IAAI,KAAG,IAAI,IAAE,IAAI,KAAG,EAAE,EACzB;YACI,IAAI,GAAC,KAAK,CAAC;SACd;aACD;YACI,IAAG,IAAI,KAAG,OAAO,EACjB;gBACI,IAAI,GAAC,KAAK,CAAC;aACd;iBAAK,IAAG,IAAI,KAAG,MAAM,EACtB;gBACI,IAAI,GAAC,IAAI,CAAC;aACb;SACJ;QACD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAED,6BAAa,GAAb,UAAc,IAAa;QAEvB,IAAG,IAAI,IAAE,SAAS,EAClB;YACI,IAAI,CAAC,IAAI,GAAC,IAAI,CAAC;SAClB;QACD,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,YAAY,EAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACxD,CAAC;IAED,yBAAS,GAAT,UAAU,UAAqB;QAA/B,iBAYC;QAVG,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,GAAC,UAAU,EAAC,EAAE,CAAC,SAAS,EAAC,UAAC,KAAY,EAAE,MAAmB;YAClF,IAAG,KAAK,EACR;gBACI,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;gBACnB,OAAO;aACV;YACD,KAAI,CAAC,IAAI,GAAC,MAAM,CAAC;YACjB,KAAI,CAAC,IAAI,EAAE,CAAC;YACZ,KAAI,CAAC,IAAI,GAAC,IAAI,CAAC;QACnB,CAAC,CAAC,CAAC;IACP,CAAC;IAzEgB,KAAK;QADzB,OAAO;OACa,KAAK,CA4EzB;IAAD,YAAC;CA5ED,AA4EC,CA5EkC,EAAE,CAAC,WAAW,GA4EhD;kBA5EoB,KAAK","file":"","sourceRoot":"/","sourcesContent":["import GameManager from \"../GameManager\";\r\nimport { MusicIndex } from \"./AudioConstants\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Music extends cc.AudioSource {\r\n\r\n    onLoad () {\r\n        GameManager.getInstance().music_manager=this;\r\n        this.loadVolume();\r\n        this.loadMute();\r\n    }\r\n    onDestroy()\r\n    {\r\n        GameManager.getInstance().music_manager=null;        \r\n        this.stop();\r\n    }\r\n    /*-----------------------------------声音的逻辑处理--------------------------------------------------*/\r\n\r\n    loadVolume()\r\n    {\r\n        let vol=cc.sys.localStorage.getItem('music_volume');\r\n        if(vol===null||vol==='')\r\n        {\r\n            vol=1;\r\n        }\r\n        this.saveMusicVolume(parseFloat(vol));        \r\n    }\r\n\r\n    saveMusicVolume(vol?:number)\r\n    {\r\n        if(vol!=undefined)\r\n        {\r\n            this.volume=vol;\r\n        }        \r\n        cc.sys.localStorage.setItem('music_volume',this.volume);\r\n    }\r\n\r\n    loadMute()\r\n    {\r\n        let mute=cc.sys.localStorage.getItem('music_mute');\r\n        if(mute===null||mute==='')\r\n        {\r\n            mute=false;\r\n        }else\r\n        {\r\n            if(mute==='false')\r\n            {\r\n                mute=false;\r\n            }else if(mute==='true')\r\n            {\r\n                mute=true;\r\n            }\r\n        }\r\n        this.saveMusicMute(mute);\r\n    }\r\n\r\n    saveMusicMute(mute?:boolean)\r\n    {\r\n        if(mute!=undefined)\r\n        {\r\n            this.mute=mute;\r\n        }\r\n        cc.sys.localStorage.setItem('music_mute',this.mute);\r\n    }\r\n\r\n    playMusic(musicIndex:MusicIndex)\r\n    {\r\n        cc.resources.load('musics/'+musicIndex,cc.AudioClip,(error: Error, assets:cc.AudioClip)=>{\r\n            if(error)\r\n            {\r\n                console.log(error);\r\n                return;\r\n            }\r\n            this.clip=assets;\r\n            this.play();\r\n            this.loop=true;\r\n        });\r\n    }\r\n\r\n    \r\n}\r\n"]}
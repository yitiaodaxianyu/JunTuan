{"version":3,"sources":["assets\\Scripts\\Wall\\Wall.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { GameState, JiaSu } from \"../Constants\";\r\nimport { Enemy_Injured_Type } from \"../Enemy/EnemyConfig\";\r\nimport BuffStateManager from \"../Game/BuffStateManager\";\r\nimport { GameEffectId } from \"../Game/GameEffectsManager\";\r\nimport SkyManager from \"../Game/SkyManager\";\r\nimport GameManager from \"../GameManager\";\r\nimport { BuffData } from \"../Hero/Game/BuffData\";\r\nimport BuffState from \"../Hero/Game/BuffState\";\r\nimport BuffTimer from \"../Hero/Game/BuffTimer\";\r\nimport { AttributeData, BuffId, BuffStateType, DamageType, Hero_Type, ShieldType } from \"../Hero/Game/HeroConfig\";\r\nimport HpProgressBar from \"../Monster/HpProgressBar\";\r\nimport Monster from \"../Monster/Monster\";\r\nimport { MonsterAttData, InjuredData, FeedBackType, StrengthType } from \"../Monster/MonsterData\";\r\nimport MyTool from \"../Tools/MyTool\";\r\nimport ImmunityShield from \"./ImmunityShield\";\r\nimport Shield from \"./Shield\";\r\nimport { WallType } from \"./WallConfig\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Wall extends cc.Component {\r\n    /**属性数据 */\r\n    protected attribute_data:AttributeData=null;\r\n    /**城墙类型 */\r\n    protected wall_type:WallType=WallType.Main;    \r\n    //当前血量\r\n    protected cur_hp:number=1000;\r\n    /**最大血量 */\r\n    protected max_hp:number=1000;\r\n    protected hp_progress:HpProgressBar=null;\r\n    protected shield_progress:cc.ProgressBar=null;\r\n    protected hp_text:cc.Label=null;\r\n    protected shield_text:cc.Label=null;\r\n    /*BUFF* */\r\n    protected wall_buff: Map<BuffId,BuffTimer>=null;\r\n    /*BUFF* */\r\n    protected wall_de_buff: Map<BuffId,BuffTimer>=null;\r\n    /**buff状态 */\r\n    protected map_buff_state:Map<number,BuffState>=null;\r\n    /**护盾 */\r\n    protected map_shield_value:Map<number,Shield>=null;\r\n    /**免疫护盾 */\r\n    protected map_immunity_shield_value:Map<number,ImmunityShield>=null;\r\n\r\n    /**城墙死亡监听 */\r\n    private die_callback:Function=null;\r\n    /**血条发生改变的回调 */\r\n    private hp_change_callback:Function=null;\r\n    /**血条显示时的回调 */\r\n    private hp_show_callback:Function=null;\r\n    /**血条显示时的回调 */\r\n    private damage_callback:Function=null;\r\n    /**城墙的矩形 */\r\n    private wall_rect:cc.Rect=null;\r\n    /**城墙的最高Y轴坐标 */\r\n    private wall_max_yy:number=0;\r\n    /**是否死亡了 */\r\n    is_die:boolean=false;\r\n\r\n    is_tutorail:boolean=false;\r\n    \r\n    /**\r\n     * 初始化城墙数据\r\n     * @param attributeData 属性数据\r\n     * @param wallType 城墙的类型\r\n     */\r\n    initWall(attributeData:AttributeData,wallType:WallType) {\r\n        this.attribute_data=attributeData;\r\n        this.wall_type=wallType;\r\n        this.is_die=false;\r\n        this.cur_hp=this.max_hp=attributeData.Health=Math.round(attributeData.Health);\r\n        if(!this.map_shield_value){\r\n            this.map_shield_value=new Map<number,Shield>();\r\n        }        \r\n        if(!this.map_immunity_shield_value){\r\n            this.map_immunity_shield_value=new Map<number,ImmunityShield>();\r\n        }        \r\n        if(!this.wall_buff){\r\n            this.wall_buff=new Map<BuffId,BuffTimer>();\r\n        }\r\n        if(!this.wall_de_buff){\r\n            this.wall_de_buff=new Map<BuffId,BuffTimer>();\r\n        }\r\n        this.removeAllBuff();\r\n        this.removeAllDeBuff();\r\n        this.removeAllShield();\r\n        this.showHp();\r\n        this.showShildProgress();        \r\n    }\r\n\r\n    refreshWallData(attributeData:AttributeData){\r\n        this.attribute_data=attributeData;\r\n        this.max_hp=attributeData.Health=Math.round(attributeData.Health);\r\n        this.showHp();\r\n    }\r\n    refreshWallDataByaddHero(attributeData:AttributeData){\r\n        this.attribute_data=attributeData;\r\n        let der_hp:number=this.max_hp-this.cur_hp;\r\n        console.log(\"差值血量\");\r\n        \r\n        this.max_hp=attributeData.Health=Math.round(attributeData.Health);\r\n        this.cur_hp=this.max_hp-der_hp;\r\n        this.showHp();\r\n    }\r\n    getAttributeData():AttributeData{\r\n        return this.attribute_data;\r\n    }\r\n\r\n    /**设置城墙死亡的监听 */\r\n    setWallDieListen(callback:Function){\r\n        this.die_callback=callback;\r\n    }\r\n    /**设置城墙血量发生改变时的监听 */\r\n    setHpChangeListen(callback:Function){\r\n        this.hp_change_callback=callback;\r\n    }\r\n    /**设置城墙血量显示时的监听 */\r\n    setHpShowListen(callback:Function){\r\n        this.hp_show_callback=callback;\r\n    }\r\n    /**设置城墙受伤时的监听 */\r\n    setDamageListen(callback:Function){\r\n        this.damage_callback=callback;\r\n    }\r\n    /**设置城墙的矩形 */\r\n    protected setWallRect(rect:cc.Rect){\r\n        this.wall_rect=rect;\r\n        this.wall_max_yy=rect.yMax;\r\n    }\r\n    /**获取城墙的矩形 */\r\n    public getWallRect():cc.Rect{\r\n        return this.wall_rect;\r\n    }\r\n    /**获取城墙的最高点 */\r\n    public getWallMaxYY():number{\r\n        return this.wall_max_yy;\r\n    }\r\n    /**获取城墙的类型 */\r\n    public getWallType():WallType{\r\n        return this.wall_type;\r\n    }\r\n    /**\r\n     * 城墙受伤计算\r\n     * @param damage 伤害值\r\n     * @param damageType 伤害类型\r\n     * @param strengthType 怪物类型\r\n     * @param monsterData 怪物数据\r\n     * @param isReal 是否真实伤害\r\n     * @param ship 船撞的时候的伤害\r\n     */\r\n    beInjured(monsterAttData:MonsterAttData,isReal:boolean=false,ship:number=0):InjuredData{\r\n        let monsterData=monsterAttData.monster_attribute;\r\n        let data=new InjuredData();\r\n        let missRate=0;        \r\n        let critRate=0;\r\n        let damage=0;\r\n        //如果是普通攻击，计算闪避和暴击，默认为0\r\n        if(monsterAttData.damage_type==DamageType.Normal){\r\n            missRate=InjuredData.calcMissRate(this.attribute_data.Miss,monsterData.Hit);\r\n            critRate=InjuredData.calcCritRate(monsterData.Critical,this.attribute_data.AntiCritical);\r\n            //获取一个概率类型\r\n            let type=InjuredData.calcOnceType([missRate,critRate,1]);\r\n            switch(type){\r\n                case 0:{\r\n                    //闪避\r\n                    data.feedback_type=FeedBackType.ShanBi;\r\n                    data.setDamageNum(0);\r\n                }break;\r\n                case 1:{\r\n                    //暴击\r\n                    data.feedback_type=FeedBackType.BaoJi;\r\n                    if(isReal){\r\n                        damage=InjuredData.calcNormalCritRealDamageNum(monsterData.Attack,InjuredData.calcFinalExtraCrit(monsterData.ExtraCritical,this.attribute_data.AntiExtraCritical));\r\n                    }else{\r\n                        damage=InjuredData.calcNormalCritDamageNum(monsterData.Attack,this.attribute_data.Defense,monsterAttData.zengshang_rate,this.attribute_data.reduce_injury_rate,InjuredData.calcFinalExtraCrit(monsterData.ExtraCritical,this.attribute_data.AntiExtraCritical));\r\n                    }\r\n                    data.setDamageNum(damage); \r\n                    if(this.damage_callback){\r\n                        this.damage_callback(monsterAttData.monster_ts);\r\n                    }                   \r\n                }break;\r\n                case 2:{\r\n                    //普通命中\r\n                    data.feedback_type=FeedBackType.Null;\r\n                    if(isReal){\r\n                        damage=InjuredData.calcNormalRealDamageNum(monsterData.Attack);   \r\n                    }else{\r\n                        damage=InjuredData.calcNormalDamageNum(monsterData.Attack,this.attribute_data.Defense,monsterAttData.zengshang_rate,this.attribute_data.reduce_injury_rate);                    \r\n                    }\r\n                    data.setDamageNum(damage);\r\n                    if(this.damage_callback){\r\n                        this.damage_callback(monsterAttData.monster_ts);\r\n                    }\r\n                }break;            \r\n            }\r\n        }else if(monsterAttData.damage_type==DamageType.Skill){\r\n            //不需要计算闪避，技能必中\r\n            data.feedback_type=FeedBackType.Null;\r\n            if(isReal){\r\n                damage=InjuredData.calcSkillRealDamageNum(monsterData.Attack,monsterAttData.skill_rate);\r\n            }else{\r\n                damage=InjuredData.calcSkillDamageNum(monsterData.Attack,monsterAttData.skill_rate,this.attribute_data.Defense,monsterAttData.zengshang_rate,this.attribute_data.reduce_injury_rate);\r\n            }\r\n            data.setDamageNum(damage);\r\n        }else if(monsterAttData.damage_type==DamageType.Ship){\r\n            data.feedback_type=FeedBackType.Null;\r\n            data.setDamageNum(ship);\r\n        }\r\n        if(data.getDamageNum()>0){\r\n            //cc.log(data.getDamageNum());\r\n            if(!this.checkMmmunityShield(1,monsterAttData.damage_type)){\r\n                //先减护盾的值\r\n                let value=this.changeShieldValue(-data.getDamageNum(),monsterAttData.damage_type);\r\n                if(value<0){\r\n                    this.changeHp(value);\r\n                    if(this.wall_type==WallType.Main){\r\n                        if(monsterAttData.strength_type==StrengthType.Boss){\r\n                            if(monsterAttData.damage_type==DamageType.Skill){\r\n                                if(monsterAttData.is_big){\r\n                                    MyTool.randomSceneShakeBig();\r\n                                }else{\r\n                                    MyTool.randomSceneShakeSmall();\r\n                                }                                \r\n                            }else if(monsterAttData.damage_type==DamageType.Normal){\r\n                                MyTool.randomSceneShakeSmall();\r\n                            }\r\n                        }\r\n                    }                    \r\n                }\r\n            }else{\r\n                //提示免疫\r\n\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n    /**造成真实伤害，直接造成对应的伤害值,无法闪避 */\r\n    beRealDamage(damageType:DamageType,strengthType:StrengthType,damage:number){\r\n        let data=new InjuredData();\r\n        data.setDamageNum(damage);        \r\n        if(data.getDamageNum()>0){\r\n            if(!this.checkMmmunityShield(1,damageType)){\r\n                //先减护盾的值\r\n                let value=this.changeShieldValue(-data.getDamageNum(),damageType);\r\n                if(value<0){\r\n                    this.changeHp(value);\r\n                    if(strengthType==StrengthType.Boss){\r\n                        if(damageType==DamageType.Skill){\r\n                            MyTool.randomSceneShakeBig();\r\n                        }else if(damageType==DamageType.Normal){\r\n                            MyTool.randomSceneShakeSmall();\r\n                        }\r\n                    }\r\n                }\r\n            }else{\r\n                //提示免疫\r\n\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**改变血量值，返回是否死亡 */\r\n    public changeHp(hp:number):boolean\r\n    {\r\n        let gm=GameManager.getInstance();\r\n        if(gm.cur_game_state==GameState.Game_Lose || gm.cur_game_state==GameState.Game_Pause || gm.cur_game_state==GameState.Game_Win || this.is_die)\r\n        {\r\n            return true;\r\n        }\r\n        if(hp<0)\r\n        {            \r\n            cc.tween(this.node).to(0.1,{color:cc.Color.RED}).to(0.1,{color:cc.Color.WHITE}).start();            \r\n        }\r\n        let newHp=this.cur_hp+hp;\r\n        if(this.hp_change_callback){\r\n            this.hp_change_callback(hp);\r\n        }\r\n        return this.setHp(newHp);\r\n    }\r\n    /**无尽模式的立即恢复血量 */\r\n    public changeHpByEndless(hp:number){\r\n        let newHp=this.cur_hp+hp;\r\n        if(this.hp_change_callback){\r\n            this.hp_change_callback(hp);\r\n        }\r\n        this.setHp(newHp)\r\n    }\r\n    /**返回是否死亡 */\r\n    private setHp(newHp:number):boolean{\r\n        if(newHp>this.max_hp)\r\n        {\r\n            newHp=this.max_hp;\r\n        }else if(newHp<=0){\r\n            newHp=0;\r\n            this.is_die=true;\r\n            if(this.die_callback){\r\n                this.die_callback();\r\n            }\r\n        }\r\n        this.cur_hp=newHp;\r\n        // if(this.is_tutorail){\r\n        //     //教程锁血\r\n        //     this.cur_hp=this.getMaxHp()/2;\r\n        // }\r\n        this.showHp();\r\n        return this.cur_hp<=0;\r\n    }\r\n\r\n    protected showHp()\r\n    {\r\n        if(this.hp_progress){\r\n            this.hp_progress.changeProgress(this.cur_hp/this.max_hp);\r\n        }\r\n        if(this.hp_text){\r\n            this.hp_text.string=Math.floor(this.cur_hp)+'/'+this.max_hp;\r\n        }\r\n        if(this.hp_show_callback){\r\n            this.hp_show_callback();\r\n        }\r\n    }\r\n\r\n    getMaxHp():number\r\n    {\r\n        return this.max_hp;\r\n    }\r\n\r\n    getCurHp():number\r\n    {\r\n        return this.cur_hp;\r\n    }\r\n\r\n    getCurHpPer():number\r\n    {\r\n        return this.cur_hp/this.max_hp;\r\n    }\r\n\r\n    /**添加一个盾 */\r\n    addShield(id:number,type:ShieldType,remainTime:number,value:number,gameEffectId:GameEffectId){\r\n        if(this.map_shield_value.has(id)){\r\n            this.map_shield_value.get(id).refreshShield(remainTime,value);\r\n        }else{\r\n            let shield=new cc.Node().addComponent(Shield);\r\n            shield.init(id,type,remainTime,value,this.onShieldDestroy.bind(this));\r\n            this.map_shield_value.set(id,shield);\r\n            this.node.addChild(shield.node);\r\n            /**添加护盾特效 */\r\n            if(gameEffectId!=GameEffectId.Null){\r\n                let texiao=SkyManager.getInstance().createGameEffectById(gameEffectId,this.node.getPosition());\r\n                shield.setGameEffectData(gameEffectId,texiao);\r\n            }                        \r\n        }\r\n        this.showShildProgress();\r\n        \r\n    }\r\n    onShieldDestroy(id:number): void {        \r\n        this.map_shield_value.delete(id);\r\n        this.showShildProgress();\r\n    }\r\n\r\n    /**更改护盾值，返回伤害溢出的值*/\r\n    changeShieldValue(num:number,type:DamageType):number{\r\n        //根据伤害类型遍历出对应的护盾\r\n        let shieldArr=new Array<Shield>();\r\n        this.map_shield_value.forEach((v,k)=>{\r\n            if(v.getIsCanWithstand(type)){\r\n                shieldArr.push(v);\r\n            }\r\n        });\r\n        //排序\r\n        if(shieldArr.length>=2){\r\n            shieldArr.sort((left:Shield,right:Shield)=>{\r\n                return left.getRemainTime()-right.getRemainTime();\r\n            })\r\n        }\r\n        let newValue=num;\r\n        for(let i=0; i<shieldArr.length; i++){\r\n            newValue=shieldArr[i].changeShieldValue(num);\r\n            if(newValue>0){\r\n                break;\r\n            }\r\n        }\r\n        this.showShildProgress();\r\n        return newValue;\r\n    }\r\n\r\n    protected showShildProgress(){\r\n        let value=this.getShieldValue();\r\n        let progress=value/this.getMaxHp();\r\n        if(progress>1){\r\n            progress=1;\r\n        }\r\n        if(this.shield_progress){\r\n            this.shield_progress.node.active=value>0;\r\n            this.shield_progress.progress=progress\r\n        }\r\n        if(this.shield_text){\r\n            this.shield_text.node.active=value>0;\r\n            this.shield_text.string=value.toFixed(0);\r\n        }\r\n    }\r\n\r\n    /**匹配护盾 */\r\n    getShieldValue():number{\r\n        let value=0;\r\n        this.map_shield_value.forEach((v,k)=>{\r\n            value+=v.getShieldValue();\r\n        });\r\n        return value;\r\n    }\r\n\r\n    removeAllShield(){\r\n        this.map_shield_value.forEach((v,k)=>{\r\n            v.destroySelf();\r\n        });\r\n    }\r\n\r\n    /**添加一个具有免疫效果的盾 */\r\n    addImmunityShield(id:number,type:ShieldType,remainTime:number,value:number){\r\n        if(this.map_immunity_shield_value.has(id)){\r\n            this.map_immunity_shield_value.get(id).refreshShield(remainTime,value);\r\n        }else{\r\n            let shield=new cc.Node().addComponent(ImmunityShield);\r\n            shield.init(id,type,remainTime,value,(id)=>{\r\n                this.map_immunity_shield_value.delete(id);\r\n            })\r\n            this.map_immunity_shield_value.set(id,shield);\r\n            this.node.addChild(shield.node);\r\n        }\r\n    }\r\n\r\n    /**检查免疫护盾值，返回是否能免疫*/\r\n    checkMmmunityShield(num:number,type:DamageType):boolean{\r\n        //根据伤害类型遍历出对应的护盾\r\n        let shieldArr=new Array<ImmunityShield>();\r\n        this.map_immunity_shield_value.forEach((v,k)=>{            \r\n            if(v.getIsCanWithstand(type)){\r\n                shieldArr.push(v);\r\n            }\r\n        });\r\n        //排序\r\n        if(shieldArr.length>=2){\r\n            shieldArr.sort((left:ImmunityShield,right:ImmunityShield)=>{\r\n                return left.getRemainTime()-right.getRemainTime();\r\n            })\r\n        }\r\n        let newValue=num;\r\n        for(let i=0; i<shieldArr.length; i++){\r\n            newValue=shieldArr[i].changeShieldValue(num);\r\n            if(newValue>0){\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**---------------------------------------------BUFF--------------------------------------------------- */\r\n    addBuff(buffData:BuffData): BuffTimer {\r\n        let buffId=buffData.buff_id;\r\n        if(!this.isHaveBuff(buffId))\r\n        {\r\n            //添加buff节点和特效                   \r\n            let node=new cc.Node(buffData.game_effect_id.toString());\r\n            this.node.addChild(node);\r\n            //添加buff\r\n            let buff:BuffTimer=node.getComponent(BuffTimer);\r\n            if(!buff){\r\n                buff=node.addComponent(BuffTimer);\r\n            }\r\n            buff.init(buffData);\r\n            //buff销毁时处理\r\n            buff.addDestroyListen(this.onBuffDestory.bind(this));\r\n            //buff治疗触发时处理\r\n            if(buffData.recovery_jiange_time>0){\r\n                buff.addRecoveryListen({\r\n                    doRecovery:(num:number)=>{\r\n                        this.changeHp(num);\r\n                        let pos=cc.v2(Math.random()*600-300,this.node.y+Math.random()*200-100);\r\n                        GameManager.getInstance().hp_text_manager.createHpTextHp(pos,num,Enemy_Injured_Type.ZhiLiao);\r\n                        SkyManager.getInstance().createGameEffectById(GameEffectId.monster_zhiliao_halo_hit,pos);\r\n                    }\r\n                },buff.getFirstBuffValue());\r\n            }\r\n            this.wall_buff.set(buffData.buff_id,buff);\r\n            switch(buffId){\r\n                case BuffId.Hero_ZhenDe_JiaXueJianShang:{\r\n                    this.attribute_data.reduce_injury_rate+=buffData.buff_value[1];\r\n                }break;\r\n            }\r\n            this.addBuffState(buffId,buffData.remain_time);\r\n            return buff;\r\n        }else{\r\n            let buff=this.wall_buff.get(buffId);\r\n            buff.refreshBuff(buffData);\r\n            this.addBuffState(buffId,buffData.remain_time);  \r\n            return buff;         \r\n        }          \r\n    }\r\n\r\n    subBuff(buffId: BuffId): boolean {\r\n        let buff=this.wall_buff.get(buffId);\r\n        if(buff)\r\n        {\r\n            buff.destroySelf();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    onBuffDestory(buffData:BuffData){\r\n        this.wall_buff.delete(buffData.buff_id);\r\n        switch(buffData.buff_id){           \r\n            case BuffId.Hero_ZhenDe_JiaXueJianShang:{\r\n                this.attribute_data.reduce_injury_rate-=buffData.buff_value[1];\r\n            }break;\r\n        }\r\n    }\r\n\r\n    isHaveBuff(buff: BuffId): boolean {\r\n        return this.wall_buff.has(buff);\r\n    }\r\n\r\n    removeAllBuff(){\r\n        this.wall_buff.forEach((buff:BuffTimer)=>{\r\n            this.subBuff(buff.getBuffId());\r\n        })\r\n    }\r\n\r\n    /**添加一个buff状态图标 */\r\n    addBuffState(buffId:BuffId,remainTime:number){\r\n        let types=BuffStateManager.getInstance().getBuffType(buffId);\r\n        for(let i=0; i<types.length; i++){\r\n            let type=types[i];\r\n            if(this.map_buff_state.has(type)){\r\n                this.map_buff_state.get(type).refreshTime(remainTime);\r\n            }else{\r\n                let bfState=BuffStateManager.getInstance().createBuffState(type,Hero_Type.Hero_Num);\r\n                bfState.init(type,remainTime,()=>{\r\n                    this.map_buff_state.delete(type);\r\n                });\r\n                this.map_buff_state.set(type,bfState);\r\n                //this.node.addChild(shield.node);\r\n            }\r\n        }\r\n    }\r\n\r\n    getBuffType(buffId:BuffId):BuffStateType[]{\r\n        let type=[];\r\n        switch(buffId){\r\n\r\n        }\r\n        return type;            \r\n    }\r\n\r\n    addDeBuff(buffData:BuffData,monsterAttData:MonsterAttData): boolean {\r\n        let buffId=buffData.buff_id;\r\n        if(!this.isHaveDeBuff(buffId))\r\n        {\r\n            //添加buff节点和特效                   \r\n            let node=new cc.Node(buffData.game_effect_id.toString());\r\n            this.node.addChild(node);\r\n            //添加buff\r\n            let buff:BuffTimer=node.getComponent(BuffTimer);\r\n            if(!buff){\r\n                buff=node.addComponent(BuffTimer);\r\n            }\r\n            buff.init(buffData);\r\n            //buff销毁时处理\r\n            buff.addDestroyListen(this.onDeBuffDestory.bind(this));            \r\n            this.wall_de_buff.set(buffData.buff_id,buff);\r\n            //buff伤害触发时处理\r\n            if(buffData.damage_jiange_time>0&&monsterAttData){\r\n                buff.addDamageListen({\r\n                    doDamage:(monsterAttData:MonsterAttData)=>{\r\n                        monsterAttData.is_big=false;\r\n                        this.beInjured(monsterAttData);\r\n                    }\r\n                },monsterAttData);\r\n            }\r\n            switch(buffId){\r\n                \r\n            }\r\n            return true;\r\n        }else{\r\n            this.wall_de_buff.get(buffId).refreshBuff(buffData);         \r\n        }  \r\n        return false;\r\n    }\r\n\r\n    subDeBuff(buffId: BuffId): boolean {\r\n        let buff=this.wall_de_buff.get(buffId);\r\n        if(buff)\r\n        {\r\n            buff.destroySelf();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    onDeBuffDestory(buffData:BuffData){\r\n        this.wall_de_buff.delete(buffData.buff_id);\r\n        switch(buffData.buff_id){           \r\n            \r\n        }\r\n    }\r\n\r\n    isHaveDeBuff(buff: BuffId): boolean {\r\n        return this.wall_de_buff.has(buff);\r\n    }\r\n\r\n    removeAllDeBuff(){\r\n        this.wall_de_buff.forEach((buff:BuffTimer)=>{\r\n            this.subDeBuff(buff.getBuffId());\r\n        })\r\n    }\r\n\r\n    destroyWall(){\r\n        if(this.die_callback){\r\n            this.die_callback();\r\n        }\r\n    }\r\n\r\n}\r\n"]}
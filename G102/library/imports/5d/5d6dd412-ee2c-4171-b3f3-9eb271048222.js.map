{"version":3,"sources":["assets\\Scripts\\Prop\\PropManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import WXManagerEX from \"../../startscene/WXManagerEX\";\r\nimport { HttpManager, Params_Type, AccessName, PropObject } from \".././NetWork/HttpManager\";\r\nimport { EquipmentAttributeManager } from \"../Equipment/Data/EquipmentAttribute\";\r\nimport { EquipInfo, EquipType } from \"../Equipment/EquipConfig\";\r\nimport { EquipmentManager } from \"../Equipment/EquipmentManager\";\r\nimport GameManager from \"../GameManager\";\r\nimport { HeroManager } from \"../Hero/Data/HeroManager\";\r\nimport { Hero_Type } from \"../Hero/Game/HeroConfig\";\r\nimport { Follow_Type } from \"../multiLanguage/FollowConstants\";\r\nimport FollowManager from \"../multiLanguage/FollowManager\";\r\nimport LanguageManager from \"../multiLanguage/LanguageManager\";\r\nimport { PetInfo, PetMessage, PetType } from \"../Pet/PetConfig\";\r\nimport { PetManager } from \"../Pet/PetManager\";\r\nimport { StorageKey } from \"../Storage/StorageConfig\";\r\nimport { TheStorageManager } from \"../Storage/StorageManager\";\r\nimport { AssetsEventType, EventManager, RedEventString, RedEventType } from \"../Tools/EventManager\";\r\nimport UserData from \"../UserData\";\r\nimport { ItemManager } from \"./Data/Item\";\r\nimport Prop from \"./Prop\";\r\nimport { PropAction, PropData, PropId } from \"./PropConfig\";\r\n\r\n\r\nexport class PropManager {\r\n    private static _instance: PropManager = null;\r\n\r\n    //道具数据\r\n    private map_prop_num:Map<number,number>=null;\r\n    //资源\r\n    private prop_item:cc.Prefab=null;\r\n    private prop_sale_item:cc.Prefab=null;\r\n    private item_atlas:cc.SpriteAtlas=null;\r\n\r\n\r\n    public static getInstance():PropManager {\r\n        if(this._instance==null) {\r\n            this._instance=new PropManager();\r\n            this._instance.init();\r\n        }\r\n        return this._instance;\r\n    }\r\n\r\n    //初始化游戏数据\r\n    private init () {\r\n        ItemManager.getInstance();\r\n        this.loadItemPrefab();\r\n        this.loadSaleItemPrefab();\r\n        this.loadSp();        \r\n    }\r\n\r\n    //-----------------------资源的读取-----------------------------\r\n    private loadItemPrefab(){\r\n        if(this.prop_item)\r\n        return;\r\n        WXManagerEX.getInstance().resourcesBundle.load('prop/item',cc.Prefab,(error: Error, assets:cc.Prefab)=>{\r\n            if(error)\r\n            {\r\n                console.log(error);\r\n                return;\r\n            }\r\n            this.prop_item=assets;\r\n        });\r\n    }    \r\n\r\n    private loadSaleItemPrefab(){\r\n        if(this.prop_sale_item)\r\n        return;\r\n        WXManagerEX.getInstance().resourcesBundle.load('prop/saleItem',cc.Prefab,(error: Error, assets:cc.Prefab)=>{\r\n            if(error)\r\n            {\r\n                console.log(error);\r\n                return;\r\n            }\r\n            this.prop_sale_item=assets;\r\n        });\r\n    } \r\n\r\n    private loadSp(){\r\n        if(this.item_atlas)\r\n        return;\r\n        WXManagerEX.getInstance().resourcesBundle.load('prop/item_list',cc.SpriteAtlas,(error: Error, assets:cc.SpriteAtlas)=>{\r\n            if(error)\r\n            {\r\n                console.log(error);\r\n                return;\r\n            }\r\n            this.item_atlas=assets;            \r\n        });\r\n    }\r\n\r\n    \r\n    /**资源 */\r\n    public getSpByName(name:string):cc.SpriteFrame{\r\n        return this.item_atlas.getSpriteFrame(name);\r\n    }\r\n    /**通过道具id获得一个精灵帧（不含装备宠物） */\r\n    public getSpByPropId(propId:PropId):cc.SpriteFrame{\r\n        let iconId=ItemManager.getInstance().getQuoteIcon(propId);\r\n        let iconSpName=\"Item_\"+iconId;\r\n        return this.getSpByName(iconSpName);\r\n    }\r\n    \r\n    public getEquipIcon(posType:number):cc.SpriteFrame{\r\n        let iconSpName=\"Weapon_\"+posType;\r\n        return this.getSpByName(iconSpName);\r\n    }\r\n\r\n    /**通过道具id获得类型(力量敏捷智力)的精灵帧*/\r\n    public getSpTypeByType(type:PetType):cc.SpriteFrame{\r\n        let iconSpName=\"Hero_Type_\"+type;\r\n        return this.getSpByName(iconSpName);\r\n    }\r\n\r\n    public getSpFrameByPropType(propType:PropId):cc.SpriteFrame{\r\n        let iconSpName=\"Item_frame_\"+ItemManager.getInstance().getQuality(propType);\r\n        return this.getSpByName(iconSpName);\r\n    }\r\n    public getSpFrameByExType(propType:number):cc.SpriteFrame{\r\n        let iconSpName=\"Item_frameEX_\"+propType;\r\n        return this.getSpByName(iconSpName);\r\n    }\r\n\r\n    public getSpFrameByCharioType(propType:number):cc.SpriteFrame{\r\n        let iconSpName=\"rIcon\"+propType;\r\n        return this.getSpByName(iconSpName);\r\n    }\r\n    /**通过英雄id获得一个头像 */\r\n    public getSpheadPortraitType(propType:number):cc.SpriteFrame{\r\n        let iconSpName=\"Item_\"+(110000+propType);//Item_110001\r\n        return this.getSpByName(iconSpName);\r\n    }\r\n\r\n    public createPropItem(propType:PropId,num:number,pAc:PropAction=PropAction.Look,propPrice:number=0):cc.Node{\r\n        let type=ItemManager.getInstance().getType(propType);\r\n        let prop:cc.Node=null;\r\n       \r\n        switch(type){\r\n            case 3:{\r\n                let info = new EquipInfo();\r\n                info.equip_id = propType;\r\n                info.equip_num = num;\r\n                prop=EquipmentManager.getInstance().getEquipNodeByInfo(info,pAc);\r\n            }break;\r\n            // case 7:{\r\n                // let petInfo=new PetInfo();\r\n                // petInfo.pet_id=propType-70000;\r\n                // petInfo.pet_level=1;\r\n                // prop=PetManager.getInstance().createPetItem(petInfo);\r\n            // }break;\r\n            default:{\r\n                prop=cc.instantiate(this.prop_item);\r\n                prop.getComponent(Prop).init(propType,num,pAc);\r\n            }\r\n        }\r\n        return prop;\r\n    }\r\n\r\n    public createSalePropItem(propType:PropId,num:number,pAc:PropAction=PropAction.Look):cc.Node{\r\n        let type=ItemManager.getInstance().getType(propType);\r\n        let prop:cc.Node=null;\r\n        if(type==3){\r\n            prop=EquipmentManager.getInstance().getSaleEquipNodeById(propType,pAc);\r\n        }else{\r\n            prop=cc.instantiate(this.prop_sale_item);\r\n            prop.getComponent(Prop).init(propType,num,pAc);\r\n        }\r\n        return prop;\r\n    }\r\n\r\n    /**\r\n     * 获取道具的品质名称\r\n     * @param quality 道具的品质\r\n     */\r\n    getPropQualityName(quality:number):string{\r\n        let textId=110005;\r\n        switch(quality){\r\n            case 1:{\r\n                textId=110005;\r\n            }break;\r\n            case 2:{\r\n                textId=110007;\r\n            }break;\r\n            case 3:{\r\n                textId=110009;\r\n            }break;\r\n            case 4:{\r\n                textId=110011;\r\n            }break;\r\n            case 5:{\r\n                textId=110013;\r\n            }break;\r\n            case 6:{\r\n                textId=110013;\r\n            }break;\r\n        }\r\n        return LanguageManager.getInstance().getStrByTextId(textId);\r\n    }\r\n\r\n    /**\r\n     * 获取道具的品质名称的文本色值\r\n     * @param quality 道具的品质\r\n     */\r\n     getPropQualityTextColor(quality:number):cc.Color{\r\n        let color=cc.color();\r\n        switch(quality){\r\n            case 0:{\r\n                color=cc.color(254, 246, 233);\r\n            }break;\r\n            case 1:{                \r\n                color=cc.color(156, 226, 150);\r\n            }break;\r\n            case 2:{\r\n                color=cc.color(86, 149, 225);\r\n            }break;\r\n            case 3:{\r\n                color=cc.color(205, 158, 255);\r\n            }break;\r\n            case 4:{\r\n                color=cc.color(255, 249, 158);\r\n            }break;\r\n            case 5:{\r\n                color=cc.color(251, 95, 98);\r\n            }break;\r\n            case 6:{\r\n                color=cc.color(255, 255, 255);\r\n            }break;\r\n        }\r\n        return color;\r\n    }\r\n\r\n    /**获取道具的品质名称的文本描边色值*/\r\n     getPropQualityTextOutlineColor():cc.Color{\r\n        let color=cc.color(37, 49, 71);        \r\n        return color;\r\n    }\r\n\r\n    /**获取英雄角标 */\r\n    getHeroIcon(heroType:Hero_Type):cc.SpriteFrame{\r\n        let iconSpName=\"Equipped_Hero_\"+heroType;\r\n        return this.getSpByName(iconSpName);\r\n    }\r\n\r\n    /**获取白色英雄角标 */\r\n    getHeroIconb(heroType:Hero_Type):cc.SpriteFrame{\r\n        let iconSpName=\"Head_Hero_S_\"+heroType;\r\n        return this.getSpByName(iconSpName);\r\n    }\r\n    \r\n\r\n    /**-----------------------------------------------------数据----------------------------------------------------- */\r\n    public loadPropData(){\r\n        if(!this.map_prop_num){\r\n            this.map_prop_num=new Map<number,number>();\r\n            let idList=ItemManager.getInstance().getPropIdList();\r\n            let len=idList.length;\r\n            for(let i=0; i<len; i++){\r\n                let id=idList[i];\r\n                let num=TheStorageManager.getInstance().getInt(StorageKey.PropNum+id,0);\r\n                if(id==PropId.Coin&&num==0){\r\n                    num=2000;\r\n                }\r\n                this.setPropNum(id,num);\r\n            }\r\n        }\r\n        //拉取服务器的\r\n        if(UserData.getInstance().getUserID()){\r\n            this.HttpSyncPropData(false);\r\n        }\r\n    }\r\n    /**\r\n     * \r\n     * @param propId 道具id\r\n     * @param num 改变的数量\r\n     * @returns 更改数据是否成功\r\n     */\r\n    public changePropNum(propId:number,num:number):boolean{\r\n        let type=ItemManager.getInstance().getType(propId);\r\n        // if(type==3){\r\n        //     if(num>0){\r\n        //         EquipmentManager.getInstance().addEquipment(propId);\r\n        //         FollowManager.getInstance().followEvent(Follow_Type.对应道具ID的获得次数 + propId)\r\n        //         return true;\r\n        //     }\r\n        //     return false;\r\n        // }\r\n        // if(type==7){\r\n        //     if(num>0){\r\n        //         // PetManager.getInstance().addPet(propId-70000);\r\n        //         FollowManager.getInstance().followEvent(Follow_Type.对应道具ID的获得次数 + propId)\r\n        //         return true;\r\n        //     }\r\n        //     return false;\r\n        // }\r\n        // 新增英雄\r\n        if(type == 11){\r\n            if(HeroManager.getInstance().getHeroInfo(propId % 110000) == null){\r\n                HeroManager.getInstance().addHero(propId % 110000)\r\n                return true;\r\n            }else{\r\n                PropManager.getInstance().changePropNum(propId - 10000,20);\r\n                return true;\r\n            }\r\n        }\r\n\r\n        let newNum=this.getPropNum(propId)+num;\r\n        if(newNum>=0){\r\n            if(num > 0){\r\n                FollowManager.getInstance().followEvent(Follow_Type.对应道具ID的获得次数 + propId);\r\n            } \r\n            if(num < 0){\r\n                FollowManager.getInstance().followEvent(Follow_Type.对应道具ID的使用次数 + propId);\r\n            } \r\n            this.setPropNum(propId,newNum);\r\n            if(PropId.Coin==propId && num < 0){\r\n                GameManager.getInstance().refreshCoinShow();\r\n            }\r\n            if(PropId.Gem==propId && num < 0) GameManager.getInstance().refreshGemShow();  \r\n            if(PropId.OrdinaryWishingCoin==propId && num > 0){\r\n                EventManager.postRedEvent(RedEventString.RED_CHECK,RedEventType.Btn_Shop);\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    public getPropNum(propId:number):number{\r\n        return this.map_prop_num.get(propId);\r\n    }\r\n\r\n    public setPropNum(propId:number,num:number,isSave:boolean=false){\r\n        this.map_prop_num.set(propId,num);\r\n        TheStorageManager.getInstance().setItem(StorageKey.PropNum+propId,num);\r\n        /**资源更改通知 */\r\n        switch(propId){\r\n            case PropId.Coin:{\r\n                EventManager.postAssetsEvent(AssetsEventType.COIN);\r\n                // GameManager.getInstance().refreshCoinShow();\r\n            }break;\r\n            case PropId.Gem:{\r\n                EventManager.postAssetsEvent(AssetsEventType.GEM);\r\n                // GameManager.getInstance().refreshGemShow();\r\n            }break;\r\n            case PropId.HeroExp:{\r\n                EventManager.postAssetsEvent(AssetsEventType.HERO_EXP);\r\n            }break;\r\n            case PropId.HeroStone:{\r\n                EventManager.postAssetsEvent(AssetsEventType.HERO_STONE);\r\n            }break;\r\n            case PropId.AnimalFood:{\r\n                EventManager.postAssetsEvent(AssetsEventType.Animal_Food);\r\n            }break;\r\n            case 40004:{\r\n                // EventManager.postAssetsEvent(AssetsEventType.Animal_Food);\r\n                cc.director.emit(\"onRefreshInstanceItem\");\r\n            }break;\r\n            case 40005:{\r\n                //EventManager.postAssetsEvent(AssetsEventType.Animal_Food);\r\n                cc.director.emit(\"onRefreshInstanceItem\");\r\n            }break;\r\n            case 40006:{\r\n                //EventManager.postAssetsEvent(AssetsEventType.Animal_Food);\r\n                cc.director.emit(\"onRefreshInstanceItem\");\r\n            }break;\r\n        }\r\n        if(isSave){\r\n            TheStorageManager.getInstance().setItem(StorageKey.PropNum+propId,num);\r\n        }\r\n        // if(PropId.Gem==propId){\r\n        //     //目前只上报钻石\r\n        //     let propDatas=new Array<PropObject>();\r\n        //     let propData=new PropObject();\r\n        //     propData.itemsId=propId;\r\n        //     propData.itemsNum=num;\r\n        //     propDatas.push(propData);\r\n        //     this.HttpSetPropData(propDatas);\r\n        // }\r\n    }\r\n\r\n    /**获取装备的列表数据 */\r\n    getEquipmentList(equipType:EquipType):EquipInfo[]{\r\n        let EAM=EquipmentAttributeManager.getInstance();\r\n        let IM=ItemManager.getInstance();\r\n        let list=new Array();\r\n        this.map_prop_num.forEach((propNum,propId)=>{\r\n            if(propNum>0){\r\n                let propType=IM.getType(propId);\r\n                //如果是装备\r\n                if(propType==3){\r\n                    let type=EAM.getEquipmentPosition(propId);\r\n                    if(equipType==type){\r\n                        let prop=new EquipInfo();\r\n                    prop.equip_id=propId;\r\n                        prop.equip_num=propNum;\r\n                        list.push(prop);\r\n                    }\r\n                }\r\n            }            \r\n        })\r\n        if(list.length>0){\r\n            //重新排列一下，品质最好在最前\r\n            list.sort((a:EquipInfo,b:EquipInfo)=>{\r\n                let levelA=EquipmentAttributeManager.getInstance().getStage(a.equip_id);\r\n                let levelB=EquipmentAttributeManager.getInstance().getStage(b.equip_id);\r\n                return levelB-levelA;\r\n            });\r\n        }        \r\n        return list;\r\n    }\r\n    /**获取宠物的列表数据 */\r\n    getPetList():PetMessage[]{\r\n        let IM=ItemManager.getInstance();\r\n        let list=new Array();\r\n        this.map_prop_num.forEach((propNum,propId)=>{\r\n            if(propNum>0){\r\n                let propType=IM.getType(propId);\r\n                //如果是装备\r\n                if(propType==7){\r\n                    let prop=new PetMessage();\r\n                    prop.pet_id=propId;\r\n                    prop.pet_num=propNum;\r\n                    list.push(prop);\r\n                }\r\n            }            \r\n        })\r\n        if(list.length>0){\r\n            // todo 宠物排序，阶段高的在前面\r\n            // list.sort((a:EquipInfo,b:EquipInfo)=>{\r\n            //     let levelA=EquipmentAttributeManager.getInstance().getStage(a.equip_id);\r\n            //     let levelB=EquipmentAttributeManager.getInstance().getStage(b.equip_id);\r\n            //     return levelB-levelA;\r\n            // });\r\n        }        \r\n        return list;\r\n    }\r\n    /**保存这份列表，修改装备数量后调用 */\r\n    saveEquipmentList(list:EquipInfo[]){\r\n        for(let i=0; i<list.length; i++){\r\n            let prop=list[i];\r\n            this.map_prop_num.set(prop.equip_id,prop.equip_num);\r\n        }\r\n    }\r\n\r\n    /**把变量存储的值存放在本地文件 */\r\n    public saveAllPropNum(isPost:boolean=true){\r\n        let list:PropObject[]=[];\r\n        this.map_prop_num.forEach((v,k)=>{\r\n            TheStorageManager.getInstance().setItem(StorageKey.PropNum+k,v);\r\n            let prop=new PropObject();\r\n            prop.itemsId=k;\r\n            prop.itemsNum=v;\r\n            list.push(prop)\r\n        })\r\n        //提交到服务器\r\n        if(isPost){\r\n            this.HttpSetPropData(list);\r\n        }\r\n        \r\n    }\r\n\r\n    /**获取到根据品质排序后的物品列表 */\r\n    public getSortPropList(){\r\n        let propList:PropData[] = new Array();\r\n        this.map_prop_num.forEach((num,id) =>{\r\n            let prop = {\r\n                prop_id: id,\r\n                prop_num: num,\r\n            }\r\n            if(num>0){\r\n                propList.push(prop)\r\n            }\r\n        });\r\n        propList.sort((a:PropData,b:PropData)=>{\r\n            let qualityA = ItemManager.getInstance().getQuality(a.prop_id);\r\n            let qualityB = ItemManager.getInstance().getQuality(b.prop_id);\r\n            return qualityA - qualityB;\r\n        })\r\n        return propList;\r\n    }\r\n\r\n    /**提交修改申请 */\r\n    changePropServerTest(){\r\n        let change=JSON.stringify({\r\n            uid:'fb123456',\r\n            name:\"props_change\",\r\n            value:[{id:10001,num:20},{id:10002,num:-30}]\r\n        });\r\n\r\n        let issue=JSON.stringify({\r\n            uid:'fb123456',\r\n            name:\"props_issue\",\r\n            value:[{id:10001,num:120},{id:10002,num:130}]\r\n        });\r\n    }\r\n\r\n\r\n\r\n    /*******************************************************服务端对接的代码****************************************************************** */\r\n    /**同步服务器的道具数据至本地 */\r\n    HttpSyncPropData(isRefresh:boolean=true){\r\n        HttpManager.post(AccessName.getProp,this.getPropJsonString(null)).then((data:any)=>{\r\n            if(data){\r\n                let len=data.length;\r\n                for(let i=0; i<len; i++){\r\n                    let item=data[i];\r\n                    this.setPropNum(item.itemsId,item.itemsNum);\r\n                }\r\n                if(isRefresh){\r\n                    GameManager.getInstance().refreshGemShow();\r\n                }\r\n                //统一存储本地       \r\n                this.saveAllPropNum(false);\r\n            }\r\n        }).catch((error)=>{\r\n            cc.error(error);\r\n        });\r\n    }\r\n    \r\n    async HttpSetPropData(propDatas:PropObject[]):Promise<any>{\r\n        HttpManager.post(AccessName.setProp,this.getPropJsonString(propDatas)).then((data:any)=>{\r\n            cc.log('上报成功');\r\n        }).catch((error)=>{\r\n            cc.log(error);\r\n        });\r\n    }\r\n\r\n    private getPropJsonString(propDatas:PropObject[]):string{\r\n        let uid=UserData.getInstance().getUserID();\r\n        return JSON.stringify({\r\n            uid:uid,\r\n            gameUserItemNewList:propDatas,\r\n        });\r\n    }\r\n}"]}
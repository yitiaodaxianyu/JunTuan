{"version":3,"sources":["assets\\Scripts\\Hero\\Game\\KuangZhanShi\\FuTou.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nimport { GameEffectsManager, GameEffectId } from \"../../../Game/GameEffectsManager\";\r\nimport Monster from \"../../../Monster/Monster\";\r\nimport { FeedBackType } from \"../../../Monster/MonsterData\";\r\nimport { GongJiData } from \"../../Data/HeroData\";\r\nimport Bullect from \"../Bullect\";\r\nimport { JianShi_Type, SkillType } from \"../HeroConfig\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class FuTou extends Bullect {\r\n\r\n\r\n    /**原来的增伤数值 */\r\n    kuangre_num:number=0;\r\n    is_penetrate:boolean=false;\r\n    futou_type:number=0;\r\n    real_damage_num=0;\r\n    penetration_num:number=0;\r\n    old_skill_rate:number=0;\r\n\r\n    onLoad(): void {\r\n        super.onLoad();\r\n        super.addCollisionMonsterListen(this.onCollisionMonster);\r\n        super.addInitFinishedListen(this.onInitFinished);\r\n    }\r\n    \r\n    onInitFinished(){\r\n        this.node.angle=0;\r\n        this.node.stopAllActions();\r\n        cc.tween(this.node).by(1,{angle:-1440}).repeatForever().start();\r\n        this.penetration_num=0;\r\n        this.old_skill_rate=this.gongji_data.skill_damage_rate;\r\n    }\r\n\r\n    initFuTou(kuangreNum:number,isP:boolean,futouType:number): void {\r\n        this.kuangre_num=kuangreNum;\r\n        this.is_penetrate=isP;\r\n        this.futou_type=futouType;\r\n        this.real_damage_num=this.gongji_data.hero_data.total_attack*this.gongji_data.hero_data.getSkillValue1(SkillType.Passive_1)*this.kuangre_num;\r\n    }\r\n\r\n    ////--------------------------------------碰撞开始----------------------------------------------------\r\n    onCollisionMonster(monsterTs:Monster) {\r\n        if(monsterTs){\r\n            switch(this.futou_type){\r\n                case 0:{\r\n                    let data=monsterTs.beFlashInjured(this.gongji_data);\r\n                    if(data.getDamageNum()>0){\r\n                        //额外真伤\r\n                        if(data.is_die==false&&this.kuangre_num>0){\r\n                            monsterTs.beRealDamage(this.gongji_data,this.real_damage_num)\r\n                        }\r\n                        //本次攻击有效\r\n                        GameEffectsManager.getInstance().createGameEffectById(GameEffectId.kuangzhanshi_attack_hit,this.getHeadPos());\r\n                    }                    \r\n                    this.is_att=true;\r\n                    this.destroySelf();\r\n                }break;\r\n                case 1:{\r\n                    this.is_att=false;\r\n                    //被动技能1的箭矢，可以穿透，并且首个目标伤害增加\r\n                    if(this.penetration_num==0){\r\n                        this.gongji_data.skill_damage_rate=1;\r\n                    }else{\r\n                        this.gongji_data.skill_damage_rate=this.old_skill_rate;\r\n                    }\r\n                    this.is_att=false;\r\n                    this.penetration_num++;\r\n                    let data=monsterTs.beFlashInjured(this.gongji_data);\r\n                    if(data.getDamageNum()>0){\r\n                        //额外真伤\r\n                        if(data.is_die==false&&this.kuangre_num>0&&this.penetration_num==0){\r\n                            monsterTs.beRealDamage(this.gongji_data,this.real_damage_num)\r\n                        }\r\n                        //本次攻击有效\r\n                        GameEffectsManager.getInstance().createGameEffectById(GameEffectId.kuangzhanshi_attack_chuantou,this.getHeadPos());\r\n                    }\r\n                }break;\r\n            }            \r\n        }\r\n    }\r\n}\r\n"]}
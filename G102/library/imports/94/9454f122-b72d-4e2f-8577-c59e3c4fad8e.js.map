{"version":3,"sources":["assets\\Scripts\\Equipment\\Ui\\EquipExchangeUi.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,iDAA4C;AAC5C,2DAA0D;AAC1D,yDAAuD;AACvD,uEAAkE;AAClE,iEAA4D;AAC5D,6CAAmD;AACnD,oDAAmD;AACnD,sDAAqD;AACrD,6DAAwD;AACxD,oDAA+C;AAC/C,8CAAsD;AACtD,wDAAwD;AACxD,iDAA4C;AAGtC,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAA6C,mCAAW;IAAxD;QAAA,qEAuHC;QApHG,gBAAU,GAAW,IAAI,CAAC;QAE1B,cAAQ,GAAQ,IAAI,CAAC;QACrB,mBAAa,GAAW,sBAAS,CAAC,IAAI,CAAC;QACvC,gBAAU,GAAW,uBAAS,CAAC,MAAM,CAAC;QAGtC,mBAAa,GAAS,IAAI,CAAC;;IA6G/B,CAAC;IA1GG,kCAAQ,GAAR,UAAS,OAAc,EAAC,QAAkB,EAAC,QAAkB;QACzD,IAAI,CAAC,QAAQ,GAAC,OAAO,CAAC;QACtB,IAAI,CAAC,aAAa,GAAC,QAAQ,CAAC;QAC5B,IAAI,CAAC,UAAU,GAAC,QAAQ,CAAC;QACzB,IAAI,CAAC,MAAM,EAAE,CAAC;IAClB,CAAC;IAED,gCAAM,GAAN;QACI,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE;YAC7H,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,OAAO,EAAE,CAAA;SACvG;QACD,IAAI,CAAC,aAAa,CAAC,MAAM,GAAC,KAAK,CAAA;QAC/B,IAAI,OAAO,GAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QAChD,IAAI,MAAM,GAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;QAC9C,IAAG,IAAI,CAAC,QAAQ,EAAC;YAEb,OAAO,CAAC,MAAM,GAAC,IAAI,CAAC;YACpB,MAAM,CAAC,MAAM,GAAC,KAAK,CAAC;YACpB,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,GAAC,GAAG,CAAA;YAC1C,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,sBAAY,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAA;YACnF,cAAc;YACd,QAAQ;YACR,IAAI,IAAI,GAAC,mCAAgB,CAAC,WAAW,EAAE,CAAC,gBAAgB,CAAC,IAAI,CAAC,QAAQ,EAAC,uBAAU,CAAC,IAAI,EAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAC3G,IAAG,OAAO,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,QAAQ,CAAC,MAAM,GAAC,CAAC,EAAC;gBACpD,OAAO,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,CAAA;aAC3D;YACD,OAAO,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;YAClD,IAAI;YACJ,IAAI,QAAQ,GAAC,kBAAW,CAAC,WAAW,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAClE,IAAI,QAAQ,GAAC,OAAO,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC;YAChD,QAAQ,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAC,GAAG,GAAC,yBAAW,CAAC,WAAW,EAAE,CAAC,kBAAkB,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAC,GAAG,GAAC,yBAAe,CAAC,WAAW,EAAE,CAAC,cAAc,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;YAChL,QAAQ,CAAC,KAAK,GAAC,yBAAW,CAAC,WAAW,EAAE,CAAC,uBAAuB,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;YACnF,IAAI,YAAY,GAAC,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAC,IAAI,EAAE,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAC,IAAI,EAAE,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAC,IAAI,EAAE,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAC,IAAI,EAAE,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,EAAC,IAAI,EAAE,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAA;YACvK,yCAAyC;YACzC,QAAQ,CAAC,YAAY,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC,KAAK,GAAC,YAAY,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAA;YAC7E,KAAK;YACL,OAAO,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAC,mCAAgB,CAAC,WAAW,EAAE,CAAC,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAC,EAAE,CAAA,CAAA,oEAAoE;SACxM;aAAI;YACD,OAAO,CAAC,MAAM,GAAC,KAAK,CAAC;YACrB,MAAM,CAAC,MAAM,GAAC,IAAI,CAAC;YACnB,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,GAAC,GAAG,CAAA;YAC1C,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,sBAAY,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAA;SACtF;QACD,IAAI,CAAC,aAAa,EAAE,CAAC;IACzB,CAAC;IAED,uCAAa,GAAb;QAAA,iBAkDC;QAjDG,IAAI,IAAI,GAAC,IAAI,CAAC,UAAU,CAAC;QACzB,IAAI,SAAS,GAAC,yBAAW,CAAC,WAAW,EAAE,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;QAC/D,mCAAmC;QACnC,IAAI,OAAO,GAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC;QACvF,MAAM;QACN,IAAI,WAAW,GAAC,IAAI,uBAAS,EAAE,CAAC;QAChC,WAAW,CAAC,QAAQ,GAAC,IAAI,CAAC,QAAQ,CAAC;QACnC,WAAW,CAAC,SAAS,GAAC,CAAC,CAAC;QACxB,IAAI,OAAO,GAAC,IAAI,KAAK,EAAE,CAAC;QACxB,KAAI,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC;YACjC,IAAI,IAAI,GAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YACtB,IAAI,QAAQ,GAAC,yBAAW,CAAC,WAAW,EAAE,CAAC,wBAAwB,CAAC,IAAI,CAAC,CAAC;YACtE,IAAI,SAAS,GAAC,IAAI,CAAC,SAAS,GAAC,QAAQ,CAAC,MAAM,CAAC;YAC7C,IAAG,SAAS,GAAC,CAAC,EAAC;gBACX,IAAI,IAAI,GAAC,IAAI,uBAAS,EAAE,CAAC;gBACzB,IAAI,CAAC,QAAQ,GAAC,IAAI,CAAC,QAAQ,CAAC;gBAC5B,IAAI,CAAC,SAAS,GAAC,SAAS,CAAC;gBACzB,OAAO,CAAC,IAAI,CAAC;oBACT,SAAS,EAAC,IAAI;oBACd,QAAQ,EAAC,sBAAS,CAAC,IAAI;iBAC1B,CAAC,CAAA;aACL;YACD,KAAI,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC;gBAChC,IAAI,QAAQ,GAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;gBACzB,IAAG,QAAQ,IAAE,IAAI,CAAC,aAAa,EAAC;oBAC5B,IAAI,IAAI,GAAC,IAAI,uBAAS,EAAE,CAAC;oBACzB,IAAI,CAAC,QAAQ,GAAC,IAAI,CAAC,QAAQ,CAAC;oBAC5B,IAAI,CAAC,SAAS,GAAC,CAAC,CAAC;oBACjB,OAAO,CAAC,IAAI,CAAC;wBACT,SAAS,EAAC,IAAI;wBACd,QAAQ,EAAC,QAAQ;qBACpB,CAAC,CAAC;iBACN;aACJ;SACJ;gCACO,CAAC;YACL,IAAI,IAAI,GAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YACpB,sEAAsE;YACtE,gBAAgB;YAChB,IAAI;YACJ,OAAK,YAAY,CAAC;gBACd,IAAI,IAAI,GAAC,EAAE,CAAC,WAAW,CAAC,KAAI,CAAC,UAAU,CAAC,CAAC;gBACzC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;gBACvB,IAAI,CAAC,YAAY,CAAC,uBAAa,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAC,WAAW,EAAC,KAAI,CAAC,aAAa,EAAC,UAAC,EAAS;oBAC1F,iBAAM,SAAS,aAAC,EAAE,CAAC,CAAC;oBACpB,KAAI,CAAC,aAAa,EAAE,CAAC;gBACzB,CAAC,EAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YACrB,CAAC,EAAC,IAAI,GAAC,CAAC,CAAC,CAAC;;;QAZd,KAAI,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE;oBAA1B,CAAC;SAaR;IACL,CAAC;IAED,uCAAa,GAAb;QAEI,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE;YAC7H,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,OAAO,EAAE,CAAA;SACvG;QACD,qBAAW,CAAC,WAAW,EAAE,CAAC,aAAa,CAAC,SAAS,CAAC,2BAAU,CAAC,KAAK,CAAC,CAAC;QACpE,iBAAM,OAAO,WAAE,CAAC;IACpB,CAAC;IAnHD;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;uDACM;IAO1B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;0DACS;IAVV,eAAe;QADnC,OAAO;OACa,eAAe,CAuHnC;IAAD,sBAAC;CAvHD,AAuHC,CAvH4C,qBAAW,GAuHvD;kBAvHoB,eAAe","file":"","sourceRoot":"/","sourcesContent":["import GameManager from \"../../GameManager\";\r\nimport { HeroManager } from \"../../Hero/Data/HeroManager\";\r\nimport { Hero_Type } from \"../../Hero/Game/HeroConfig\";\r\nimport LanguageManager from \"../../multiLanguage/LanguageManager\";\r\nimport TextLanguage from \"../../multiLanguage/TextLanguage\";\r\nimport { ItemManager } from \"../../Prop/Data/Item\";\r\nimport { PropAction } from \"../../Prop/PropConfig\";\r\nimport { PropManager } from \"../../Prop/PropManager\";\r\nimport { SoundIndex } from \"../../Sound/AudioConstants\";\r\nimport UIComponent from \"../../UI/UIComponent\";\r\nimport { EquipInfo, EquipType } from \"../EquipConfig\";\r\nimport {  EquipmentManager } from \"../EquipmentManager\";\r\nimport EquipDataItem from \"./EquipDataItem\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class EquipExchangeUi extends UIComponent {\r\n\r\n    @property(cc.Prefab)\r\n    equip_data:cc.Prefab=null;\r\n\r\n    equip_id:number=null;\r\n    cur_hero_type:Hero_Type=Hero_Type.NULL;\r\n    equip_type:EquipType=EquipType.ShiPin;\r\n\r\n    @property(cc.Node)\r\n    ExchangeLevel:cc.Node=null;\r\n    \r\n\r\n    initData(equipId:number,heroType:Hero_Type,equipPos:EquipType){\r\n        this.equip_id=equipId;\r\n        this.cur_hero_type=heroType;\r\n        this.equip_type=equipPos;\r\n        this.initUi();\r\n    }\r\n    \r\n    initUi(){\r\n        for (let index = 0; index < this.node.getChildByName('scrollView').getComponent(cc.ScrollView).content.children.length; index++) {\r\n            this.node.getChildByName('scrollView').getComponent(cc.ScrollView).content.children[index].destroy()\r\n        }\r\n        this.ExchangeLevel.active=false\r\n        let curRoot=this.node.getChildByName('curRoot');\r\n        let noWear=this.node.getChildByName('noWear');\r\n        if(this.equip_id){\r\n            \r\n            curRoot.active=true;\r\n            noWear.active=false;\r\n            this.node.getChildByName(\"bg\").color.a=200\r\n            this.node.getChildByName(\"titleLabel\").getComponent(TextLanguage).setTextId(180005)\r\n            //信息展示        \r\n            //装备Item\r\n            let item=EquipmentManager.getInstance().getEquipNodeById(this.equip_id,PropAction.Null,this.cur_hero_type);\r\n            if(curRoot.getChildByName('propRoot').children.length>0){\r\n                curRoot.getChildByName('propRoot').children[0].destroy()\r\n            }\r\n            curRoot.getChildByName('propRoot').addChild(item);\r\n            //名称\r\n            let jsonItem=ItemManager.getInstance().getJsonItem(this.equip_id);\r\n            let propName=curRoot.getChildByName('propName');\r\n            propName.getComponent(cc.Label).string=\"[\"+PropManager.getInstance().getPropQualityName(jsonItem.Quality)+\"]\"+LanguageManager.getInstance().getStrByTextId(jsonItem.NameTextId);\r\n            propName.color=PropManager.getInstance().getPropQualityTextColor(jsonItem.Quality);\r\n            let Outlinecolor=[new cc.Color(39, 35, 28),new cc.Color(29, 63, 27),new cc.Color(25, 55, 88),new cc.Color(66, 37, 96),new cc.Color(62, 32, 0),new cc.Color(79, 16, 15)]\r\n            // console.log(\"______\",jsonItem.Quality)\r\n            propName.getComponent(cc.LabelOutline).color=Outlinecolor[(jsonItem.Quality)]\r\n            //战力数\r\n            curRoot.getChildByName('zhanliNum').getComponent(cc.Label).string=EquipmentManager.getInstance().getEquipZhanLi(this.equip_id)+\"\"//EquipmentManager.getInstance().getEquipZhanLi(this.equip_info)+'';\r\n        }else{\r\n            curRoot.active=false;\r\n            noWear.active=true;\r\n            this.node.getChildByName(\"bg\").color.a=128\r\n            this.node.getChildByName(\"titleLabel\").getComponent(TextLanguage).setTextId(180006)\r\n        }\r\n        this.loadEquipList();\r\n    }\r\n\r\n    loadEquipList(){\r\n        let type=this.equip_type;\r\n        let equipList=PropManager.getInstance().getEquipmentList(type);        \r\n        // console.log(\"+++++++\",equipList)\r\n        let content=this.node.getChildByName('scrollView').getComponent(cc.ScrollView).content;\r\n        //重组列表\r\n        let uiEquipInfo=new EquipInfo();\r\n        uiEquipInfo.equip_id=this.equip_id;\r\n        uiEquipInfo.equip_num=1;\r\n        let newList=new Array();\r\n        for(let i=0; i<equipList.length; i++){\r\n            let info=equipList[i];\r\n            let heroList=HeroManager.getInstance().getWearEquipmentHeroList(info);\r\n            let remainNum=info.equip_num-heroList.length;\r\n            if(remainNum>0){\r\n                let prop=new EquipInfo();\r\n                prop.equip_id=info.equip_id;\r\n                prop.equip_num=remainNum;\r\n                newList.push({\r\n                    equipInfo:prop,\r\n                    heroType:Hero_Type.NULL\r\n                })\r\n            }\r\n            for(let n=0; n<heroList.length; n++){\r\n                let heroType=heroList[n];\r\n                if(heroType!=this.cur_hero_type){\r\n                    let prop=new EquipInfo();\r\n                    prop.equip_id=info.equip_id;\r\n                    prop.equip_num=1;\r\n                    newList.push({\r\n                        equipInfo:prop,\r\n                        heroType:heroType\r\n                    });\r\n                }                \r\n            }            \r\n        }\r\n        for(let i=0; i<newList.length; i++){\r\n            let info=newList[i];\r\n            // if(this.equip_info&&info.sequence_id==this.equip_info.sequence_id){\r\n            //     continue;\r\n            // }\r\n            this.scheduleOnce(()=>{\r\n                let item=cc.instantiate(this.equip_data);\r\n                content.addChild(item);\r\n                item.getComponent(EquipDataItem).init(info.equipInfo,uiEquipInfo,this.cur_hero_type,(id:number)=>{\r\n                    super.onRefresh(id);\r\n                    this.clickBtnClose();\r\n                },info.heroType);\r\n            },0.02*i);\r\n        }\r\n    }\r\n    \r\n    clickBtnClose(){\r\n\r\n        for (let index = 0; index < this.node.getChildByName('scrollView').getComponent(cc.ScrollView).content.children.length; index++) {\r\n            this.node.getChildByName('scrollView').getComponent(cc.ScrollView).content.children[index].destroy()\r\n        }\r\n        GameManager.getInstance().sound_manager.playSound(SoundIndex.click);\r\n        super.onClose();\r\n    }\r\n}\r\n"]}
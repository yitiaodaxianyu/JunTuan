{"version":3,"sources":["assets\\Scripts\\Pet\\Game\\FireRing.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,oEAAiF;AAEjF,iDAA4C;AAC5C,iDAA4C;AAC5C,+DAA0D;AAGpD,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAsC,4BAAM;IAA5C;QAAA,qEAwDC;QAtDG,UAAU;QACV,iBAAW,GAAQ,CAAC,CAAC;QACrB,UAAU;QACV,mBAAa,GAAQ,CAAC,CAAC;QACvB,UAAU;QACV,kBAAY,GAAQ,CAAC,CAAC;QACtB,QAAQ;QACR,YAAM,GAAQ,CAAC,CAAC;QAChB,oBAAc,GAAQ,CAAC,CAAC;QACxB,gBAAU,GAAS,KAAK,CAAC;;IA6C7B,CAAC;IA3CG,uBAAI,GAAJ,UAAK,YAAyB,EAAC,MAAiB,EAAC,UAAiB,EAAC,MAAa,EAAC,YAAmB;QAChG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACtB,IAAI,CAAC,cAAc,GAAC,YAAY,CAAC;QACjC,IAAI,CAAC,WAAW,GAAC,UAAU,CAAC;QAC5B,IAAI,CAAC,MAAM,GAAC,MAAM,CAAC;QACnB,IAAI,CAAC,aAAa,GAAC,YAAY,CAAC;QAChC,IAAI,CAAC,UAAU,GAAC,KAAK,CAAC;QACtB,IAAI,CAAC,YAAY,GAAC,CAAC,CAAC;QACpB,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,WAAW;QACX,IAAI,CAAC,IAAI,CAAC,KAAK,GAAC,MAAM,GAAC,GAAG,CAAC;IAC/B,CAAC;IAED,8BAAW,GAAX;QACI,IAAG,IAAI,CAAC,UAAU,EAAC;YACf,OAAO;SACV;QACD,IAAI,CAAC,UAAU,GAAC,IAAI,CAAC;QACrB,uCAAkB,CAAC,WAAW,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,cAAc,EAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC1F,CAAC;IAED,8BAAW,GAAX;QACI,IAAI,QAAQ,GAAC,wBAAc,CAAC,WAAW,EAAE,CAAC,uBAAuB,CAAC,CAAC,CAAC,EAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,EAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAC1G,IAAG,QAAQ,EAAC;YACR,KAAI,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC;gBAChC,IAAI,SAAS,GAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,iBAAO,CAAC,CAAC;gBAChD,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;aAC9C;SACJ;IACL,CAAC;IAED,yBAAM,GAAN,UAAQ,EAAS;QACb,IAAG,IAAI,CAAC,WAAW,GAAC,CAAC,EAAC;YAClB,IAAI,CAAC,WAAW,IAAE,EAAE,CAAC;YACrB,IAAI,CAAC,YAAY,IAAE,EAAE,CAAC;YACtB,IAAG,IAAI,CAAC,YAAY,IAAE,IAAI,CAAC,aAAa,EAAC;gBACrC,IAAI,CAAC,YAAY,GAAC,CAAC,CAAC;gBACpB,IAAI,CAAC,WAAW,EAAE,CAAC;aACtB;SACJ;aAAI;YACD,IAAI,CAAC,WAAW,EAAE,CAAC;SACtB;IACL,CAAC;IAvDgB,QAAQ;QAD5B,OAAO;OACa,QAAQ,CAwD5B;IAAD,eAAC;CAxDD,AAwDC,CAxDqC,gBAAM,GAwD3C;kBAxDoB,QAAQ","file":"","sourceRoot":"/","sourcesContent":["import { GameEffectId, GameEffectsManager } from \"../../Game/GameEffectsManager\";\r\nimport { GongJiData } from \"../../Hero/Data/HeroData\";\r\nimport GongJi from \"../../Hero/Game/GongJi\";\r\nimport Monster from \"../../Monster/Monster\";\r\nimport MonsterManager from \"../../Monster/MonsterManager\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class FireRing extends GongJi {\r\n\r\n    /**持续时间 */\r\n    remain_time:number=0;\r\n    /**伤害间隔 */\r\n    damage_jiange:number=0;\r\n    /**伤害计数 */\r\n    damage_jishu:number=0;\r\n    /**半径 */\r\n    radius:number=0;\r\n    game_effect_id:number=0;\r\n    is_destroy:boolean=false;\r\n    \r\n    init(gameEffectId:GameEffectId,gjData:GongJiData,remainTime:number,radius:number,damageJiange:number){\r\n        this.initData(gjData);\r\n        this.game_effect_id=gameEffectId;\r\n        this.remain_time=remainTime;\r\n        this.radius=radius;\r\n        this.damage_jiange=damageJiange;\r\n        this.is_destroy=false;\r\n        this.damage_jishu=0;\r\n        this.checkDamage();\r\n        //标准半径是100.\r\n        this.node.scale=radius/100;\r\n    }\r\n\r\n    destroySelf(){\r\n        if(this.is_destroy){\r\n            return;\r\n        }\r\n        this.is_destroy=true;\r\n        GameEffectsManager.getInstance().destroyGameEffectById(this.game_effect_id,this.node);\r\n    }\r\n\r\n    checkDamage(){\r\n        let monsters=MonsterManager.getInstance().getMonstersForCenterPos(-1,this.node.getPosition(),this.radius);\r\n        if(monsters){            \r\n            for(let i=0; i<monsters.length; i++){\r\n                let monsterTs=monsters[i].getComponent(Monster);\r\n                monsterTs.beFlashInjured(this.gongji_data);\r\n            }\r\n        }\r\n    }\r\n\r\n    update (dt:number) {\r\n        if(this.remain_time>0){\r\n            this.remain_time-=dt;\r\n            this.damage_jishu+=dt;\r\n            if(this.damage_jishu>=this.damage_jiange){\r\n                this.damage_jishu=0;\r\n                this.checkDamage();\r\n            }\r\n        }else{\r\n            this.destroySelf();\r\n        }\r\n    }\r\n}\r\n"]}